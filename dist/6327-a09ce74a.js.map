{"version":3,"file":"6327-a09ce74a.js","mappings":"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","sources":["webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/missing-data-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/webpack/bootstrap","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/to-resolvable-module.ts","webpack://checkout/@bigcommerce/checkout-sdk/webpack/runtime/define property getters","webpack://checkout/@bigcommerce/checkout-sdk/webpack/runtime/hasOwnProperty shorthand","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/standard-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/set-prototype-of.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/payment-method-client-unavailable-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-commerce-utils/src/paypal-commerce-sdk.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/ui/src/loading-indicator/loading-indicator.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/buy-now-cart-creation-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/request-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/cart/cart-source.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-commerce-integration/src/paypal-commerce-types.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-commerce-integration/src/paypal-commerce-integration-service.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/common/http-request/internal-api-headers.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/common/http-request/content-type.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/common/http-request/sdk-version-headers.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-commerce-integration/src/paypal-commerce-request-sender.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-commerce-integration/src/paypal-commerce-script-loader.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-commerce-integration/src/create-paypal-commerce-integration-service.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-commerce-integration/src/paypal-commerce-constants.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/invalid-argument-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/payment-argument-invalid-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/payment-method-invalid-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/order-finalization-not-required-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/payment/is-hosted-intrument-like.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/payment/is-vaulted-instrument.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/is-request-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-commerce-utils/src/utils/get-paypal-messages-styles-from-bnpl-config.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/utility/src/is-base-instrument/is-base-instrument.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-commerce-integration/src/paypal-commerce/paypal-commerce-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-commerce-utils/src/utils/is-redirect-action-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-commerce-utils/src/utils/is-paypal-commerce-provider-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-commerce-integration/src/paypal-commerce/create-paypal-commerce-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-commerce-utils/src/create-paypal-commerce-sdk.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/not-implemented-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-commerce-integration/src/paypal-commerce-credit/paypal-commerce-credit-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-commerce-integration/src/paypal-commerce-credit/create-paypal-commerce-credit-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-commerce-integration/src/paypal-commerce-venmo/paypal-commerce-venmo-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-commerce-integration/src/paypal-commerce-venmo/create-paypal-commerce-venmo-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-utils/src/paypal-sdk-script-loader.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-utils/src/create-paypal-sdk-script-loader.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/timeout-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/utility/src/is-experiment-enabled/is-experiment-enabled.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-commerce-integration/src/paypal-commerce-alternative-methods/paypal-commerce-alternative-methods-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-commerce-integration/src/paypal-commerce-alternative-methods/create-paypal-commerce-alternative-methods-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/payment/instrument.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-utils/src/paypal-types.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/storage/src/cookie-storage.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/hosted-form/hosted-field-type.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-utils/src/paypal-fastlane-utils.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-utils/src/create-paypal-fastlane-utils.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/hosted-form/is-credit-card-form-fields.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/hosted-form/is-credit-card-vaulted-form-fields.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/payment-method-failed-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/not-initialized-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/payment-invalid-form-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-commerce-integration/src/paypal-commerce-credit-card/paypal-commerce-credit-cards-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-commerce-utils/src/utils/is-paypal-commerce-accelerated-checkout-customer.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-commerce-integration/src/paypal-commerce-credit-card/create-paypal-commerce-credit-cards-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-commerce-integration/src/paypal-commerce-ratepay/paypal-commerce-ratepay-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-commerce-integration/src/paypal-commerce-ratepay/create-paypal-commerce-ratepay-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-utils/src/utils/get-fastlane-styles.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-utils/src/utils/is-paypal-fastlane-customer.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-commerce-integration/src/paypal-commerce-fastlane/paypal-commerce-fastlane-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-utils/src/utils/is-paypal-fastlane-request-error.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-commerce-integration/src/paypal-commerce-fastlane/create-paypal-commerce-fastlane-payment-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-commerce-integration/src/paypal-commerce/paypal-commerce-customer-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/checkout-buttons/default-checkout-button-height.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-commerce-integration/src/paypal-commerce/create-paypal-commerce-customer-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-commerce-integration/src/paypal-commerce-credit/paypal-commerce-credit-customer-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-commerce-integration/src/paypal-commerce-credit/create-paypal-commerce-credit-customer-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-commerce-integration/src/paypal-commerce-venmo/paypal-commerce-venmo-customer-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-commerce-integration/src/paypal-commerce-venmo/create-paypal-commerce-venmo-customer-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-commerce-integration/src/paypal-commerce-fastlane/paypal-commerce-fastlane-customer-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-commerce-integration/src/paypal-commerce-fastlane/create-paypal-commerce-fastlane-customer-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-commerce-integration/src/paypal-commerce/paypal-commerce-button-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-commerce-integration/src/paypal-commerce/create-paypal-commerce-button-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-commerce-integration/src/paypal-commerce-credit/paypal-commerce-credit-button-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-commerce-integration/src/paypal-commerce-credit/create-paypal-commerce-credit-button-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-commerce-integration/src/paypal-commerce-venmo/paypal-commerce-venmo-button-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-commerce-integration/src/paypal-commerce-venmo/create-paypal-commerce-venmo-button-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-commerce-integration/src/paypal-commerce-alternative-methods/paypal-commerce-alternative-methods-button-strategy.ts","webpack://checkout/@bigcommerce/checkout-sdk/./packages/paypal-commerce-integration/src/paypal-commerce-alternative-methods/create-paypal-commerce-alternative-methods-button-strategy.ts"],"sourcesContent":["import StandardError from './standard-error';\n\nexport enum MissingDataErrorType {\n    MissingBillingAddress,\n    MissingCart,\n    MissingCheckout,\n    MissingConsignments,\n    MissingCustomer,\n    MissingCheckoutConfig,\n    MissingOrder,\n    MissingOrderConfig,\n    MissingOrderId,\n    MissingPayment,\n    MissingPaymentId,\n    MissingPaymentInstrument,\n    MissingPaymentMethod,\n    MissingPaymentRedirectUrl,\n    MissingPaymentStatus,\n    MissingPaymentToken,\n    MissingShippingAddress,\n}\n\n/**\n * Throw this error when data that is expected to exist is missing. Usually it\n * is due to the fact that certain data has not been retrieved from or saved to\n * the server yet. And such data is required to perform certain actions.\n */\nexport default class MissingDataError extends StandardError {\n    constructor(public subtype: MissingDataErrorType) {\n        super(getErrorMessage(subtype));\n\n        this.name = 'MissingDataError';\n        this.type = 'missing_data';\n    }\n}\n\nfunction getErrorMessage(type: MissingDataErrorType): string {\n    switch (type) {\n        case MissingDataErrorType.MissingBillingAddress:\n            return 'Unable to proceed because billing address data is unavailable.';\n\n        case MissingDataErrorType.MissingCart:\n            return 'Unable to proceed because cart data is unavailable.';\n\n        case MissingDataErrorType.MissingConsignments:\n            return 'Unable to proceed because consignments data is unavailable.';\n\n        case MissingDataErrorType.MissingCheckout:\n            return 'Unable to proceed because checkout data is unavailable.';\n\n        case MissingDataErrorType.MissingCustomer:\n            return 'Unable to proceed because customer data is unavailable.';\n\n        case MissingDataErrorType.MissingCheckoutConfig:\n        case MissingDataErrorType.MissingOrderConfig:\n            return 'Unable to proceed because configuration data is unavailable.';\n\n        case MissingDataErrorType.MissingOrder:\n            return 'Unable to proceed because order data is unavailable.';\n\n        case MissingDataErrorType.MissingOrderId:\n            return 'Unable to proceed because order ID is unavailable or not generated yet.';\n\n        case MissingDataErrorType.MissingPayment:\n            return 'Unable to proceed because payment data is unavailable.';\n\n        case MissingDataErrorType.MissingPaymentToken:\n            return 'Unable to proceed because the token required to submit a payment is missing.';\n\n        case MissingDataErrorType.MissingPaymentMethod:\n            return 'Unable to proceed because payment method data is unavailable or not properly configured.';\n\n        case MissingDataErrorType.MissingShippingAddress:\n            return 'Unable to proceed because shipping address data is unavailable.';\n\n        default:\n            return 'Unable to proceed because the required data is unavailable.';\n    }\n}\n","// The require scope\nvar __webpack_require__ = {};\n\n","import ResolvableModule from './resolvable-module';\n\nexport default function toResolvableModule<TModule, TIdentifier>(\n    module: TModule,\n    resolveIds: TIdentifier[],\n): ResolvableModule<TModule, TIdentifier> {\n    return Object.assign(module, { resolveIds });\n}\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","import CustomError from './custom-error';\nimport setPrototypeOf from './set-prototype-of';\n\n/**\n * This error type should not be constructed directly. It is a base class for\n * all custom errors thrown in this library.\n */\nexport default abstract class StandardError extends Error implements CustomError {\n    name = 'StandardError';\n    type = 'standard';\n\n    constructor(message?: string) {\n        super(message || 'An unexpected error has occurred.');\n\n        setPrototypeOf(this, new.target.prototype);\n\n        if (typeof Error.captureStackTrace === 'function') {\n            Error.captureStackTrace(this, new.target);\n        } else {\n            this.stack = new Error(this.message).stack;\n        }\n    }\n}\n","export default function setPrototypeOf(object: any, prototype: object) {\n    if (Object.setPrototypeOf) {\n        Object.setPrototypeOf(object, prototype);\n    } else {\n        object.__proto__ = prototype;\n    }\n\n    return object;\n}\n","import StandardError from './standard-error';\n\n/**\n * This error should be thrown when the client library of a payment method fails\n * to load, or for some reason, it is inaccessible.\n */\nexport default class PaymentMethodClientUnavailableError extends StandardError {\n    constructor(message?: string) {\n        super(\n            message ||\n                'Unable to proceed because the client library of a payment method is not loaded or ready to be used.',\n        );\n\n        this.name = 'PaymentMethodClientUnavailableError';\n        this.type = 'payment_method_client_unavailable';\n    }\n}\n","import { ScriptLoader } from '@bigcommerce/script-loader';\n\nimport {\n    MissingDataError,\n    MissingDataErrorType,\n    PaymentMethod,\n    PaymentMethodClientUnavailableError,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport {\n    PayPalCommerceHostWindow,\n    PayPalCommerceInitializationData,\n    PayPalFastlaneSdk,\n    PayPalGooglePaySdk,\n    PayPalMessagesSdk,\n    PayPalSdkConfig,\n} from './paypal-commerce-types';\n\nexport default class PayPalCommerceSdk {\n    private window: PayPalCommerceHostWindow;\n\n    constructor(private scriptLoader: ScriptLoader) {\n        this.window = window;\n    }\n\n    async getPayPalFastlaneSdk(\n        paymentMethod: PaymentMethod<PayPalCommerceInitializationData>,\n        currencyCode: string,\n        sessionId: string,\n    ): Promise<PayPalFastlaneSdk> {\n        if (!this.window.paypalFastlaneSdk) {\n            const config = this.getPayPalFastlaneSdkConfiguration(\n                paymentMethod,\n                currencyCode,\n                sessionId,\n            );\n\n            await this.loadPayPalSdk(config);\n\n            if (!this.window.paypalFastlaneSdk) {\n                throw new PaymentMethodClientUnavailableError();\n            }\n        }\n\n        return this.window.paypalFastlaneSdk;\n    }\n\n    async getPayPalGooglePaySdk(\n        paymentMethod: PaymentMethod<PayPalCommerceInitializationData>,\n        currencyCode: string,\n        initializesOnCheckoutPage?: boolean,\n        forceLoad?: boolean,\n    ): Promise<PayPalGooglePaySdk> {\n        if (!this.window.paypalGooglePay || forceLoad) {\n            const paypalSdkScriptConfig = this.getPayPalGooglePaySdkScriptConfigOrThrow(\n                paymentMethod,\n                currencyCode,\n                initializesOnCheckoutPage,\n            );\n\n            await this.loadPayPalSdk(paypalSdkScriptConfig);\n        }\n\n        if (!this.window.paypalGooglePay) {\n            throw new PaymentMethodClientUnavailableError();\n        }\n\n        return this.window.paypalGooglePay;\n    }\n\n    async getPayPalApmsSdk(\n        paymentMethod: PaymentMethod<PayPalCommerceInitializationData>,\n        currencyCode: string,\n    ) {\n        if (!this.window.paypalApms) {\n            const config = this.getPayPalApmSdkConfiguration(paymentMethod, currencyCode);\n\n            await this.loadPayPalSdk(config);\n\n            if (!this.window.paypalApms) {\n                throw new PaymentMethodClientUnavailableError();\n            }\n        }\n\n        return this.window.paypalApms;\n    }\n\n    async getPayPalMessages(\n        paymentMethod: PaymentMethod<PayPalCommerceInitializationData>,\n        currencyCode: string,\n    ): Promise<PayPalMessagesSdk> {\n        if (!this.window.paypalMessages) {\n            const paypalSdkMessagesConfig = this.getPayPalSdkMessagesConfiguration(\n                paymentMethod,\n                currencyCode,\n            );\n\n            await this.loadPayPalSdk(paypalSdkMessagesConfig);\n        }\n\n        if (!this.window.paypalMessages) {\n            throw new PaymentMethodClientUnavailableError();\n        }\n\n        return this.window.paypalMessages;\n    }\n\n    /**\n     *\n     *  loadPayPalSdk is a paypal sdk script loader\n     *  which loads paypal sdk based on provided configuration\n     *\n     */\n    private async loadPayPalSdk({ options, attributes }: PayPalSdkConfig): Promise<void> {\n        const scriptOptions = this.transformConfig<PayPalSdkConfig['options']>(options);\n        const scriptAttributes = this.transformConfig<PayPalSdkConfig['attributes']>(attributes);\n\n        const paypalSdkUrl = 'https://www.paypal.com/sdk/js';\n        const scriptQuery = new URLSearchParams(scriptOptions).toString();\n        const scriptSrc = `${paypalSdkUrl}?${scriptQuery}`;\n\n        await this.scriptLoader.loadScript(scriptSrc, {\n            async: true,\n            attributes: scriptAttributes,\n        });\n    }\n\n    /**\n     *\n     * Configurations section\n     *\n     */\n    private getPayPalFastlaneSdkConfiguration(\n        paymentMethod: PaymentMethod<PayPalCommerceInitializationData>,\n        currencyCode: string,\n        sessionId: string,\n    ): PayPalSdkConfig {\n        const { clientToken, initializationData } = paymentMethod;\n\n        if (!initializationData || !initializationData.clientId) {\n            throw new MissingDataError(MissingDataErrorType.MissingPaymentMethod);\n        }\n\n        const { intent, clientId, merchantId, attributionId } = initializationData;\n\n        return {\n            options: {\n                'client-id': clientId,\n                'merchant-id': merchantId,\n                commit: true,\n                components: [\n                    'fastlane',\n                    'buttons',\n                    'payment-fields',\n                    'hosted-fields',\n                    'three-domain-secure',\n                ],\n                currency: currencyCode,\n                intent,\n            },\n            attributes: {\n                'data-client-metadata-id': sessionId.replace(/-/g, ''),\n                'data-namespace': 'paypalFastlaneSdk',\n                'data-partner-attribution-id': attributionId,\n                'data-sdk-client-token': clientToken,\n            },\n        };\n    }\n\n    private getPayPalGooglePaySdkScriptConfigOrThrow(\n        paymentMethod: PaymentMethod<PayPalCommerceInitializationData>,\n        currencyCode: string,\n        initializesOnCheckoutPage = true,\n    ): PayPalSdkConfig {\n        const { clientToken, initializationData } = paymentMethod;\n\n        if (!initializationData || !initializationData.clientId) {\n            throw new MissingDataError(MissingDataErrorType.MissingPaymentMethod);\n        }\n\n        const {\n            intent,\n            clientId,\n            merchantId,\n            buyerCountry,\n            attributionId,\n            isHostedCheckoutEnabled,\n            isDeveloperModeApplicable,\n        } = initializationData;\n\n        const commit = isHostedCheckoutEnabled || initializesOnCheckoutPage;\n\n        return {\n            options: {\n                'client-id': clientId,\n                'merchant-id': merchantId,\n                commit,\n                components: ['googlepay'],\n                currency: currencyCode,\n                intent,\n                ...(isDeveloperModeApplicable && { 'buyer-country': buyerCountry }),\n            },\n            attributes: {\n                'data-partner-attribution-id': attributionId,\n                'data-client-token': clientToken,\n                'data-namespace': 'paypalGooglePay',\n            },\n        };\n    }\n\n    private getPayPalApmSdkConfiguration(\n        paymentMethod: PaymentMethod<PayPalCommerceInitializationData>,\n        currencyCode: string,\n    ): PayPalSdkConfig {\n        const { initializationData } = paymentMethod;\n\n        if (!initializationData || !initializationData.clientId) {\n            throw new MissingDataError(MissingDataErrorType.MissingPaymentMethod);\n        }\n\n        const {\n            intent,\n            clientId,\n            merchantId,\n            buyerCountry,\n            attributionId,\n            isDeveloperModeApplicable,\n            availableAlternativePaymentMethods = [],\n            enabledAlternativePaymentMethods = [],\n        } = initializationData;\n\n        const enableAPMsFunding = enabledAlternativePaymentMethods;\n        const disableAPMsFunding = availableAlternativePaymentMethods.filter(\n            (apm: string) => !enabledAlternativePaymentMethods.includes(apm),\n        );\n\n        return {\n            options: {\n                'client-id': clientId,\n                'merchant-id': merchantId,\n                'enable-funding': enableAPMsFunding.length > 0 ? enableAPMsFunding : undefined,\n                'disable-funding': disableAPMsFunding.length > 0 ? disableAPMsFunding : undefined,\n                commit: true,\n                components: ['buttons', 'payment-fields'],\n                currency: currencyCode,\n                intent,\n                ...(isDeveloperModeApplicable && { 'buyer-country': buyerCountry }),\n            },\n            attributes: {\n                'data-partner-attribution-id': attributionId,\n                'data-namespace': 'paypalApms',\n            },\n        };\n    }\n\n    private getPayPalSdkMessagesConfiguration(\n        paymentMethod: PaymentMethod<PayPalCommerceInitializationData>,\n        currencyCode: string,\n    ): PayPalSdkConfig {\n        const { initializationData } = paymentMethod;\n\n        if (!initializationData || !initializationData.clientId) {\n            throw new MissingDataError(MissingDataErrorType.MissingPaymentMethod);\n        }\n\n        const { clientId, merchantId, attributionId, isDeveloperModeApplicable, buyerCountry } =\n            initializationData;\n\n        return {\n            options: {\n                'client-id': clientId,\n                'merchant-id': merchantId,\n                components: ['messages'],\n                currency: currencyCode,\n                ...(isDeveloperModeApplicable && { 'buyer-country': buyerCountry }),\n            },\n            attributes: {\n                'data-namespace': 'paypalMessages',\n                'data-partner-attribution-id': attributionId,\n            },\n        };\n    }\n\n    /**\n     *\n     * Utils methods\n     *\n     */\n    private transformConfig<T extends Record<string, unknown>>(config: T): Record<string, string> {\n        let transformedConfig = {};\n\n        const keys = Object.keys(config) as Array<keyof T>;\n\n        keys.forEach((key) => {\n            const value = config[key];\n\n            if (\n                value === undefined ||\n                value === null ||\n                value === '' ||\n                (Array.isArray(value) && value.length === 0)\n            ) {\n                return;\n            }\n\n            transformedConfig = {\n                ...transformedConfig,\n                [key]: Array.isArray(value) ? value.join(',') : value,\n            };\n        });\n\n        return transformedConfig;\n    }\n}\n","import {\n    LoadingIndicatorContainerStyles,\n    LoadingIndicatorStyles,\n} from './loading-indicator-styles';\n\nconst DEFAULT_STYLES: LoadingIndicatorStyles = {\n    size: 70,\n    color: '#d9d9d9',\n    backgroundColor: '#ffffff',\n};\n\nexport const DEFAULT_CONTAINER_STYLES = {\n    position: 'fixed',\n    'background-color': 'rgba(0, 0, 0, 0.4)',\n    'z-index': '1000',\n};\n\nconst ROTATION_ANIMATION = 'embedded-checkout-loading-indicator-rotation';\n\ninterface LoadingIndicatorOptions {\n    styles?: LoadingIndicatorStyles;\n    containerStyles?: LoadingIndicatorContainerStyles;\n}\n\nexport default class LoadingIndicator {\n    private container: HTMLElement;\n    private indicator: HTMLElement;\n    private styles: LoadingIndicatorStyles;\n    private containerStyles: LoadingIndicatorContainerStyles;\n\n    constructor(options?: LoadingIndicatorOptions) {\n        this.styles = { ...DEFAULT_STYLES, ...(options && options.styles) };\n        this.containerStyles = { ...(options && options.containerStyles) };\n\n        this.defineAnimation();\n\n        this.container = this.buildContainer();\n        this.indicator = this.buildIndicator();\n\n        this.container.appendChild(this.indicator);\n    }\n\n    show(parentId?: string): void {\n        if (parentId) {\n            const parent = document.getElementById(parentId);\n\n            if (!parent) {\n                throw new Error(\n                    'Unable to attach the loading indicator because the parent ID is not valid.',\n                );\n            }\n\n            parent.appendChild(this.container);\n        }\n\n        this.container.style.visibility = 'visible';\n        this.container.style.opacity = '1';\n    }\n\n    hide(): void {\n        const handleTransitionEnd = () => {\n            this.container.style.visibility = 'hidden';\n\n            this.container.removeEventListener('transitionend', handleTransitionEnd);\n        };\n\n        this.container.addEventListener('transitionend', handleTransitionEnd);\n\n        this.container.style.opacity = '0';\n    }\n\n    private buildContainer(): HTMLElement {\n        const container = document.createElement('div');\n\n        container.style.display = 'block';\n        container.style.bottom = '0';\n        container.style.left = '0';\n        container.style.height = '100%';\n        container.style.width = '100%';\n        container.style.position = 'absolute';\n        container.style.right = '0';\n        container.style.top = '0';\n        container.style.transition = 'all 250ms ease-out';\n        container.style.opacity = '0';\n\n        this.setStyleAttribute(container, this.containerStyles);\n\n        return container;\n    }\n\n    private buildIndicator(): HTMLElement {\n        const indicator = document.createElement('div');\n\n        indicator.style.display = 'block';\n        indicator.style.width = `${this.styles.size}px`;\n        indicator.style.height = `${this.styles.size}px`;\n        indicator.style.borderRadius = `${this.styles.size}px`;\n        indicator.style.border = 'solid 1px';\n        indicator.style.borderColor = `${this.styles.backgroundColor} ${this.styles.backgroundColor} ${this.styles.color} ${this.styles.color}`;\n        indicator.style.margin = '0 auto';\n        indicator.style.position = 'absolute';\n        indicator.style.left = '0';\n        indicator.style.right = '0';\n        indicator.style.top = '50%';\n        indicator.style.transform = 'translateY(-50%) rotate(0deg)';\n        indicator.style.transformStyle = 'preserve-3d';\n        indicator.style.animation = `${ROTATION_ANIMATION} 500ms infinite cubic-bezier(0.69, 0.31, 0.56, 0.83)`;\n\n        return indicator;\n    }\n\n    private setStyleAttribute(element: HTMLElement, attrs: { [key: string]: string }): void {\n        Object.keys(attrs).forEach((k) => {\n            element.style.setProperty(k, attrs[k]);\n        });\n    }\n\n    private defineAnimation(): void {\n        // In order to define CSS animation, we need to insert a stylesheet into the host frame.\n        // We only have to do it once.\n        if (document.getElementById(ROTATION_ANIMATION)) {\n            return;\n        }\n\n        const style = document.createElement('style');\n\n        style.id = ROTATION_ANIMATION;\n\n        // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n        document.head?.appendChild(style);\n\n        if (style.sheet instanceof CSSStyleSheet) {\n            // We need to provide the 2nd parameter for IE11, even though it is\n            // 0 by default for all other browsers.\n            style.sheet.insertRule(\n                `\n                @keyframes ${ROTATION_ANIMATION} {\n                    0% { transform: translateY(-50%) rotate(0deg); }\n                    100% { transform: translateY(-50%) rotate(360deg); }\n                }\n            `,\n                0,\n            );\n        }\n    }\n}\n","import StandardError from './standard-error';\n\n/**\n * This error should be thrown when a shopper tries to sign in as a guest but\n * they are already signed in as a registered customer.\n */\nexport default class BuyNowCartCreationError extends StandardError {\n    constructor(message?: string) {\n        super(\n            message ||\n                'An unexpected error has occurred during buy now cart creation process. Please try again later.',\n        );\n\n        this.name = 'BuyNowCartCreationError';\n        this.type = 'buy_now_cart_creation_error';\n    }\n}\n","import { Response } from '@bigcommerce/request-sender';\n\nimport StandardError from './standard-error';\n\nconst DEFAULT_RESPONSE = {\n    body: {},\n    headers: {},\n    status: 0,\n};\n\n/**\n * Throw this error if we are unable to make a request to the server. It wraps\n * any server response into a JS error object.\n */\nexport default class RequestError<TBody = any> extends StandardError {\n    body: TBody | {};\n    headers: { [key: string]: any };\n    errors: Array<{ code: string; message?: string }>;\n    status: number;\n\n    constructor(\n        response?: Response<TBody | {}>,\n        {\n            message,\n            errors,\n        }: {\n            message?: string;\n            errors?: Array<{ code: string; message?: string }>;\n        } = {},\n    ) {\n        const { body, headers, status } = response || DEFAULT_RESPONSE;\n\n        super(message || 'An unexpected error has occurred.');\n\n        this.name = 'RequestError';\n        this.type = 'request';\n        this.body = body;\n        this.headers = headers;\n        this.status = status;\n        this.errors = errors || [];\n    }\n}\n","export enum CartSource {\n    BuyNow = 'BUY_NOW',\n}\n","import {\n    BuyNowCartRequestBody,\n    HostedInstrument,\n    ShippingOption,\n    VaultedInstrument,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\n/**\n *\n * PayPal Commerce Funding sources\n *\n */\nexport type FundingType = string[];\nexport type EnableFundingType = FundingType | string;\n\nexport interface PayPalCommerceSDKFunding {\n    CARD: string;\n    PAYPAL: string;\n    CREDIT: string;\n    PAYLATER: string;\n    OXXO: string;\n    SEPA: string;\n    VENMO: string;\n}\n\n/**\n *\n * PayPal Commerce SDK\n *\n */\n\nexport interface PayPalCommerceCardFieldsConfig {\n    inputEvents: {\n        onChange(data: PayPalCommerceCardFieldsState): void;\n        onFocus(data: PayPalCommerceCardFieldsState): void;\n        onBlur(data: PayPalCommerceCardFieldsState): void;\n        onInputSubmitRequest(data: PayPalCommerceCardFieldsState): void;\n    };\n    createVaultSetupToken?: (data: PayPalCommerceCardFieldsState) => void;\n    createOrder?: () => Promise<string>;\n    style: PayPalCommerceHostedFieldsRenderOptions['styles'];\n    onApprove(data: PayPalCommerceCardFieldsOnApproveData): void;\n    onError(): void;\n}\n\nexport interface PayPalCommerceCardFieldsOnApproveData {\n    vaultSetupToken?: string;\n    orderID: string;\n    liabilityShift?: LiabilityShiftEnum;\n}\n\nexport enum LiabilityShiftEnum {\n    Possible = 'POSSIBLE',\n    No = 'NO',\n    Unknown = 'UNKNOWN',\n    Yes = 'YES',\n}\n\ninterface PayPalCommerceCardFieldsFieldData {\n    isFocused: boolean;\n    isEmpty: boolean;\n    isValid: boolean;\n    isPotentiallyValid: boolean;\n}\n\ntype PayPalCommerceCardFieldsCard = PayPalCommerceHostedFieldsCard;\n\nexport interface PayPalCommerceCardFieldsState {\n    cards: PayPalCommerceCardFieldsCard[];\n    emittedBy: string;\n    isFormValid: boolean;\n    errors: string[];\n    fields: {\n        cardCvvField: PayPalCommerceCardFieldsFieldData;\n        cardNumberField: PayPalCommerceCardFieldsFieldData;\n        cardNameField?: PayPalCommerceCardFieldsFieldData;\n        cardExpiryField: PayPalCommerceCardFieldsFieldData;\n    };\n}\n\nexport interface PayPalCommerceFields {\n    render(container: HTMLElement | string): Promise<void>;\n    clear(): void;\n    removeClass(className: string): Promise<void>;\n    close(): Promise<void>;\n}\n\ninterface PayPalCommerceFieldsInitializationData {\n    placeholder?: string;\n}\n\nexport interface PayPalCommerceCardFields {\n    isEligible(): boolean;\n    CVVField(config?: PayPalCommerceFieldsInitializationData): PayPalCommerceFields;\n    ExpiryField(config?: PayPalCommerceFieldsInitializationData): PayPalCommerceFields;\n    NameField(config?: PayPalCommerceFieldsInitializationData): PayPalCommerceFields;\n    NumberField(config?: PayPalCommerceFieldsInitializationData): PayPalCommerceFields;\n    submit(config?: PayPalCommerceCardFieldsSubmitConfig): Promise<void>;\n    getState(): Promise<PayPalCommerceCardFieldsState>;\n}\n\nexport interface PayPalCommerceCardFieldsSubmitConfig {\n    billingAddress: {\n        company?: string;\n        addressLine1: string;\n        addressLine2?: string;\n        adminArea1: string; // State\n        adminArea2: string; // City\n        postalCode: string;\n        countryCode?: string;\n    };\n}\n\nexport interface PayPalSDK {\n    CardFields: (data: PayPalCommerceCardFieldsConfig) => Promise<PayPalCommerceCardFields>;\n    Googlepay: () => {\n        config: () => Promise<GooglePayConfig>;\n        confirmOrder: (arg0: {\n            orderId: string;\n            paymentMethodData: ConfirmOrderData;\n        }) => Promise<{ status: string }>;\n        initiatePayerAction: () => void;\n    };\n    FUNDING: PayPalCommerceSDKFunding;\n    HostedFields: {\n        isEligible(): boolean;\n        render(data: PayPalCommerceHostedFieldsRenderOptions): Promise<PayPalCommerceHostedFields>;\n    };\n    Legal: PayPalLegal & LegalFunding;\n    Buttons(options: PayPalCommerceButtonsOptions): PayPalCommerceButtons;\n    PaymentFields(options: PayPalCommercePaymentFieldsOptions): PayPalCommercePaymentFields;\n    Messages(options: PayPalCommerceMessagesOptions): PayPalCommerceMessages;\n}\n\nexport interface ConfirmOrderData {\n    tokenizationData: {\n        type: string;\n        token: string;\n    };\n    info: {\n        cardNetwork: string;\n        cardDetails: string;\n    };\n    type: string;\n}\n\nexport interface GooglePayConfig {\n    allowedPaymentMethods: AllowedPaymentMethods[];\n    apiVersion: number;\n    apiVersionMinor: number;\n    countryCode: string;\n    isEligible: boolean;\n    merchantInfo: {\n        merchantId: string;\n        merchantOrigin: string;\n    };\n}\n\nexport interface AllowedPaymentMethods {\n    type: string;\n    parameters: {\n        allowedAuthMethods: string[];\n        allowedCardNetworks: string[];\n        billingAddressRequired: boolean;\n        assuranceDetailsRequired: boolean;\n        billingAddressParameters: {\n            format: string;\n        };\n    };\n    tokenizationSpecification: {\n        type: string;\n        parameters: {\n            gateway: string;\n            gatewayMerchantId: string;\n        };\n    };\n}\n\nexport type PayPalLegal = (params: { fundingSource: string }) => {\n    render(container: string): void;\n};\n\nexport interface LegalFunding {\n    FUNDING: {\n        PAY_UPON_INVOICE: string;\n    };\n}\n\nexport interface BirthDate {\n    getFullYear(): number;\n    getDate(): number;\n    getMonth(): number;\n}\n\nexport interface PayPalCommerceScriptParams {\n    options: {\n        'client-id'?: string;\n        'merchant-id'?: string;\n        'buyer-country'?: string;\n        'disable-funding'?: FundingType;\n        'enable-funding'?: EnableFundingType;\n        currency?: string;\n        commit?: boolean;\n        intent?: PayPalCommerceIntent;\n        components?: ComponentsScriptType;\n    };\n    attributes: {\n        'data-client-token'?: string;\n        'data-client-metadata-id'?: string;\n        'data-partner-attribution-id'?: string;\n        'data-user-id-token'?: string;\n    };\n}\n\nexport enum PayPalCommerceIntent {\n    AUTHORIZE = 'authorize',\n    CAPTURE = 'capture',\n}\n\nexport type ComponentsScriptType = Array<\n    | 'buttons'\n    | 'funding-eligibility'\n    | 'hosted-fields'\n    | 'messages'\n    | 'payment-fields'\n    | 'legal'\n    | 'googlepay'\n    | 'connect'\n    | 'card-fields'\n>;\n\nexport interface PayPalCommerceHostWindow extends Window {\n    paypal?: PayPalSDK;\n}\n\n/**\n *\n * PayPal Commerce Initialization Data\n *\n */\nexport interface PayPalCommerceInitializationData {\n    attributionId?: string;\n    availableAlternativePaymentMethods: FundingType;\n    buttonStyle?: PayPalButtonStyleOptions;\n    buyerCountry?: string;\n    clientId: string;\n    clientToken?: string;\n    enabledAlternativePaymentMethods: FundingType;\n    isDeveloperModeApplicable?: boolean;\n    intent?: PayPalCommerceIntent;\n    isAcceleratedCheckoutEnabled?: boolean;\n    isHostedCheckoutEnabled?: boolean;\n    isPayPalCreditAvailable?: boolean;\n    isVenmoEnabled?: boolean;\n    isGooglePayEnabled?: boolean;\n    merchantId?: string;\n    orderId?: string;\n    shouldRenderFields?: boolean;\n    shouldRunAcceleratedCheckout?: boolean;\n    paymentButtonStyles?: Record<string, PayPalButtonStyleOptions>;\n    paypalBNPLConfiguration?: PayPalBNPLConfigurationItem[];\n    isAppSwitchEnabled?: boolean;\n}\n\nexport interface PayPalBNPLConfigurationItem {\n    id: string;\n    name: string;\n    status: boolean;\n    styles: Record<string, string>;\n}\n\n/**\n *\n * PayPal Commerce BuyNow\n *\n */\nexport interface PayPalBuyNowInitializeOptions {\n    getBuyNowCartRequestBody(): BuyNowCartRequestBody;\n}\n\n/**\n *\n * PayPal Commerce Hosted Fields\n *\n */\nexport interface PayPalCommerceHostedFieldsRenderOptions {\n    fields?: {\n        number?: PayPalCommerceHostedFieldOption;\n        cvv?: PayPalCommerceHostedFieldOption;\n        expirationDate?: PayPalCommerceHostedFieldOption;\n    };\n    paymentsSDK?: boolean;\n    styles?: {\n        input?: { [key: string]: string };\n        '.invalid'?: { [key: string]: string };\n        '.valid'?: { [key: string]: string };\n        ':focus'?: { [key: string]: string };\n    };\n    createOrder(): Promise<string>;\n}\n\nexport interface PayPalCommerceHostedFieldOption {\n    selector: string;\n    placeholder?: string;\n}\n\nexport interface PayPalCommerceHostedFields {\n    submit(\n        options?: PayPalCommerceHostedFieldsSubmitOptions,\n    ): Promise<PayPalCommerceHostedFieldsApprove>;\n    getState(): PayPalCommerceHostedFieldsState;\n    on(eventName: string, callback: (event: PayPalCommerceHostedFieldsState) => void): void;\n}\n\nexport interface PayPalCommerceHostedFieldsSubmitOptions {\n    contingencies?: Array<'3D_SECURE'>;\n    cardholderName?: string;\n}\n\nexport interface PayPalCommerceHostedFieldsApprove {\n    orderId: string;\n    liabilityShift?: 'POSSIBLE' | 'NO' | 'UNKNOWN';\n}\n\nexport interface PayPalCommerceHostedFieldsState {\n    cards: PayPalCommerceHostedFieldsCard[];\n    emittedBy: string;\n    fields: {\n        number?: PayPalCommerceHostedFieldsFieldData;\n        expirationDate?: PayPalCommerceHostedFieldsFieldData;\n        expirationMonth?: PayPalCommerceHostedFieldsFieldData;\n        expirationYear?: PayPalCommerceHostedFieldsFieldData;\n        cvv?: PayPalCommerceHostedFieldsFieldData;\n        postalCode?: PayPalCommerceHostedFieldsFieldData;\n    };\n}\n\nexport interface PayPalCommerceHostedFieldsCard {\n    type: string;\n    niceType: string;\n    code: {\n        name: string;\n        size: number;\n    };\n}\n\nexport interface PayPalCommerceHostedFieldsFieldData {\n    container: HTMLElement;\n    isFocused: boolean;\n    isEmpty: boolean;\n    isPotentiallyValid: boolean;\n    isValid: boolean;\n}\n\n/**\n *\n * PayPal Commerce Buttons\n *\n */\nexport interface PayPalCommerceButtons {\n    render(id: string): void;\n    close(): void;\n    isEligible(): boolean;\n    hasReturned?(): boolean;\n    resume?(): void;\n}\n\nexport interface PayPalCommerceButtonsOptions {\n    experience?: string;\n    style?: PayPalButtonStyleOptions;\n    fundingSource: string;\n    createOrder(): Promise<string>;\n    onApprove(\n        data: ApproveCallbackPayload,\n        actions: ApproveCallbackActions,\n    ): Promise<boolean | void> | void;\n    onInit?(data: InitCallbackPayload, actions: InitCallbackActions): Promise<void>;\n    onComplete?(data: CompleteCallbackDataPayload): Promise<void>;\n    onClick?(data: ClickCallbackPayload, actions: ClickCallbackActions): Promise<void> | void;\n    onError?(error: Error): void;\n    onCancel?(): void;\n    onShippingAddressChange?(data: ShippingAddressChangeCallbackPayload): Promise<void>;\n    onShippingOptionsChange?(data: ShippingOptionChangeCallbackPayload): Promise<void>;\n}\n\nexport interface ShippingOptionChangeCallbackPayload {\n    orderId: string;\n    selectedShippingOption: PayPalSelectedShippingOption;\n}\n\nexport interface ShippingAddressChangeCallbackPayload {\n    orderId: string;\n    shippingAddress: PayPalAddress;\n}\n\nexport interface ClickCallbackPayload {\n    fundingSource: string;\n}\n\nexport interface ClickCallbackActions {\n    reject(): void;\n    resolve(): void;\n}\n\nexport interface InitCallbackPayload {\n    correlationID: string;\n}\n\nexport interface InitCallbackActions {\n    disable(): void;\n    enable(): void;\n}\n\nexport interface PayPalAddress {\n    city: string;\n    countryCode: string;\n    postalCode: string;\n    state: string;\n}\n\nexport interface PaypalAddressCallbackData {\n    city: string;\n    country_code: string;\n    postal_code: string;\n    state: string;\n}\n\nexport interface PayPalSelectedShippingOption {\n    amount: {\n        currency_code: string;\n        value: string;\n    };\n    id: string;\n    label: string;\n    selected: boolean;\n    type: string;\n}\n\nexport interface ApproveCallbackPayload {\n    orderID?: string;\n}\n\nexport interface ApproveCallbackActions {\n    order: {\n        get: () => Promise<PayPalOrderDetails>;\n    };\n}\n\nexport interface PayPalOrderDetails {\n    payer: {\n        name: {\n            given_name: string;\n            surname: string;\n        };\n        email_address: string;\n        address: PayPalOrderAddress;\n        phone?: {\n            phone_number: {\n                national_number: string;\n            };\n        };\n    };\n    purchase_units: Array<{\n        shipping: {\n            address: PayPalOrderAddress;\n            name: {\n                full_name: string;\n            };\n        };\n    }>;\n}\n\nexport interface PayPalOrderAddress {\n    address_line_1: string;\n    address_line_2: string;\n    admin_area_2: string;\n    admin_area_1?: string;\n    postal_code: string;\n    country_code: string;\n}\n\nexport interface CompleteCallbackDataPayload {\n    intent: string;\n    orderID: string;\n}\n\nexport enum StyleButtonLabel {\n    paypal = 'paypal',\n    checkout = 'checkout',\n    buynow = 'buynow',\n    pay = 'pay',\n    installment = 'installment',\n}\n\nexport enum StyleButtonColor {\n    gold = 'gold',\n    blue = 'blue',\n    silver = 'silver',\n    black = 'black',\n    white = 'white',\n}\n\nexport enum StyleButtonShape {\n    pill = 'pill',\n    rect = 'rect',\n}\n\nexport interface PayPalButtonStyleOptions {\n    color?: StyleButtonColor;\n    shape?: StyleButtonShape;\n    height?: number;\n    label?: StyleButtonLabel;\n}\n\n/**\n *\n * PayPal Commerce Payment fields\n *\n */\nexport interface PayPalCommercePaymentFields {\n    render(id: string): void;\n}\n\nexport interface PayPalCommercePaymentFieldsOptions {\n    style?: PayPalCommerceFieldsStyleOptions;\n    fundingSource: string;\n    fields: {\n        name?: {\n            value?: string;\n        };\n        email?: {\n            value?: string;\n        };\n    };\n}\n\nexport interface PayPalCommerceFieldsStyleOptions {\n    variables?: {\n        fontFamily?: string;\n        fontSizeBase?: string;\n        fontSizeSm?: string;\n        fontSizeM?: string;\n        fontSizeLg?: string;\n        textColor?: string;\n        colorTextPlaceholder?: string;\n        colorBackground?: string;\n        colorInfo?: string;\n        colorDanger?: string;\n        borderRadius?: string;\n        borderColor?: string;\n        borderWidth?: string;\n        borderFocusColor?: string;\n        spacingUnit?: string;\n    };\n    rules?: {\n        [key: string]: any;\n    };\n}\n\n/**\n *\n * PayPalCommerce Messages\n */\n// TODO: This interface can be removed once the PayPaySDK interface is removed\nexport interface PayPalCommerceMessages {\n    render(id: string): void;\n}\n\n// TODO: This interface can be removed once the PayPaySDK interface is removed\nexport interface PayPalCommerceMessagesOptions {\n    amount: number;\n    placement: string;\n    style?: PayPalCommerceMessagesStyleOptions;\n    fundingSource?: string;\n}\n\n// TODO: This interface can be removed once the PayPaySDK interface is removed\nexport interface PayPalCommerceMessagesStyleOptions {\n    layout?: string;\n}\n\n/**\n *\n * Other\n *\n */\nexport enum NonInstantAlternativePaymentMethods {\n    OXXO = 'oxxo',\n}\n\nexport interface PayPalOrderData {\n    orderId: string;\n    setupToken?: string;\n    approveUrl: string;\n    fastlaneToken?: string;\n}\n\nexport interface PayPalUpdateOrderRequestBody {\n    availableShippingOptions?: ShippingOption[];\n    cartId: string;\n    selectedShippingOption?: ShippingOption;\n}\n\nexport interface PayPalUpdateOrderResponse {\n    statusCode: number;\n}\n\nexport interface PayPalCreateOrderRequestBody extends HostedInstrument, VaultedInstrument {\n    cartId: string;\n    metadataId?: string;\n    setupToken?: boolean;\n    fastlaneToken?: string;\n}\n\nexport enum PayPalOrderStatus {\n    Approved = 'APPROVED',\n    Created = 'CREATED',\n    PayerActionRequired = 'PAYER_ACTION_REQUIRED',\n    PollingStop = 'POLLING_STOP',\n    PollingError = 'POLLING_ERROR',\n}\n\nexport interface PayPalOrderStatusData {\n    status: PayPalOrderStatus;\n}\n\nexport interface PayPalCreateOrderCardFieldsResponse {\n    orderId: string;\n    setupToken?: string;\n}\n","import { FormPoster } from '@bigcommerce/form-poster';\nimport { isNil, omitBy } from 'lodash';\n\nimport {\n    BillingAddressRequestBody,\n    BuyNowCartCreationError,\n    Cart,\n    CartSource,\n    MissingDataError,\n    MissingDataErrorType,\n    PaymentIntegrationService,\n    PaymentMethodClientUnavailableError,\n    RequestError,\n    RequestOptions,\n    ShippingOption,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport PayPalCommerceRequestSender from './paypal-commerce-request-sender';\nimport PayPalCommerceScriptLoader from './paypal-commerce-script-loader';\nimport {\n    PayPalButtonStyleOptions,\n    PayPalBuyNowInitializeOptions,\n    PayPalCommerceInitializationData,\n    PayPalCreateOrderCardFieldsResponse,\n    PayPalCreateOrderRequestBody,\n    PayPalOrderDetails,\n    PayPalOrderStatus,\n    PayPalSDK,\n    StyleButtonColor,\n    StyleButtonLabel,\n    StyleButtonShape,\n} from './paypal-commerce-types';\n\nexport default class PayPalCommerceIntegrationService {\n    private paypalSdk?: PayPalSDK;\n\n    constructor(\n        private formPoster: FormPoster,\n        private paymentIntegrationService: PaymentIntegrationService,\n        private paypalCommerceRequestSender: PayPalCommerceRequestSender,\n        private paypalCommerceScriptLoader: PayPalCommerceScriptLoader,\n    ) {}\n\n    /**\n     *\n     * PayPalSDK methods\n     *\n     */\n    async loadPayPalSdk(\n        methodId: string,\n        providedCurrencyCode?: string,\n        initializesOnCheckoutPage?: boolean,\n        forceLoad?: boolean,\n    ): Promise<PayPalSDK | undefined> {\n        const state = this.paymentIntegrationService.getState();\n        const currencyCode = providedCurrencyCode || state.getCartOrThrow().currency.code;\n        const paymentMethod =\n            state.getPaymentMethodOrThrow<PayPalCommerceInitializationData>(methodId);\n\n        this.paypalSdk = await this.paypalCommerceScriptLoader.getPayPalSDK(\n            paymentMethod,\n            currencyCode,\n            initializesOnCheckoutPage,\n            forceLoad,\n        );\n\n        return this.paypalSdk;\n    }\n\n    getPayPalSdkOrThrow(): PayPalSDK {\n        if (!this.paypalSdk) {\n            throw new PaymentMethodClientUnavailableError();\n        }\n\n        return this.paypalSdk;\n    }\n\n    /**\n     *\n     * Buy Now cart creation methods\n     *\n     */\n    async createBuyNowCartOrThrow(\n        buyNowInitializeOptions: PayPalBuyNowInitializeOptions,\n    ): Promise<Cart> {\n        const cartRequestBody = buyNowInitializeOptions.getBuyNowCartRequestBody();\n\n        if (!cartRequestBody) {\n            throw new MissingDataError(MissingDataErrorType.MissingCart);\n        }\n\n        try {\n            return await this.paymentIntegrationService.createBuyNowCart(cartRequestBody);\n        } catch (error) {\n            throw new BuyNowCartCreationError();\n        }\n    }\n\n    /**\n     *\n     * Order methods\n     *\n     */\n    async createOrder(\n        providerId: string,\n        requestBody?: Partial<PayPalCreateOrderRequestBody>,\n    ): Promise<string> {\n        const cartId = this.paymentIntegrationService.getState().getCartOrThrow().id;\n\n        const { orderId } = await this.paypalCommerceRequestSender.createOrder(providerId, {\n            cartId,\n            ...requestBody,\n        });\n\n        return orderId;\n    }\n\n    async createOrderCardFields(\n        providerId: string,\n        requestBody?: Partial<PayPalCreateOrderRequestBody>,\n    ): Promise<PayPalCreateOrderCardFieldsResponse> {\n        const cartId = this.paymentIntegrationService.getState().getCartOrThrow().id;\n\n        const { orderId, setupToken } = await this.paypalCommerceRequestSender.createOrder(\n            providerId,\n            {\n                cartId,\n                ...requestBody,\n            },\n        );\n\n        return { orderId, ...(setupToken ? { setupToken } : {}) };\n    }\n\n    async updateOrder(): Promise<void> {\n        const state = this.paymentIntegrationService.getState();\n        const cart = state.getCartOrThrow();\n        const consignment = state.getConsignmentsOrThrow()[0];\n\n        try {\n            await this.paypalCommerceRequestSender.updateOrder({\n                availableShippingOptions: consignment.availableShippingOptions,\n                cartId: cart.id,\n                selectedShippingOption: consignment.selectedShippingOption,\n            });\n        } catch (_error) {\n            throw new RequestError();\n        }\n    }\n\n    async getOrderStatus(methodId?: string, options?: RequestOptions): Promise<PayPalOrderStatus> {\n        try {\n            const { status } = await this.paypalCommerceRequestSender.getOrderStatus(\n                methodId,\n                options,\n            );\n\n            return status;\n        } catch (_error) {\n            throw new RequestError();\n        }\n    }\n\n    /**\n     *\n     * Payment submitting and tokenizing methods\n     *\n     */\n    tokenizePayment(methodId: string, orderId?: string): void {\n        const cart = this.paymentIntegrationService.getState().getCartOrThrow();\n\n        if (!orderId) {\n            throw new MissingDataError(MissingDataErrorType.MissingOrderId);\n        }\n\n        return this.formPoster.postForm('/checkout.php', {\n            payment_type: 'paypal',\n            action: 'set_external_checkout',\n            provider: methodId,\n            order_id: orderId,\n            ...(cart.source === CartSource.BuyNow && { cart_id: cart.id }),\n        });\n    }\n\n    async submitPayment(methodId: string, orderId: string, gatewayId?: string): Promise<void> {\n        const paymentData = {\n            formattedPayload: {\n                vault_payment_instrument: null,\n                set_as_default_stored_instrument: null,\n                device_info: null,\n                method_id: methodId,\n                paypal_account: {\n                    order_id: orderId,\n                },\n            },\n        };\n\n        await this.paymentIntegrationService.submitPayment({\n            methodId,\n            paymentData,\n            ...(gatewayId ? { gatewayId } : {}),\n        });\n    }\n\n    /**\n     *\n     * Shipping options methods\n     *\n     */\n    getShippingOptionOrThrow(selectedShippingOptionId?: string): ShippingOption {\n        const state = this.paymentIntegrationService.getState();\n        const consignment = state.getConsignmentsOrThrow()[0];\n\n        const availableShippingOptions = consignment.availableShippingOptions || [];\n\n        const recommendedShippingOption = availableShippingOptions.find(\n            (option) => option.isRecommended,\n        );\n\n        const selectedShippingOption = selectedShippingOptionId\n            ? availableShippingOptions.find((option) => option.id === selectedShippingOptionId)\n            : availableShippingOptions.find(\n                  (option) => option.id === consignment.selectedShippingOption?.id,\n              );\n\n        const shippingOptionToSelect =\n            selectedShippingOption || recommendedShippingOption || availableShippingOptions[0];\n\n        if (!shippingOptionToSelect) {\n            throw new Error(\"Your order can't be shipped to this address\");\n        }\n\n        return shippingOptionToSelect;\n    }\n\n    /**\n     *\n     * Address transforming methods\n     *\n     */\n    getAddress(address?: Partial<BillingAddressRequestBody>): BillingAddressRequestBody {\n        return {\n            firstName: address?.firstName || '',\n            lastName: address?.lastName || '',\n            email: address?.email || '',\n            phone: address?.phone || '',\n            company: '',\n            address1: address?.address1 || '',\n            address2: address?.address2 || '',\n            city: address?.city || '',\n            countryCode: address?.countryCode || '',\n            postalCode: address?.postalCode || '',\n            stateOrProvince: '',\n            stateOrProvinceCode: address?.stateOrProvinceCode || '',\n            customFields: [],\n        };\n    }\n\n    getBillingAddressFromOrderDetails({ payer }: PayPalOrderDetails): BillingAddressRequestBody {\n        return this.getAddress({\n            firstName: payer.name.given_name,\n            lastName: payer.name.surname,\n            email: payer.email_address,\n            address1: payer.address.address_line_1,\n            address2: payer.address.address_line_2,\n            city: payer.address.admin_area_2,\n            countryCode: payer.address.country_code,\n            postalCode: payer.address.postal_code,\n            stateOrProvinceCode: payer.address.admin_area_1,\n            phone: payer.phone?.phone_number?.national_number,\n        });\n    }\n\n    getShippingAddressFromOrderDetails(\n        orderDetails: PayPalOrderDetails,\n    ): BillingAddressRequestBody {\n        const { payer, purchase_units } = orderDetails;\n        const {\n            address,\n            name: { full_name },\n        } = purchase_units[0].shipping;\n\n        const [firstName, ...lastName] = full_name.split(' ');\n\n        return this.getAddress({\n            firstName,\n            lastName: lastName.join(' '),\n            email: payer.email_address,\n            address1: address.address_line_1,\n            address2: address.address_line_2,\n            city: address.admin_area_2,\n            countryCode: address.country_code,\n            postalCode: address.postal_code,\n            stateOrProvinceCode: address.admin_area_1,\n        });\n    }\n\n    /**\n     *\n     * Buttons style methods\n     *\n     */\n    getValidButtonStyle(style?: PayPalButtonStyleOptions): PayPalButtonStyleOptions {\n        const { color, height, label, shape } = style || {};\n\n        const validStyles = {\n            color: color && StyleButtonColor[color] ? color : undefined,\n            height: this.getValidHeight(height),\n            label: label && StyleButtonLabel[label] ? label : undefined,\n            shape: shape && StyleButtonShape[shape] ? shape : undefined,\n        };\n\n        return omitBy(validStyles, isNil);\n    }\n\n    getValidHeight(height?: number): number {\n        const defaultHeight = 40;\n        const minHeight = 25;\n        const maxHeight = 55;\n\n        if (!height || typeof height !== 'number') {\n            return defaultHeight;\n        }\n\n        if (height > maxHeight) {\n            return maxHeight;\n        }\n\n        if (height < minHeight) {\n            return minHeight;\n        }\n\n        return height;\n    }\n\n    /**\n     *\n     * Utils methods\n     *\n     */\n    removeElement(elementId?: string): void {\n        const element = elementId && document.getElementById(elementId);\n\n        if (element) {\n            // For now this is a temporary solution, further removeElement method will be removed\n            element.style.display = 'none';\n        }\n    }\n}\n","export const INTERNAL_USE_ONLY =\n    'This API endpoint is for internal use only and may change in the future';\n","enum ContentType {\n    Json = 'application/json',\n    JsonV1 = 'application/vnd.bc.v1+json',\n}\n\nexport default ContentType;\n","export const SDK_VERSION_HEADERS = { 'X-Checkout-SDK-Version': LIBRARY_VERSION };\n","import { RequestSender } from '@bigcommerce/request-sender';\n\nimport {\n    ContentType,\n    INTERNAL_USE_ONLY,\n    RequestOptions,\n    SDK_VERSION_HEADERS,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport {\n    PayPalCreateOrderRequestBody,\n    PayPalOrderData,\n    PayPalOrderStatusData,\n    PayPalUpdateOrderRequestBody,\n    PayPalUpdateOrderResponse,\n} from './paypal-commerce-types';\n\nexport default class PayPalCommerceRequestSender {\n    constructor(private requestSender: RequestSender) {}\n\n    async createOrder(\n        providerId: string,\n        requestBody: Partial<PayPalCreateOrderRequestBody>,\n    ): Promise<PayPalOrderData> {\n        const url = `/api/storefront/payment/${providerId}`;\n        const body = requestBody;\n        const headers = {\n            'X-API-INTERNAL': INTERNAL_USE_ONLY,\n            'Content-Type': ContentType.Json,\n            ...SDK_VERSION_HEADERS,\n        };\n\n        const res = await this.requestSender.post<PayPalOrderData>(url, { headers, body });\n\n        return res.body;\n    }\n\n    async updateOrder(\n        requestBody: PayPalUpdateOrderRequestBody,\n    ): Promise<PayPalUpdateOrderResponse> {\n        const url = `/api/storefront/initialization/paypalcommerce`;\n        const body = requestBody;\n        const headers = {\n            'X-API-INTERNAL': INTERNAL_USE_ONLY,\n            'Content-Type': ContentType.Json,\n            ...SDK_VERSION_HEADERS,\n        };\n\n        const res = await this.requestSender.put<PayPalUpdateOrderResponse>(url, { headers, body });\n\n        return res.body;\n    }\n\n    async getOrderStatus(\n        methodId = 'paypalcommerce',\n        options?: RequestOptions,\n    ): Promise<PayPalOrderStatusData> {\n        const url = `/api/storefront/initialization/${methodId}`;\n        const headers = {\n            'X-API-INTERNAL': INTERNAL_USE_ONLY,\n            'Content-Type': ContentType.Json,\n            ...SDK_VERSION_HEADERS,\n        };\n\n        const res = await this.requestSender.get<PayPalOrderStatusData>(url, {\n            headers,\n            ...options,\n        });\n\n        return res.body;\n    }\n}\n","import { ScriptLoader } from '@bigcommerce/script-loader';\n\nimport {\n    MissingDataError,\n    MissingDataErrorType,\n    PaymentMethod,\n    PaymentMethodClientUnavailableError,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport {\n    ComponentsScriptType,\n    FundingType,\n    PayPalCommerceHostWindow,\n    PayPalCommerceInitializationData,\n    PayPalCommerceScriptParams,\n    PayPalSDK,\n} from './paypal-commerce-types';\n\nexport default class PayPalCommerceScriptLoader {\n    private window: PayPalCommerceHostWindow;\n\n    constructor(private scriptLoader: ScriptLoader) {\n        this.window = window;\n    }\n\n    async getPayPalSDK(\n        paymentMethod: PaymentMethod<PayPalCommerceInitializationData>,\n        currencyCode: string,\n        initializesOnCheckoutPage?: boolean,\n        forceLoad?: boolean,\n    ): Promise<PayPalSDK> {\n        const paypalSdkScriptConfig = this.getPayPalSdkScriptConfigOrThrow(\n            paymentMethod,\n            currencyCode,\n            initializesOnCheckoutPage,\n        );\n\n        return this.loadPayPalSDK(paypalSdkScriptConfig, forceLoad);\n    }\n\n    private async loadPayPalSDK(\n        paypalSdkScriptConfig: PayPalCommerceScriptParams,\n        forceLoad = false,\n    ): Promise<PayPalSDK> {\n        if (!this.window.paypal || forceLoad) {\n            const options = this.transformConfig<PayPalCommerceScriptParams['options']>(\n                paypalSdkScriptConfig.options,\n            );\n            const attributes = this.transformConfig<PayPalCommerceScriptParams['attributes']>(\n                paypalSdkScriptConfig.attributes,\n            );\n\n            const paypalSdkUrl = 'https://www.paypal.com/sdk/js';\n            const scriptQuery = new URLSearchParams(options).toString();\n            const scriptSrc = `${paypalSdkUrl}?${scriptQuery}`;\n\n            await this.scriptLoader.loadScript(scriptSrc, { async: true, attributes });\n        }\n\n        if (!this.window.paypal) {\n            throw new PaymentMethodClientUnavailableError();\n        }\n\n        return this.window.paypal;\n    }\n\n    private getPayPalSdkScriptConfigOrThrow(\n        paymentMethod: PaymentMethod<PayPalCommerceInitializationData>,\n        currencyCode: string,\n        initializesOnCheckoutPage = true,\n    ): PayPalCommerceScriptParams {\n        const { id, clientToken, initializationData } = paymentMethod;\n\n        if (!initializationData?.clientId) {\n            throw new MissingDataError(MissingDataErrorType.MissingPaymentMethod);\n        }\n\n        const {\n            intent,\n            clientId,\n            merchantId,\n            buyerCountry,\n            attributionId,\n            isVenmoEnabled,\n            isHostedCheckoutEnabled,\n            isPayPalCreditAvailable,\n            isDeveloperModeApplicable,\n            availableAlternativePaymentMethods = [],\n            enabledAlternativePaymentMethods = [],\n            isGooglePayEnabled,\n        } = initializationData;\n\n        const commit = isHostedCheckoutEnabled || initializesOnCheckoutPage;\n\n        const shouldEnableCard = id === 'paypalcommercecreditcards';\n        const enableCardFunding = shouldEnableCard ? ['card'] : [];\n        const disableCardFunding = !shouldEnableCard ? ['card'] : [];\n\n        const enableCreditFunding = isPayPalCreditAvailable ? ['credit', 'paylater'] : [];\n        const disableCreditFunding = !isPayPalCreditAvailable ? ['credit', 'paylater'] : [];\n\n        const shouldEnableAPMs = initializesOnCheckoutPage || !commit;\n        const enableVenmoFunding = isVenmoEnabled ? ['venmo'] : [];\n        const disableVenmoFunding = !isVenmoEnabled ? ['venmo'] : [];\n        const enableAPMsFunding = shouldEnableAPMs ? enabledAlternativePaymentMethods : [];\n        const disableAPMsFunding = shouldEnableAPMs\n            ? availableAlternativePaymentMethods.filter(\n                  (apm: string) => !enabledAlternativePaymentMethods.includes(apm),\n              )\n            : availableAlternativePaymentMethods;\n        const googlePayComponent: ComponentsScriptType = isGooglePayEnabled ? ['googlepay'] : [];\n        const cardFieldsComponent: ComponentsScriptType = initializesOnCheckoutPage\n            ? ['card-fields']\n            : [];\n        const disableFunding: FundingType = [\n            ...disableCardFunding,\n            ...disableCreditFunding,\n            ...disableVenmoFunding,\n            ...disableAPMsFunding,\n        ];\n        const enableFunding: FundingType = [\n            ...enableCardFunding,\n            ...enableCreditFunding,\n            ...enableVenmoFunding,\n            ...enableAPMsFunding,\n        ];\n\n        return {\n            options: {\n                'client-id': clientId,\n                'merchant-id': merchantId,\n                'enable-funding': enableFunding.length > 0 ? enableFunding : undefined,\n                'disable-funding': disableFunding.length > 0 ? disableFunding : undefined,\n                commit,\n                components: [\n                    'buttons',\n                    'hosted-fields',\n                    'payment-fields',\n                    'legal',\n                    ...googlePayComponent,\n                    ...cardFieldsComponent,\n                ],\n                currency: currencyCode,\n                intent,\n                ...(isDeveloperModeApplicable && { 'buyer-country': buyerCountry }),\n            },\n            attributes: {\n                'data-partner-attribution-id': attributionId,\n                'data-client-token': clientToken,\n            },\n        };\n    }\n\n    private transformConfig<T extends Record<string, unknown>>(config: T): Record<string, string> {\n        let transformedConfig = {};\n\n        const keys = Object.keys(config) as Array<keyof T>;\n\n        keys.forEach((key) => {\n            const value = config[key];\n\n            if (\n                value === undefined ||\n                value === null ||\n                value === '' ||\n                (Array.isArray(value) && value.length === 0)\n            ) {\n                return;\n            }\n\n            transformedConfig = {\n                ...transformedConfig,\n                [key]: Array.isArray(value) ? value.join(',') : value,\n            };\n        });\n\n        return transformedConfig;\n    }\n}\n","import { createFormPoster } from '@bigcommerce/form-poster';\nimport { createRequestSender } from '@bigcommerce/request-sender';\nimport { getScriptLoader } from '@bigcommerce/script-loader';\n\nimport { PaymentIntegrationService } from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport {\n    PayPalCommerceIntegrationService,\n    PayPalCommerceRequestSender,\n    PayPalCommerceScriptLoader,\n} from './index';\n\nconst createPayPalCommerceIntegrationService = (\n    paymentIntegrationService: PaymentIntegrationService,\n) => {\n    const { getHost } = paymentIntegrationService.getState();\n\n    return new PayPalCommerceIntegrationService(\n        createFormPoster(),\n        paymentIntegrationService,\n        new PayPalCommerceRequestSender(createRequestSender({ host: getHost() })),\n        new PayPalCommerceScriptLoader(getScriptLoader()),\n    );\n};\n\nexport default createPayPalCommerceIntegrationService;\n","export const LOADING_INDICATOR_STYLES = {\n    'background-color': 'rgba(0, 0, 0, 0.4)',\n    'z-index': '1000',\n};\n","import StandardError from './standard-error';\n\n/**\n * This error should be thrown when a method is unable to proceed because the\n * caller has not provided all the arguments according to their requirements,\n * i.e.: if an argument is missing or it is not the expected data type.\n */\nexport default class InvalidArgumentError extends StandardError {\n    constructor(message?: string) {\n        super(message || 'Invalid arguments have been provided.');\n\n        this.name = 'InvalidArgumentError';\n        this.type = 'invalid_argument';\n    }\n}\n","import InvalidArgumentError from './invalid-argument-error';\n\n/**\n * This error should be thrown when we are unable to submit a payment because\n * the caller has not provided all the required fields, i.e.: if an argument is\n * missing or it is not the expected data type.\n */\nexport default class PaymentArgumentInvalidError extends InvalidArgumentError {\n    constructor(invalidFields?: string[]) {\n        let message = 'Unable to submit payment for the order because the payload is invalid.';\n\n        if (invalidFields) {\n            message = `${message} Make sure the following fields are provided correctly: ${invalidFields.join(\n                ', ',\n            )}.`;\n        }\n\n        super(message);\n\n        this.name = 'PaymentArgumentInvalidError';\n    }\n}\n","import { Response } from '@bigcommerce/request-sender';\n\nimport RequestError from './request-error';\n\n/**\n * Throw this error if we are unable to successfully submit a server request\n * using a payment method because the method has invalid configuration or is in\n * an invalid state.\n */\nexport default class PaymentMethodInvalidError<T = any> extends RequestError<T> {\n    constructor(response?: Response<T>) {\n        super(response, {\n            message: 'There is a problem processing your payment. Please try again later.',\n        });\n\n        this.name = 'PaymentMethodInvalidError';\n        this.type = 'payment_method_invalid';\n    }\n}\n","import StandardError from './standard-error';\n\n/**\n * Throw this error if we are trying to make an order finalization request for a\n * payment method that does not require such procedure.\n */\nexport default class OrderFinalizationNotRequiredError extends StandardError {\n    constructor() {\n        super('The current order does not need to be finalized at this stage.');\n\n        this.name = 'OrderFinalizationNotRequiredError';\n        this.type = 'order_finalization_not_required';\n    }\n}\n","import { HostedInstrument } from './payment';\n\nexport default function isHostedInstrumentLike(\n    instrument: unknown,\n): instrument is HostedInstrument {\n    return (\n        typeof instrument === 'object' &&\n        instrument !== null &&\n        (typeof (instrument as HostedInstrument).shouldSaveInstrument === 'undefined' ||\n            typeof (instrument as HostedInstrument).shouldSaveInstrument === 'boolean') &&\n        (typeof (instrument as HostedInstrument).shouldSetAsDefaultInstrument === 'undefined' ||\n            typeof (instrument as HostedInstrument).shouldSetAsDefaultInstrument === 'boolean')\n    );\n}\n","import {\n    FormattedPayload,\n    FormattedVaultedInstrument,\n    HostedVaultedInstrument,\n    PaymentInstrumentPayload,\n    VaultedInstrument,\n} from './payment';\n\nexport default function isVaultedInstrument(\n    instrument: PaymentInstrumentPayload,\n): instrument is VaultedInstrument {\n    return Boolean((instrument as VaultedInstrument).instrumentId);\n}\n\nexport function isHostedVaultedInstrument(\n    instrument: PaymentInstrumentPayload,\n): instrument is HostedVaultedInstrument {\n    return (\n        Boolean((instrument as HostedVaultedInstrument).instrumentId) &&\n        !Object.prototype.hasOwnProperty.call(instrument, 'ccNumber') &&\n        !Object.prototype.hasOwnProperty.call(instrument, 'ccCvv')\n    );\n}\n\nexport function isFormattedVaultedInstrument(\n    instrument: PaymentInstrumentPayload,\n): instrument is FormattedPayload<FormattedVaultedInstrument> {\n    const formattedInstrument = (instrument as FormattedPayload<FormattedVaultedInstrument>)\n        .formattedPayload;\n\n    if (!formattedInstrument) {\n        return false;\n    }\n\n    return (\n        typeof formattedInstrument.bigpay_token === 'string' ||\n        Boolean(formattedInstrument.bigpay_token && formattedInstrument.bigpay_token.token)\n    );\n}\n","import RequestError from './request-error';\n\n// Have to use `as` https://stackoverflow.com/questions/73987044/typeguarding-an-unknown-nested-object should be fixed in 4.8+\nconst isRequestError = (error: unknown): error is RequestError => {\n    return typeof error === 'object' && error !== null && 'body' in error;\n};\n\nexport default isRequestError;\n","import { MessagesStyleOptions, PayPalBNPLConfigurationItem } from '../paypal-commerce-types';\n\nfunction getPaypalMessagesStylesFromBNPLConfig({\n    styles,\n}: PayPalBNPLConfigurationItem): MessagesStyleOptions {\n    const messagesStyles: MessagesStyleOptions = {};\n\n    if (styles.color) {\n        messagesStyles.color = styles.color;\n    }\n\n    if (styles.layout) {\n        messagesStyles.layout = styles.layout;\n    }\n\n    if (styles['logo-type'] || styles['logo-position']) {\n        messagesStyles.logo = {};\n\n        if (styles['logo-type']) {\n            messagesStyles.logo.type = styles['logo-type'];\n        }\n\n        if (styles['logo-position']) {\n            messagesStyles.logo.position = styles['logo-position'];\n        }\n    }\n\n    if (styles.ratio) {\n        messagesStyles.ratio = styles.ratio;\n    }\n\n    if (styles['text-color'] || styles['text-size']) {\n        messagesStyles.text = {};\n\n        if (styles['text-color']) {\n            messagesStyles.text.color = styles['text-color'];\n        }\n\n        if (styles['text-size']) {\n            messagesStyles.text.size = +styles['text-size'];\n        }\n    }\n\n    return messagesStyles;\n}\n\nexport default getPaypalMessagesStylesFromBNPLConfig;\n","export interface BaseInstrument {\n    bigpayToken: string;\n    defaultInstrument: boolean;\n    provider: string;\n    trustedShippingAddress: boolean;\n    method: string;\n    type: string;\n}\n\nexport function isBaseInstrument(instrument: unknown): instrument is BaseInstrument {\n    if (typeof instrument !== 'object' || instrument === null) {\n        return false;\n    }\n\n    return (\n        'bigpayToken' in instrument &&\n        'defaultInstrument' in instrument &&\n        'provider' in instrument &&\n        'trustedShippingAddress' in instrument &&\n        'method' in instrument &&\n        'type' in instrument\n    );\n}\n","import {\n    HostedInstrument,\n    InvalidArgumentError,\n    isHostedInstrumentLike,\n    isVaultedInstrument,\n    OrderFinalizationNotRequiredError,\n    OrderPaymentRequestBody,\n    OrderRequestBody,\n    Payment,\n    PaymentArgumentInvalidError,\n    PaymentInitializeOptions,\n    PaymentInstrumentPayload,\n    PaymentIntegrationService,\n    PaymentMethodInvalidError,\n    PaymentRequestOptions,\n    PaymentStrategy,\n    VaultedInstrument,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\nimport {\n    getPaypalMessagesStylesFromBNPLConfig,\n    isPaypalCommerceProviderError,\n    isRedirectActionError,\n    MessagingOptions,\n    PayPalBNPLConfigurationItem,\n    PayPalCommerceSdk,\n    PayPalMessagesSdk,\n} from '@bigcommerce/checkout-sdk/paypal-commerce-utils';\nimport { LoadingIndicator } from '@bigcommerce/checkout-sdk/ui';\nimport { isBaseInstrument } from '@bigcommerce/checkout-sdk/utility';\n\nimport PayPalCommerceIntegrationService from '../paypal-commerce-integration-service';\nimport {\n    ApproveCallbackPayload,\n    ClickCallbackActions,\n    PayPalCommerceButtons,\n    PayPalCommerceButtonsOptions,\n    PayPalCommerceInitializationData,\n} from '../paypal-commerce-types';\n\nimport PayPalCommercePaymentInitializeOptions, {\n    WithPayPalCommercePaymentInitializeOptions,\n} from './paypal-commerce-payment-initialize-options';\n\nexport default class PayPalCommercePaymentStrategy implements PaymentStrategy {\n    private loadingIndicatorContainer?: string;\n    private orderId?: string;\n    private paypalButton?: PayPalCommerceButtons;\n    private paypalcommerce?: PayPalCommercePaymentInitializeOptions;\n\n    constructor(\n        private paymentIntegrationService: PaymentIntegrationService,\n        private paypalCommerceIntegrationService: PayPalCommerceIntegrationService,\n        private paypalCommerceSdk: PayPalCommerceSdk,\n        private loadingIndicator: LoadingIndicator,\n    ) {}\n\n    async initialize(\n        options?: PaymentInitializeOptions & WithPayPalCommercePaymentInitializeOptions,\n    ): Promise<void> {\n        const { methodId, paypalcommerce } = options || {};\n\n        this.paypalcommerce = paypalcommerce;\n\n        if (!methodId) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.methodId\" argument is not provided.',\n            );\n        }\n\n        if (!paypalcommerce) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.paypalcommerce\" argument is not provided.`,\n            );\n        }\n\n        await this.paymentIntegrationService.loadPaymentMethod(methodId);\n\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod =\n            state.getPaymentMethodOrThrow<PayPalCommerceInitializationData>(methodId);\n\n        const { container, bannerContainerId } = paypalcommerce;\n\n        const {\n            orderId,\n            paypalBNPLConfiguration = [],\n            isPayPalCreditAvailable,\n        } = paymentMethod.initializationData || {};\n\n        if (bannerContainerId !== undefined) {\n            if (!document.getElementById(bannerContainerId)) {\n                // eslint-disable-next-line no-console\n                console.error('Unable to create banner without valid banner container ID.');\n\n                return;\n            }\n\n            const bannerConfiguration = paypalBNPLConfiguration?.find(\n                ({ id }) => id === 'checkout',\n            );\n\n            if (isPayPalCreditAvailable || !bannerConfiguration?.status) {\n                return;\n            }\n\n            const paypalMessages = await this.paypalCommerceSdk.getPayPalMessages(\n                paymentMethod,\n                state.getCartOrThrow().currency.code,\n            );\n\n            if (!paypalMessages || typeof paypalMessages?.Messages !== 'function') {\n                console.error(\n                    '[BC PayPalCommerce PayLater]: banner could not be rendered, due to issues with loading PayPal SDK',\n                );\n\n                return;\n            }\n\n            return this.renderMessages(paypalMessages, bannerContainerId, bannerConfiguration);\n        }\n\n        // Info:\n        // The PayPal button and fields should not be rendered when shopper was redirected to Checkout page\n        // after using smart payment button on PDP or Cart page. In this case backend returns order id if\n        // it is available in checkout session. Therefore, it is not necessary to render PayPal button.\n        if (orderId) {\n            this.orderId = paymentMethod.initializationData?.orderId;\n\n            return;\n        }\n\n        this.loadingIndicatorContainer = container?.split('#')[1];\n\n        await this.paypalCommerceIntegrationService.loadPayPalSdk(methodId);\n\n        if (paypalcommerce.onInit && typeof paypalcommerce.onInit === 'function') {\n            paypalcommerce.onInit(() => this.renderButton(methodId, paypalcommerce));\n        }\n\n        if (\n            paypalcommerce.shouldRenderPayPalButtonOnInitialization === undefined ||\n            paypalcommerce.shouldRenderPayPalButtonOnInitialization\n        ) {\n            this.renderButton(methodId, paypalcommerce);\n        }\n    }\n\n    async execute(payload: OrderRequestBody, options?: PaymentRequestOptions): Promise<void> {\n        const { payment, ...order } = payload;\n        const { onError } = this.paypalcommerce || {};\n\n        if (!payment) {\n            throw new PaymentArgumentInvalidError(['payment']);\n        }\n\n        const { methodId, paymentData } = payment;\n\n        if (this.isPayPalVaultedInstrumentPaymentData(paymentData) && !this.orderId) {\n            this.orderId = await this.createOrder();\n        }\n\n        if (!this.orderId) {\n            throw new PaymentMethodInvalidError();\n        }\n\n        const paymentPayload = this.isPayPalVaultedInstrumentPaymentData(paymentData)\n            ? this.prepareVaultedInstrumentPaymentPayload(methodId, this.orderId, paymentData)\n            : this.preparePaymentPayload(methodId, this.orderId, paymentData);\n\n        try {\n            await this.paymentIntegrationService.submitOrder(order, options);\n            await this.paymentIntegrationService.submitPayment(paymentPayload);\n        } catch (error: unknown) {\n            if (isRedirectActionError(error)) {\n                const redirectUrl = error.body.additional_action_required?.data?.redirect_url;\n\n                return new Promise(() => window.location.replace(redirectUrl));\n            }\n\n            if (this.isProviderError(error)) {\n                await this.paypalCommerceIntegrationService.loadPayPalSdk(payment.methodId);\n\n                await new Promise((_resolve, reject) => {\n                    if (this.paypalcommerce) {\n                        this.paypalButton?.close();\n                        this.renderButton(payment.methodId, this.paypalcommerce);\n                        this.handleError(new Error('INSTRUMENT_DECLINED'), onError);\n                    }\n\n                    reject();\n                });\n            }\n\n            this.handleError(error, onError);\n\n            return Promise.reject();\n        }\n    }\n\n    finalize(): Promise<void> {\n        return Promise.reject(new OrderFinalizationNotRequiredError());\n    }\n\n    deinitialize(): Promise<void> {\n        this.orderId = undefined;\n\n        this.paypalButton?.close();\n\n        return Promise.resolve();\n    }\n\n    private prepareVaultedInstrumentPaymentPayload(\n        methodId: string,\n        paypalOrderId: string,\n        paymentData: VaultedInstrument & HostedInstrument,\n    ): Payment {\n        const { instrumentId, shouldSetAsDefaultInstrument } = paymentData;\n\n        const shouldConfirmInstrument = !this.isTrustedVaultingFlow(paymentData);\n\n        if (shouldConfirmInstrument) {\n            return {\n                methodId,\n                paymentData: {\n                    shouldSaveInstrument: shouldConfirmInstrument,\n                    shouldSetAsDefaultInstrument,\n                    formattedPayload: {\n                        paypal_account: {\n                            order_id: paypalOrderId,\n                        },\n                    },\n                },\n            };\n        }\n\n        return {\n            methodId,\n            paymentData: {\n                instrumentId,\n                shouldSetAsDefaultInstrument,\n                formattedPayload: {\n                    paypal_account: {\n                        order_id: paypalOrderId,\n                    },\n                    bigpay_token: {\n                        token: instrumentId,\n                    },\n                },\n            },\n        };\n    }\n\n    private preparePaymentPayload(\n        methodId: string,\n        paypalOrderId: string,\n        paymentData: OrderPaymentRequestBody['paymentData'],\n    ): Payment {\n        const { shouldSaveInstrument = false, shouldSetAsDefaultInstrument = false } =\n            isHostedInstrumentLike(paymentData) ? paymentData : {};\n\n        return {\n            methodId,\n            paymentData: {\n                shouldSaveInstrument,\n                shouldSetAsDefaultInstrument,\n                formattedPayload: {\n                    paypal_account: {\n                        order_id: paypalOrderId,\n                    },\n                },\n            },\n        };\n    }\n\n    /**\n     *\n     * Button methods/callbacks\n     *\n     * */\n    private renderButton(\n        methodId: string,\n        paypalcommerce: PayPalCommercePaymentInitializeOptions,\n    ): void {\n        const paypalSdk = this.paypalCommerceIntegrationService.getPayPalSdkOrThrow();\n\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod =\n            state.getPaymentMethodOrThrow<PayPalCommerceInitializationData>(methodId);\n        const { paymentButtonStyles } = paymentMethod.initializationData || {};\n        const { checkoutPaymentButtonStyles } = paymentButtonStyles || {};\n        const { container, onError, onRenderButton, onValidate, submitForm } = paypalcommerce;\n\n        if (!container) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"container\" argument is not provided.',\n            );\n        }\n\n        const buttonOptions: PayPalCommerceButtonsOptions = {\n            ...(this.isPaypalCommerceAppSwitchEnabled(methodId) && {\n                appSwitchWhenAvailable: true,\n            }),\n            fundingSource: paypalSdk.FUNDING.PAYPAL,\n            style: this.paypalCommerceIntegrationService.getValidButtonStyle(\n                checkoutPaymentButtonStyles,\n            ),\n            createOrder: () => this.createOrder(),\n            onClick: (_, actions) => this.handleClick(actions, onValidate),\n            onApprove: (data) => this.handleApprove(data, submitForm),\n            onError: (error) => this.handleError(error, onError),\n            onCancel: () => this.toggleLoadingIndicator(false),\n        };\n\n        this.paypalButton = paypalSdk.Buttons(buttonOptions);\n\n        if (!this.paypalButton.isEligible()) {\n            return;\n        }\n\n        if (onRenderButton && typeof onRenderButton === 'function') {\n            onRenderButton();\n        }\n\n        if (this.paypalButton.hasReturned?.() && this.isPaypalCommerceAppSwitchEnabled(methodId)) {\n            this.paypalButton.resume?.();\n        } else {\n            this.paypalButton.render(container);\n        }\n    }\n\n    private async handleClick(\n        actions: ClickCallbackActions,\n        onValidate: PayPalCommercePaymentInitializeOptions['onValidate'],\n    ): Promise<void> {\n        const { resolve, reject } = actions;\n\n        const onValidationPassed = () => {\n            this.toggleLoadingIndicator(true);\n\n            return resolve();\n        };\n\n        return onValidate?.(onValidationPassed, reject);\n    }\n\n    private handleApprove(\n        { orderID }: ApproveCallbackPayload,\n        submitForm: PayPalCommercePaymentInitializeOptions['submitForm'],\n    ): void {\n        this.orderId = orderID;\n\n        submitForm?.();\n    }\n\n    private handleError(\n        error: unknown,\n        onError: PayPalCommercePaymentInitializeOptions['onError'],\n    ): void {\n        this.toggleLoadingIndicator(false);\n\n        if (onError && typeof onError === 'function') {\n            onError(error);\n        }\n    }\n\n    private async createOrder(): Promise<string> {\n        const fieldsValues = this.getFieldsValues();\n\n        return this.paypalCommerceIntegrationService.createOrder('paypalcommercecheckout', {\n            shouldSaveInstrument: fieldsValues?.shouldSaveInstrument || false,\n        });\n    }\n\n    /**\n     *\n     * Vaulting flow methods\n     *\n     * */\n    private getFieldsValues(): HostedInstrument | undefined {\n        const { getFieldsValues } = this.paypalcommerce || {};\n\n        return typeof getFieldsValues === 'function' ? getFieldsValues() : undefined;\n    }\n\n    private isTrustedVaultingFlow(paymentData?: PaymentInstrumentPayload): boolean {\n        if (paymentData && isVaultedInstrument(paymentData)) {\n            const state = this.paymentIntegrationService.getState();\n\n            const instruments = state.getInstruments();\n            const findInstrument = instruments?.find(\n                (instrument) =>\n                    isBaseInstrument(instrument) &&\n                    instrument.bigpayToken === paymentData.instrumentId,\n            );\n            const trustedShippingAddress = isBaseInstrument(findInstrument)\n                ? findInstrument.trustedShippingAddress\n                : {};\n\n            return !!trustedShippingAddress;\n        }\n\n        return false;\n    }\n\n    /**\n     *\n     * Loading Indicator methods\n     *\n     * */\n    private toggleLoadingIndicator(isLoading: boolean): void {\n        if (isLoading && this.loadingIndicatorContainer) {\n            this.loadingIndicator.show(this.loadingIndicatorContainer);\n        } else {\n            this.loadingIndicator.hide();\n        }\n    }\n\n    /**\n     *\n     * Guards\n     *\n     */\n    private isPayPalVaultedInstrumentPaymentData(\n        paymentData?: PaymentInstrumentPayload,\n    ): paymentData is VaultedInstrument & HostedInstrument {\n        return (\n            !!paymentData && isVaultedInstrument(paymentData) && isHostedInstrumentLike(paymentData)\n        );\n    }\n\n    /**\n     *\n     * Render Pay Later Messages\n     *\n     * */\n    private renderMessages(\n        paypalMessages: PayPalMessagesSdk,\n        bannerContainerId: string,\n        bannerConfiguration: PayPalBNPLConfigurationItem,\n    ): void {\n        const checkout = this.paymentIntegrationService.getState().getCheckoutOrThrow();\n\n        const paypalMessagesOptions: MessagingOptions = {\n            amount: checkout.outstandingBalance,\n            placement: 'payment',\n            style: getPaypalMessagesStylesFromBNPLConfig(bannerConfiguration),\n        };\n\n        paypalMessages.Messages(paypalMessagesOptions).render(`#${bannerContainerId}`);\n    }\n\n    /**\n     *\n     * Error handling\n     *\n     */\n    private isProviderError(error: unknown): boolean {\n        if (isPaypalCommerceProviderError(error)) {\n            const paypalProviderError = error?.errors?.filter((e) => e.provider_error) || [];\n\n            return paypalProviderError[0]?.provider_error?.code === 'INSTRUMENT_DECLINED';\n        }\n\n        return false;\n    }\n\n    /**\n     *\n     * PayPal AppSwitch enabling handling\n     *\n     */\n    private isPaypalCommerceAppSwitchEnabled(methodId: string): boolean {\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod =\n            state.getPaymentMethodOrThrow<PayPalCommerceInitializationData>(methodId);\n\n        return paymentMethod.initializationData?.isAppSwitchEnabled || false;\n    }\n}\n","import { isRequestError } from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport { ProviderError } from './is-paypal-commerce-provider-error';\n\nexport interface RedirectActionError extends ProviderError {\n    body: {\n        additional_action_required: {\n            type: 'offsite_redirect';\n            data: {\n                redirect_url: string;\n            };\n        };\n    };\n}\n\nexport default function isRedirectActionError(error: unknown): error is RedirectActionError {\n    return (\n        isRequestError(error) && error.body.additional_action_required?.type === 'offsite_redirect'\n    );\n}\n","export interface ProviderError extends Error {\n    errors?: ErrorElement[];\n    status?: string;\n    three_ds_result?: {\n        acs_url: unknown;\n        payer_auth_request: unknown;\n        merchant_data: unknown;\n        callback_url: unknown;\n    };\n}\n\nexport interface ErrorElement {\n    code: string;\n    message: string;\n    provider_error?: {\n        code: string;\n    };\n}\n\nexport default function isPaypalCommerceProviderError(error: unknown): error is ProviderError {\n    return typeof error === 'object' && error !== null && 'errors' in error;\n}\n","import { getScriptLoader } from '@bigcommerce/script-loader';\n\nimport {\n    PaymentStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\nimport { PayPalCommerceSdk } from '@bigcommerce/checkout-sdk/paypal-commerce-utils';\nimport { LoadingIndicator } from '@bigcommerce/checkout-sdk/ui';\n\nimport createPayPalCommerceIntegrationService from '../create-paypal-commerce-integration-service';\nimport { LOADING_INDICATOR_STYLES } from '../paypal-commerce-constants';\n\nimport PayPalCommercePaymentStrategy from './paypal-commerce-payment-strategy';\n\nconst createPayPalCommercePaymentStrategy: PaymentStrategyFactory<PayPalCommercePaymentStrategy> = (\n    paymentIntegrationService,\n) =>\n    new PayPalCommercePaymentStrategy(\n        paymentIntegrationService,\n        createPayPalCommerceIntegrationService(paymentIntegrationService),\n        new PayPalCommerceSdk(getScriptLoader()),\n        new LoadingIndicator({\n            containerStyles: LOADING_INDICATOR_STYLES,\n        }),\n    );\n\nexport default toResolvableModule(createPayPalCommercePaymentStrategy, [{ id: 'paypalcommerce' }]);\n","import { createScriptLoader } from '@bigcommerce/script-loader';\n\nimport PayPalCommerceSdk from './paypal-commerce-sdk';\n\nexport default function createPayPalCommerceSdk(): PayPalCommerceSdk {\n    return new PayPalCommerceSdk(createScriptLoader());\n}\n","import StandardError from './standard-error';\n\n/**\n * Throw this error if we try to call a method that is only a stub and has not\n * been fully implemented.\n */\nexport default class NotImplementedError extends StandardError {\n    constructor(message?: string) {\n        super(message || 'Not implemented.');\n\n        this.name = 'NotImplementedError';\n        this.type = 'not_implemented';\n    }\n}\n","import {\n    InvalidArgumentError,\n    NotImplementedError,\n    OrderFinalizationNotRequiredError,\n    OrderRequestBody,\n    PaymentArgumentInvalidError,\n    PaymentInitializeOptions,\n    PaymentIntegrationService,\n    PaymentMethodInvalidError,\n    PaymentRequestOptions,\n    PaymentStrategy,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\nimport {\n    getPaypalMessagesStylesFromBNPLConfig,\n    MessagingOptions,\n    PayPalBNPLConfigurationItem,\n    PayPalCommerceInitializationData,\n    PayPalCommerceSdk,\n    PayPalMessagesSdk,\n} from '@bigcommerce/checkout-sdk/paypal-commerce-utils';\nimport { LoadingIndicator } from '@bigcommerce/checkout-sdk/ui';\n\nimport PayPalCommerceIntegrationService from '../paypal-commerce-integration-service';\nimport {\n    ApproveCallbackPayload,\n    ClickCallbackActions,\n    PayPalCommerceButtons,\n    PayPalCommerceButtonsOptions,\n} from '../paypal-commerce-types';\n\nimport PayPalCommerceCreditPaymentInitializeOptions, {\n    WithPayPalCommerceCreditPaymentInitializeOptions,\n} from './paypal-commerce-credit-payment-initialize-options';\n\nexport default class PayPalCommerceCreditPaymentStrategy implements PaymentStrategy {\n    private loadingIndicatorContainer?: string;\n    private orderId?: string;\n    private paypalButton?: PayPalCommerceButtons;\n\n    constructor(\n        private paymentIntegrationService: PaymentIntegrationService,\n        private paypalCommerceIntegrationService: PayPalCommerceIntegrationService,\n        private loadingIndicator: LoadingIndicator,\n        private paypalCommerceSdk: PayPalCommerceSdk,\n    ) {}\n\n    async initialize(\n        options?: PaymentInitializeOptions & WithPayPalCommerceCreditPaymentInitializeOptions,\n    ): Promise<void> {\n        const { methodId, paypalcommerce, paypalcommercecredit } = options || {};\n\n        const paypalOptions = paypalcommercecredit || paypalcommerce;\n\n        if (!methodId) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.methodId\" argument is not provided.',\n            );\n        }\n\n        if (!paypalOptions) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.paypalcommerce\" argument is not provided.`,\n            );\n        }\n\n        await this.paymentIntegrationService.loadPaymentMethod(methodId);\n\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod =\n            state.getPaymentMethodOrThrow<PayPalCommerceInitializationData>(methodId);\n\n        const { paypalBNPLConfiguration = [], orderId } = paymentMethod.initializationData || {};\n        const { bannerContainerId, container } = paypalOptions;\n\n        if (bannerContainerId !== undefined) {\n            if (!document.getElementById(bannerContainerId)) {\n                // eslint-disable-next-line no-console\n                console.error('Unable to create banner without valid banner container ID.');\n\n                return;\n            }\n\n            const bannerConfiguration =\n                paypalBNPLConfiguration &&\n                paypalBNPLConfiguration.find(({ id }) => id === 'checkout');\n\n            if (!bannerConfiguration?.status) {\n                return;\n            }\n\n            const paypalMessages = await this.paypalCommerceSdk.getPayPalMessages(\n                paymentMethod,\n                state.getCartOrThrow().currency.code,\n            );\n\n            return this.renderMessages(paypalMessages, bannerContainerId, bannerConfiguration);\n        }\n\n        // Info:\n        // The PayPal button and fields should not be rendered when shopper was redirected to Checkout page\n        // after using smart payment button on PDP or Cart page. In this case backend returns order id if\n        // it is available in checkout session. Therefore, it is not necessary to render PayPal button.\n        if (orderId) {\n            this.orderId = orderId;\n\n            return;\n        }\n\n        await this.paypalCommerceIntegrationService.loadPayPalSdk(methodId);\n\n        this.loadingIndicatorContainer = container?.split('#')[1];\n\n        this.renderButton(methodId, paypalOptions);\n    }\n\n    async execute(payload: OrderRequestBody, options?: PaymentRequestOptions): Promise<void> {\n        const { payment, ...order } = payload;\n\n        if (!payment) {\n            throw new PaymentArgumentInvalidError(['payment']);\n        }\n\n        if (!this.orderId) {\n            throw new PaymentMethodInvalidError();\n        }\n\n        await this.paymentIntegrationService.submitOrder(order, options);\n        await this.paypalCommerceIntegrationService.submitPayment(payment.methodId, this.orderId);\n    }\n\n    finalize(): Promise<void> {\n        return Promise.reject(new OrderFinalizationNotRequiredError());\n    }\n\n    deinitialize(): Promise<void> {\n        this.orderId = undefined;\n\n        this.paypalButton?.close();\n\n        return Promise.resolve();\n    }\n\n    /**\n     *\n     * Button methods/callbacks\n     *\n     * */\n    private renderButton(\n        methodId: string,\n        paypalOptions: PayPalCommerceCreditPaymentInitializeOptions,\n    ): void {\n        if (!paypalOptions?.container) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"container\" argument is not provided.',\n            );\n        }\n\n        const paypalSdk = this.paypalCommerceIntegrationService.getPayPalSdkOrThrow();\n\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod =\n            state.getPaymentMethodOrThrow<PayPalCommerceInitializationData>(methodId);\n        const { paymentButtonStyles } = paymentMethod.initializationData || {};\n        const { checkoutPaymentButtonStyles } = paymentButtonStyles || {};\n\n        const { container, onError, onRenderButton, onValidate, submitForm } = paypalOptions;\n\n        const fundingSources = [paypalSdk.FUNDING.PAYLATER, paypalSdk.FUNDING.CREDIT];\n        let hasRenderedSmartButton = false;\n\n        fundingSources.forEach((fundingSource) => {\n            if (hasRenderedSmartButton) {\n                return;\n            }\n\n            const buttonOptions: PayPalCommerceButtonsOptions = {\n                fundingSource,\n                style: this.paypalCommerceIntegrationService.getValidButtonStyle(\n                    checkoutPaymentButtonStyles,\n                ),\n                createOrder: () =>\n                    this.paypalCommerceIntegrationService.createOrder(\n                        'paypalcommercecreditcheckout',\n                    ),\n                onClick: (_, actions) => this.handleClick(actions, onValidate),\n                onApprove: (data) => this.handleApprove(data, submitForm),\n                onCancel: () => this.toggleLoadingIndicator(false),\n                onError: (error) => this.handleError(error, onError),\n            };\n\n            this.paypalButton = paypalSdk.Buttons(buttonOptions);\n\n            if (!this.paypalButton.isEligible() && fundingSource === paypalSdk.FUNDING.PAYLATER) {\n                return;\n            }\n\n            if (!this.paypalButton.isEligible() && fundingSource === paypalSdk.FUNDING.CREDIT) {\n                throw new NotImplementedError(\n                    `PayPal ${fundingSource} is not available for your region. Please use PayPal Checkout instead.`,\n                );\n            }\n\n            if (onRenderButton && typeof onRenderButton === 'function') {\n                onRenderButton();\n            }\n\n            this.paypalButton.render(container);\n            hasRenderedSmartButton = true;\n        });\n    }\n\n    private async handleClick(\n        actions: ClickCallbackActions,\n        onValidate: PayPalCommerceCreditPaymentInitializeOptions['onValidate'],\n    ): Promise<void> {\n        const { resolve, reject } = actions;\n\n        const onValidationPassed = () => {\n            this.toggleLoadingIndicator(true);\n\n            return resolve();\n        };\n\n        if (onValidate && typeof onValidate === 'function') {\n            return onValidate(onValidationPassed, reject);\n        }\n    }\n\n    private handleApprove(\n        { orderID }: ApproveCallbackPayload,\n        submitForm: PayPalCommerceCreditPaymentInitializeOptions['submitForm'],\n    ): void {\n        this.orderId = orderID;\n\n        if (submitForm && typeof submitForm === 'function') {\n            submitForm();\n        }\n    }\n\n    private handleError(\n        error: Error,\n        onError: PayPalCommerceCreditPaymentInitializeOptions['onError'],\n    ): void {\n        this.toggleLoadingIndicator(false);\n\n        if (onError && typeof onError === 'function') {\n            onError(error);\n        }\n    }\n\n    /**\n     *\n     * Loading Indicator methods\n     *\n     * */\n    private toggleLoadingIndicator(isLoading: boolean): void {\n        if (isLoading && this.loadingIndicatorContainer) {\n            this.loadingIndicator.show(this.loadingIndicatorContainer);\n        } else {\n            this.loadingIndicator.hide();\n        }\n    }\n\n    /**\n     *\n     * Render Pay Later Messages\n     *\n     * */\n    private renderMessages(\n        paypalMessages: PayPalMessagesSdk,\n        bannerContainerId: string,\n        bannerConfiguration: PayPalBNPLConfigurationItem,\n    ): void {\n        const checkout = this.paymentIntegrationService.getState().getCheckoutOrThrow();\n\n        const paypalMessagesOptions: MessagingOptions = {\n            amount: checkout.outstandingBalance,\n            placement: 'payment',\n            style: getPaypalMessagesStylesFromBNPLConfig(bannerConfiguration),\n        };\n\n        paypalMessages.Messages(paypalMessagesOptions).render(`#${bannerContainerId}`);\n    }\n}\n","import {\n    PaymentStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\nimport { createPayPalCommerceSdk } from '@bigcommerce/checkout-sdk/paypal-commerce-utils';\nimport { LoadingIndicator } from '@bigcommerce/checkout-sdk/ui';\n\nimport createPayPalCommerceIntegrationService from '../create-paypal-commerce-integration-service';\nimport { LOADING_INDICATOR_STYLES } from '../paypal-commerce-constants';\n\nimport PayPalCommerceCreditPaymentStrategy from './paypal-commerce-credit-payment-strategy';\n\nconst createPayPalCommerceCreditPaymentStrategy: PaymentStrategyFactory<\n    PayPalCommerceCreditPaymentStrategy\n> = (paymentIntegrationService) =>\n    new PayPalCommerceCreditPaymentStrategy(\n        paymentIntegrationService,\n        createPayPalCommerceIntegrationService(paymentIntegrationService),\n        new LoadingIndicator({\n            containerStyles: LOADING_INDICATOR_STYLES,\n        }),\n        createPayPalCommerceSdk(),\n    );\n\nexport default toResolvableModule(createPayPalCommerceCreditPaymentStrategy, [\n    { id: 'paypalcommercecredit' },\n]);\n","import {\n    InvalidArgumentError,\n    NotImplementedError,\n    OrderFinalizationNotRequiredError,\n    OrderRequestBody,\n    PaymentArgumentInvalidError,\n    PaymentInitializeOptions,\n    PaymentIntegrationService,\n    PaymentMethodInvalidError,\n    PaymentRequestOptions,\n    PaymentStrategy,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\nimport { LoadingIndicator } from '@bigcommerce/checkout-sdk/ui';\n\nimport PayPalCommerceIntegrationService from '../paypal-commerce-integration-service';\nimport {\n    ApproveCallbackPayload,\n    ClickCallbackActions,\n    PayPalCommerceButtons,\n    PayPalCommerceButtonsOptions,\n    PayPalCommerceInitializationData,\n} from '../paypal-commerce-types';\n\nimport PayPalCommerceVenmoPaymentInitializeOptions, {\n    WithPayPalCommerceVenmoPaymentInitializeOptions,\n} from './paypal-commerce-venmo-payment-initialize-options';\n\nexport default class PayPalCommerceVenmoPaymentStrategy implements PaymentStrategy {\n    private loadingIndicatorContainer?: string;\n    private orderId?: string;\n    private paypalButton?: PayPalCommerceButtons;\n\n    constructor(\n        private paymentIntegrationService: PaymentIntegrationService,\n        private paypalCommerceIntegrationService: PayPalCommerceIntegrationService,\n        private loadingIndicator: LoadingIndicator,\n    ) {}\n\n    async initialize(\n        options?: PaymentInitializeOptions & WithPayPalCommerceVenmoPaymentInitializeOptions,\n    ): Promise<void> {\n        const { methodId, paypalcommerce, paypalcommercevenmo } = options || {};\n\n        const paypalOptions = paypalcommercevenmo || paypalcommerce;\n\n        if (!methodId) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.methodId\" argument is not provided.',\n            );\n        }\n\n        if (!paypalOptions) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.paypalcommercevenmo\" argument is not provided.`,\n            );\n        }\n\n        await this.paymentIntegrationService.loadPaymentMethod(methodId);\n\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod =\n            state.getPaymentMethodOrThrow<PayPalCommerceInitializationData>(methodId);\n\n        // Info:\n        // The PayPal button and fields should not be rendered when shopper was redirected to Checkout page\n        // after using smart payment button on PDP or Cart page. In this case backend returns order id if\n        // it is available in checkout session. Therefore, it is not necessary to render PayPal button.\n        if (paymentMethod.initializationData?.orderId) {\n            this.orderId = paymentMethod.initializationData?.orderId;\n\n            return;\n        }\n\n        await this.paypalCommerceIntegrationService.loadPayPalSdk(methodId);\n\n        this.loadingIndicatorContainer = paypalOptions.container.split('#')[1];\n\n        this.renderButton(methodId, paypalOptions);\n    }\n\n    async execute(payload: OrderRequestBody, options?: PaymentRequestOptions): Promise<void> {\n        const { payment, ...order } = payload;\n\n        if (!payment) {\n            throw new PaymentArgumentInvalidError(['payment']);\n        }\n\n        if (!this.orderId) {\n            throw new PaymentMethodInvalidError();\n        }\n\n        await this.paymentIntegrationService.submitOrder(order, options);\n        await this.paypalCommerceIntegrationService.submitPayment(payment.methodId, this.orderId);\n    }\n\n    finalize(): Promise<void> {\n        return Promise.reject(new OrderFinalizationNotRequiredError());\n    }\n\n    deinitialize(): Promise<void> {\n        this.orderId = undefined;\n\n        this.paypalButton?.close();\n\n        return Promise.resolve();\n    }\n\n    /**\n     *\n     * Button methods/callbacks\n     *\n     * */\n    private renderButton(\n        methodId: string,\n        paypalcommercevenmo: PayPalCommerceVenmoPaymentInitializeOptions,\n    ): void {\n        const paypalSdk = this.paypalCommerceIntegrationService.getPayPalSdkOrThrow();\n\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod =\n            state.getPaymentMethodOrThrow<PayPalCommerceInitializationData>(methodId);\n        const { paymentButtonStyles } = paymentMethod.initializationData || {};\n        const { checkoutPaymentButtonStyles } = paymentButtonStyles || {};\n\n        const { container, onError, onRenderButton, onValidate, submitForm } = paypalcommercevenmo;\n\n        const buttonOptions: PayPalCommerceButtonsOptions = {\n            fundingSource: paypalSdk.FUNDING.VENMO,\n            style: this.paypalCommerceIntegrationService.getValidButtonStyle(\n                checkoutPaymentButtonStyles,\n            ),\n            createOrder: () =>\n                this.paypalCommerceIntegrationService.createOrder('paypalcommercevenmocheckout'),\n            onClick: (_, actions) => this.handleClick(actions, onValidate),\n            onApprove: (data) => this.handleApprove(data, submitForm),\n            onCancel: () => this.toggleLoadingIndicator(false),\n            onError: (error) => this.handleError(error, onError),\n        };\n\n        this.paypalButton = paypalSdk.Buttons(buttonOptions);\n\n        if (!this.paypalButton.isEligible()) {\n            throw new NotImplementedError(\n                `PayPal Venmo is not available for your region. Please use PayPal Checkout instead.`,\n            );\n        }\n\n        if (onRenderButton && typeof onRenderButton === 'function') {\n            onRenderButton();\n        }\n\n        this.paypalButton.render(container);\n    }\n\n    private async handleClick(\n        actions: ClickCallbackActions,\n        onValidate: PayPalCommerceVenmoPaymentInitializeOptions['onValidate'],\n    ): Promise<void> {\n        const { resolve, reject } = actions;\n\n        const onValidationPassed = () => {\n            this.toggleLoadingIndicator(true);\n\n            return resolve();\n        };\n\n        return onValidate(onValidationPassed, reject);\n    }\n\n    private handleApprove(\n        { orderID }: ApproveCallbackPayload,\n        submitForm: PayPalCommerceVenmoPaymentInitializeOptions['submitForm'],\n    ): void {\n        this.orderId = orderID;\n\n        submitForm();\n        this.toggleLoadingIndicator(false);\n    }\n\n    private handleError(\n        error: Error,\n        onError: PayPalCommerceVenmoPaymentInitializeOptions['onError'],\n    ): void {\n        this.toggleLoadingIndicator(false);\n\n        if (onError && typeof onError === 'function') {\n            onError(error);\n        }\n    }\n\n    /**\n     *\n     * Loading Indicator methods\n     *\n     * */\n    private toggleLoadingIndicator(isLoading: boolean): void {\n        if (isLoading && this.loadingIndicatorContainer) {\n            this.loadingIndicator.show(this.loadingIndicatorContainer);\n        } else {\n            this.loadingIndicator.hide();\n        }\n    }\n}\n","import {\n    PaymentStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\nimport { LoadingIndicator } from '@bigcommerce/checkout-sdk/ui';\n\nimport createPayPalCommerceIntegrationService from '../create-paypal-commerce-integration-service';\n\nimport PayPalCommerceVenmoPaymentStrategy from './paypal-commerce-venmo-payment-strategy';\n\nconst createPayPalCommerceVenmoPaymentStrategy: PaymentStrategyFactory<\n    PayPalCommerceVenmoPaymentStrategy\n> = (paymentIntegrationService) =>\n    new PayPalCommerceVenmoPaymentStrategy(\n        paymentIntegrationService,\n        createPayPalCommerceIntegrationService(paymentIntegrationService),\n        new LoadingIndicator({ styles: { backgroundColor: 'black' } }),\n    );\n\nexport default toResolvableModule(createPayPalCommerceVenmoPaymentStrategy, [\n    { id: 'paypalcommercevenmo' },\n]);\n","import { ScriptLoader } from '@bigcommerce/script-loader';\n\nimport {\n    MissingDataError,\n    MissingDataErrorType,\n    PaymentMethod,\n    PaymentMethodClientUnavailableError,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport {\n    FundingType,\n    PayPalFastlaneSdk,\n    PayPalGooglePaySdk,\n    PayPalHostWindow,\n    PayPalInitializationData,\n    PayPalMessagesSdk,\n    PayPalSDK,\n    PayPalSdkComponents,\n    PayPalSdkConfig,\n} from './paypal-types';\n\nexport default class PayPalSdkScriptLoader {\n    private window: PayPalHostWindow;\n\n    constructor(private scriptLoader: ScriptLoader) {\n        this.window = window;\n    }\n\n    async getPayPalSDK(\n        paymentMethod: PaymentMethod<PayPalInitializationData>,\n        currencyCode: string,\n        initializesOnCheckoutPage?: boolean,\n        forceLoad?: boolean,\n    ): Promise<PayPalSDK> {\n        if (!this.window.paypal || forceLoad) {\n            const paypalSdkScriptConfig = this.getPayPalSdkScriptConfigOrThrow(\n                paymentMethod,\n                currencyCode,\n                initializesOnCheckoutPage,\n            );\n\n            await this.loadPayPalSdk(paypalSdkScriptConfig);\n\n            if (!this.window.paypal) {\n                throw new PaymentMethodClientUnavailableError();\n            }\n        }\n\n        return this.window.paypal;\n    }\n\n    async getPayPalFastlaneSdk(\n        paymentMethod: PaymentMethod<PayPalInitializationData>,\n        currencyCode: string,\n        sessionId: string,\n    ): Promise<PayPalFastlaneSdk> {\n        if (!this.window.paypalFastlaneSdk) {\n            const config = this.getPayPalFastlaneSdkConfiguration(\n                paymentMethod,\n                currencyCode,\n                sessionId,\n            );\n\n            await this.loadPayPalSdk(config);\n\n            if (!this.window.paypalFastlaneSdk) {\n                throw new PaymentMethodClientUnavailableError();\n            }\n        }\n\n        return this.window.paypalFastlaneSdk;\n    }\n\n    async getPayPalGooglePaySdk(\n        paymentMethod: PaymentMethod<PayPalInitializationData>,\n        currencyCode: string,\n        initializesOnCheckoutPage?: boolean,\n        forceLoad?: boolean,\n    ): Promise<PayPalGooglePaySdk> {\n        if (!this.window.paypalGooglePay || forceLoad) {\n            const paypalSdkScriptConfig = this.getPayPalGooglePaySdkScriptConfigOrThrow(\n                paymentMethod,\n                currencyCode,\n                initializesOnCheckoutPage,\n            );\n\n            await this.loadPayPalSdk(paypalSdkScriptConfig);\n        }\n\n        if (!this.window.paypalGooglePay) {\n            throw new PaymentMethodClientUnavailableError();\n        }\n\n        return this.window.paypalGooglePay;\n    }\n\n    async getPayPalApmsSdk(\n        paymentMethod: PaymentMethod<PayPalInitializationData>,\n        currencyCode: string,\n    ) {\n        if (!this.window.paypalApms) {\n            const config = this.getPayPalApmSdkConfiguration(paymentMethod, currencyCode);\n\n            await this.loadPayPalSdk(config);\n\n            if (!this.window.paypalApms) {\n                throw new PaymentMethodClientUnavailableError();\n            }\n        }\n\n        return this.window.paypalApms;\n    }\n\n    async getPayPalMessages(\n        paymentMethod: PaymentMethod<PayPalInitializationData>,\n        currencyCode: string,\n    ): Promise<PayPalMessagesSdk> {\n        if (!this.window.paypalMessages) {\n            const paypalSdkMessagesConfig = this.getPayPalSdkMessagesConfiguration(\n                paymentMethod,\n                currencyCode,\n            );\n\n            await this.loadPayPalSdk(paypalSdkMessagesConfig);\n        }\n\n        if (!this.window.paypalMessages) {\n            throw new PaymentMethodClientUnavailableError();\n        }\n\n        return this.window.paypalMessages;\n    }\n\n    /**\n     *\n     *  loadPayPalSdk is a paypal sdk script loader\n     *  which loads paypal sdk based on provided configuration\n     *\n     */\n    private async loadPayPalSdk({ options, attributes }: PayPalSdkConfig): Promise<void> {\n        const scriptOptions = this.transformConfig<PayPalSdkConfig['options']>(options);\n        const scriptAttributes = this.transformConfig<PayPalSdkConfig['attributes']>(attributes);\n\n        const paypalSdkUrl = 'https://www.paypal.com/sdk/js';\n        const scriptQuery = new URLSearchParams(scriptOptions).toString();\n        const scriptSrc = `${paypalSdkUrl}?${scriptQuery}`;\n\n        await this.scriptLoader.loadScript(scriptSrc, {\n            async: true,\n            attributes: scriptAttributes,\n        });\n    }\n\n    /**\n     *\n     * Configurations section\n     *\n     */\n    private getPayPalSdkScriptConfigOrThrow(\n        paymentMethod: PaymentMethod<PayPalInitializationData>,\n        currencyCode: string,\n        initializesOnCheckoutPage = true,\n    ): PayPalSdkConfig {\n        const { id, clientToken, initializationData } = paymentMethod;\n\n        if (!initializationData || !initializationData.clientId) {\n            throw new MissingDataError(MissingDataErrorType.MissingPaymentMethod);\n        }\n\n        const {\n            intent,\n            clientId,\n            merchantId,\n            buyerCountry,\n            attributionId,\n            isVenmoEnabled,\n            isHostedCheckoutEnabled,\n            isPayPalCreditAvailable,\n            isDeveloperModeApplicable,\n            availableAlternativePaymentMethods = [],\n            enabledAlternativePaymentMethods = [],\n            isGooglePayEnabled,\n        } = initializationData;\n\n        const commit = isHostedCheckoutEnabled || initializesOnCheckoutPage;\n\n        const shouldEnableCard =\n            id === 'paypalcommercecreditcards' || id === 'bigcommerce_payments_creditcards';\n        const enableCardFunding = shouldEnableCard ? ['card'] : [];\n        const disableCardFunding = !shouldEnableCard ? ['card'] : [];\n\n        const enableCreditFunding = isPayPalCreditAvailable ? ['credit', 'paylater'] : [];\n        const disableCreditFunding = !isPayPalCreditAvailable ? ['credit', 'paylater'] : [];\n\n        const shouldEnableAPMs = initializesOnCheckoutPage || !commit;\n        const enableVenmoFunding = isVenmoEnabled ? ['venmo'] : [];\n        const disableVenmoFunding = !isVenmoEnabled ? ['venmo'] : [];\n        const enableAPMsFunding = shouldEnableAPMs ? enabledAlternativePaymentMethods : [];\n        const disableAPMsFunding = shouldEnableAPMs\n            ? availableAlternativePaymentMethods.filter(\n                  (apm: string) => !enabledAlternativePaymentMethods.includes(apm),\n              )\n            : availableAlternativePaymentMethods;\n        const googlePayComponent: PayPalSdkComponents = isGooglePayEnabled ? ['googlepay'] : [];\n        const cardFieldsComponent: PayPalSdkComponents = initializesOnCheckoutPage\n            ? ['card-fields']\n            : [];\n        const disableFunding: FundingType = [\n            ...disableCardFunding,\n            ...disableCreditFunding,\n            ...disableVenmoFunding,\n            ...disableAPMsFunding,\n        ];\n        const enableFunding: FundingType = [\n            ...enableCardFunding,\n            ...enableCreditFunding,\n            ...enableVenmoFunding,\n            ...enableAPMsFunding,\n        ];\n\n        return {\n            options: {\n                'client-id': clientId,\n                'merchant-id': merchantId,\n                'enable-funding': enableFunding.length > 0 ? enableFunding : undefined,\n                'disable-funding': disableFunding.length > 0 ? disableFunding : undefined,\n                commit,\n                components: [\n                    'buttons',\n                    'hosted-fields',\n                    'payment-fields',\n                    'legal',\n                    ...googlePayComponent,\n                    ...cardFieldsComponent,\n                ],\n                currency: currencyCode,\n                intent,\n                ...(isDeveloperModeApplicable && { 'buyer-country': buyerCountry }),\n            },\n            attributes: {\n                'data-partner-attribution-id': attributionId,\n                'data-client-token': clientToken,\n            },\n        };\n    }\n\n    private getPayPalFastlaneSdkConfiguration(\n        paymentMethod: PaymentMethod<PayPalInitializationData>,\n        currencyCode: string,\n        sessionId: string,\n    ): PayPalSdkConfig {\n        const { clientToken, initializationData } = paymentMethod;\n\n        if (!initializationData || !initializationData.clientId) {\n            throw new MissingDataError(MissingDataErrorType.MissingPaymentMethod);\n        }\n\n        const { intent, clientId, merchantId, attributionId } = initializationData;\n\n        return {\n            options: {\n                'client-id': clientId,\n                'merchant-id': merchantId,\n                commit: true,\n                components: [\n                    'fastlane',\n                    'buttons',\n                    'payment-fields',\n                    'hosted-fields',\n                    'three-domain-secure',\n                ],\n                currency: currencyCode,\n                intent,\n            },\n            attributes: {\n                'data-client-metadata-id': sessionId.replace(/-/g, ''),\n                'data-namespace': 'paypalFastlaneSdk',\n                'data-partner-attribution-id': attributionId,\n                'data-sdk-client-token': clientToken,\n            },\n        };\n    }\n\n    private getPayPalGooglePaySdkScriptConfigOrThrow(\n        paymentMethod: PaymentMethod<PayPalInitializationData>,\n        currencyCode: string,\n        initializesOnCheckoutPage = true,\n    ): PayPalSdkConfig {\n        const { clientToken, initializationData } = paymentMethod;\n\n        if (!initializationData || !initializationData.clientId) {\n            throw new MissingDataError(MissingDataErrorType.MissingPaymentMethod);\n        }\n\n        const {\n            intent,\n            clientId,\n            merchantId,\n            buyerCountry,\n            attributionId,\n            isHostedCheckoutEnabled,\n            isDeveloperModeApplicable,\n        } = initializationData;\n\n        const commit = isHostedCheckoutEnabled || initializesOnCheckoutPage;\n\n        return {\n            options: {\n                'client-id': clientId,\n                'merchant-id': merchantId,\n                commit,\n                components: ['googlepay'],\n                currency: currencyCode,\n                intent,\n                ...(isDeveloperModeApplicable && { 'buyer-country': buyerCountry }),\n            },\n            attributes: {\n                'data-partner-attribution-id': attributionId,\n                'data-client-token': clientToken,\n                'data-namespace': 'paypalGooglePay',\n            },\n        };\n    }\n\n    private getPayPalApmSdkConfiguration(\n        paymentMethod: PaymentMethod<PayPalInitializationData>,\n        currencyCode: string,\n    ): PayPalSdkConfig {\n        const { initializationData } = paymentMethod;\n\n        if (!initializationData || !initializationData.clientId) {\n            throw new MissingDataError(MissingDataErrorType.MissingPaymentMethod);\n        }\n\n        const {\n            intent,\n            clientId,\n            merchantId,\n            buyerCountry,\n            attributionId,\n            isDeveloperModeApplicable,\n            availableAlternativePaymentMethods = [],\n            enabledAlternativePaymentMethods = [],\n        } = initializationData;\n\n        const enableAPMsFunding = enabledAlternativePaymentMethods;\n        const disableAPMsFunding = availableAlternativePaymentMethods.filter(\n            (apm: string) => !enabledAlternativePaymentMethods.includes(apm),\n        );\n\n        return {\n            options: {\n                'client-id': clientId,\n                'merchant-id': merchantId,\n                'enable-funding': enableAPMsFunding.length > 0 ? enableAPMsFunding : undefined,\n                'disable-funding': disableAPMsFunding.length > 0 ? disableAPMsFunding : undefined,\n                commit: true,\n                components: ['buttons', 'payment-fields'],\n                currency: currencyCode,\n                intent,\n                ...(isDeveloperModeApplicable && { 'buyer-country': buyerCountry }),\n            },\n            attributes: {\n                'data-partner-attribution-id': attributionId,\n                'data-namespace': 'paypalApms',\n            },\n        };\n    }\n\n    private getPayPalSdkMessagesConfiguration(\n        paymentMethod: PaymentMethod<PayPalInitializationData>,\n        currencyCode: string,\n    ): PayPalSdkConfig {\n        const { initializationData } = paymentMethod;\n\n        if (!initializationData || !initializationData.clientId) {\n            throw new MissingDataError(MissingDataErrorType.MissingPaymentMethod);\n        }\n\n        const { clientId, merchantId, attributionId, isDeveloperModeApplicable, buyerCountry } =\n            initializationData;\n\n        return {\n            options: {\n                'client-id': clientId,\n                'merchant-id': merchantId,\n                components: ['messages'],\n                currency: currencyCode,\n                ...(isDeveloperModeApplicable && { 'buyer-country': buyerCountry }),\n            },\n            attributes: {\n                'data-namespace': 'paypalMessages',\n                'data-partner-attribution-id': attributionId,\n            },\n        };\n    }\n\n    /**\n     *\n     * Utils methods\n     *\n     */\n    private transformConfig<T extends Record<string, unknown>>(config: T): Record<string, string> {\n        let transformedConfig = {};\n\n        const keys = Object.keys(config) as Array<keyof T>;\n\n        keys.forEach((key) => {\n            const value = config[key];\n\n            if (\n                value === undefined ||\n                value === null ||\n                value === '' ||\n                (Array.isArray(value) && value.length === 0)\n            ) {\n                return;\n            }\n\n            transformedConfig = {\n                ...transformedConfig,\n                [key]: Array.isArray(value) ? value.join(',') : value,\n            };\n        });\n\n        return transformedConfig;\n    }\n}\n","import { createScriptLoader } from '@bigcommerce/script-loader';\n\nimport PayPalSdkScriptLoader from './paypal-sdk-script-loader';\n\nexport default function createPayPalSdkScriptLoader(): PayPalSdkScriptLoader {\n    return new PayPalSdkScriptLoader(createScriptLoader());\n}\n","import { Response } from '@bigcommerce/request-sender';\n\nimport RequestError from './request-error';\n\n/**\n * Throw this error if a request fails to complete within its required timeframe\n * because of a network issue.\n */\nexport default class TimeoutError<T = any> extends RequestError<T> {\n    constructor(response?: Response<T>) {\n        super(response, {\n            message: 'The request has timed out or aborted.',\n        });\n\n        this.name = 'TimeoutError';\n        this.type = 'timeout';\n    }\n}\n","export interface Features {\n    [featureName: string]: boolean | undefined;\n}\n\nexport default function isExperimentEnabled(\n    features: Features,\n    experimentName: string,\n    fallbackValue = true,\n): boolean {\n    return features[experimentName] ?? fallbackValue;\n}\n","import { noop } from 'lodash';\n\nimport {\n    InvalidArgumentError,\n    OrderFinalizationNotRequiredError,\n    OrderRequestBody,\n    PaymentArgumentInvalidError,\n    PaymentInitializeOptions,\n    PaymentIntegrationService,\n    PaymentMethodClientUnavailableError,\n    PaymentMethodInvalidError,\n    PaymentRequestOptions,\n    PaymentStrategy,\n    TimeoutError,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\nimport {\n    PayPalApmSdk,\n    PayPalInitializationData,\n    PayPalSdkScriptLoader,\n} from '@bigcommerce/checkout-sdk/paypal-utils';\nimport { LoadingIndicator } from '@bigcommerce/checkout-sdk/ui';\nimport { isExperimentEnabled } from '@bigcommerce/checkout-sdk/utility';\n\nimport PayPalCommerceIntegrationService from '../paypal-commerce-integration-service';\nimport {\n    ApproveCallbackPayload,\n    NonInstantAlternativePaymentMethods,\n    PayPalCommerceButtons,\n    PayPalCommerceButtonsOptions,\n    PayPalCommerceInitializationData,\n    PayPalOrderStatus,\n} from '../paypal-commerce-types';\n\nimport PayPalCommerceAlternativeMethodsPaymentOptions, {\n    WithPayPalCommerceAlternativeMethodsPaymentInitializeOptions,\n} from './paypal-commerce-alternative-methods-payment-initialize-options';\n\nconst POLLING_INTERVAL = 3000;\nconst MAX_POLLING_TIME = 300000;\n\nexport default class PayPalCommerceAlternativeMethodsPaymentStrategy implements PaymentStrategy {\n    private loadingIndicatorContainer?: string;\n    private orderId?: string;\n    private paypalButton?: PayPalCommerceButtons;\n    private paypalApms?: PayPalApmSdk;\n    private pollingTimer = 0;\n    private stopPolling = noop;\n    private isPollingEnabled = false;\n    private paypalcommercealternativemethods?: PayPalCommerceAlternativeMethodsPaymentOptions;\n\n    constructor(\n        private paymentIntegrationService: PaymentIntegrationService,\n        private paypalCommerceIntegrationService: PayPalCommerceIntegrationService,\n        private paypalSdkScriptLoader: PayPalSdkScriptLoader,\n        private loadingIndicator: LoadingIndicator,\n        private pollingInterval: number = POLLING_INTERVAL,\n        private maxPollingIntervalTime: number = MAX_POLLING_TIME,\n    ) {}\n\n    async initialize(\n        options: PaymentInitializeOptions &\n            WithPayPalCommerceAlternativeMethodsPaymentInitializeOptions,\n    ): Promise<void> {\n        const {\n            gatewayId,\n            methodId,\n            paypalcommerce, // FIXME: this option is deprecated\n            paypalcommercealternativemethods,\n        } = options;\n        const paypalOptions = paypalcommercealternativemethods || paypalcommerce;\n\n        this.paypalcommercealternativemethods = paypalcommercealternativemethods;\n\n        if (!methodId) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.methodId\" argument is not provided.',\n            );\n        }\n\n        if (!gatewayId) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.gatewayId\" argument is not provided.',\n            );\n        }\n\n        if (!paypalOptions) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.paypalcommercealternativemethods\" argument is not provided.`,\n            );\n        }\n\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod = state.getPaymentMethodOrThrow<PayPalInitializationData>(\n            methodId,\n            gatewayId,\n        );\n        const { orderId, shouldRenderFields } = paymentMethod.initializationData || {};\n        const features = state.getStoreConfigOrThrow().checkoutSettings.features;\n\n        this.isPollingEnabled = isExperimentEnabled(\n            features,\n            'PAYPAL-5192.paypal_commerce_ideal_polling',\n        );\n\n        // Info:\n        // The PayPal button and fields should not be rendered when shopper was redirected to Checkout page\n        // after using smart payment button on PDP or Cart page. In this case backend returns order id if\n        // it is available in checkout session. Therefore, it is not necessary to render PayPal button.\n        if (orderId) {\n            this.orderId = orderId;\n\n            return;\n        }\n\n        this.paypalApms = await this.paypalSdkScriptLoader.getPayPalApmsSdk(\n            paymentMethod,\n            state.getCartOrThrow().currency.code,\n        );\n\n        this.loadingIndicatorContainer = paypalOptions.container.split('#')[1];\n\n        this.renderButton(methodId, gatewayId, paypalOptions);\n\n        if (shouldRenderFields) {\n            this.renderFields(methodId, paypalOptions);\n        }\n    }\n\n    async execute(payload: OrderRequestBody, options?: PaymentRequestOptions): Promise<void> {\n        const { payment, ...order } = payload;\n\n        if (!payment) {\n            throw new PaymentArgumentInvalidError(['payment']);\n        }\n\n        const { methodId, gatewayId } = payment;\n\n        if (!this.orderId) {\n            throw new PaymentMethodInvalidError();\n        }\n\n        if (this.isPollingEnabled && methodId === 'ideal') {\n            await new Promise((resolve, reject) => {\n                void this.initializePollingMechanism(methodId, resolve, reject, gatewayId);\n            });\n        }\n\n        if (!this.isNonInstantPaymentMethod(methodId)) {\n            await this.paymentIntegrationService.submitOrder(order, options);\n        }\n\n        await this.paypalCommerceIntegrationService.submitPayment(\n            methodId,\n            this.orderId,\n            gatewayId,\n        );\n    }\n\n    finalize(): Promise<void> {\n        return Promise.reject(new OrderFinalizationNotRequiredError());\n    }\n\n    deinitialize(): Promise<void> {\n        this.orderId = undefined;\n\n        if (this.isPollingEnabled) {\n            this.resetPollingMechanism();\n        }\n\n        this.paypalButton?.close();\n\n        return Promise.resolve();\n    }\n\n    /**\n     *\n     * Polling mechanism\n     *\n     *\n     * */\n    private async initializePollingMechanism(\n        methodId: string,\n        resolvePromise: (value?: unknown) => void,\n        rejectPromise: (value?: unknown) => void,\n        gatewayId?: string,\n    ): Promise<void> {\n        await new Promise<void>((resolve, reject) => {\n            const timeout = setTimeout(resolve, this.pollingInterval);\n\n            this.stopPolling = () => {\n                clearTimeout(timeout);\n                this.toggleLoadingIndicator(false);\n\n                return reject();\n            };\n        });\n\n        try {\n            this.pollingTimer += this.pollingInterval;\n\n            const orderStatus = await this.paypalCommerceIntegrationService.getOrderStatus(\n                gatewayId,\n            );\n\n            const isOrderApproved = orderStatus === PayPalOrderStatus.Approved;\n            const isPollingError = orderStatus === PayPalOrderStatus.PollingError;\n\n            if (isOrderApproved) {\n                this.deinitializePollingMechanism();\n\n                return resolvePromise();\n            }\n\n            if (isPollingError) {\n                return rejectPromise();\n            }\n\n            if (!isOrderApproved && this.pollingTimer < this.maxPollingIntervalTime) {\n                return await this.initializePollingMechanism(\n                    methodId,\n                    resolvePromise,\n                    rejectPromise,\n                    gatewayId,\n                );\n            }\n\n            await this.reinitializeStrategy({\n                methodId,\n                gatewayId,\n                paypalcommercealternativemethods: this.paypalcommercealternativemethods,\n            });\n\n            this.handleError(new TimeoutError());\n        } catch (error) {\n            rejectPromise();\n        }\n    }\n\n    private deinitializePollingMechanism(): void {\n        this.stopPolling();\n        this.pollingTimer = 0;\n    }\n\n    private resetPollingMechanism(): void {\n        this.deinitializePollingMechanism();\n    }\n\n    private async reinitializeStrategy(\n        options: PaymentInitializeOptions &\n            WithPayPalCommerceAlternativeMethodsPaymentInitializeOptions,\n    ) {\n        await this.deinitialize();\n        await this.initialize(options);\n    }\n\n    private handleError(error: unknown) {\n        const { onError } = this.paypalcommercealternativemethods || {};\n\n        if (this.isPollingEnabled) {\n            this.resetPollingMechanism();\n        }\n\n        this.toggleLoadingIndicator(false);\n\n        if (onError && typeof onError === 'function') {\n            onError(error);\n        }\n    }\n\n    /**\n     *\n     * Button methods/callbacks\n     *\n     * */\n    private renderButton(\n        methodId: string,\n        gatewayId: string,\n        paypalOptions: PayPalCommerceAlternativeMethodsPaymentOptions,\n    ): void {\n        const paypalAmpsSdk = this.getPaypalAmpsSdkOrThrow();\n\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod = state.getPaymentMethodOrThrow<PayPalCommerceInitializationData>(\n            methodId,\n            gatewayId,\n        );\n        const { buttonStyle } = paymentMethod.initializationData || {};\n\n        const { container, onError, onRenderButton, submitForm } = paypalOptions;\n\n        const buttonOptions: PayPalCommerceButtonsOptions = {\n            fundingSource: methodId,\n            style: this.paypalCommerceIntegrationService.getValidButtonStyle(buttonStyle),\n            onInit: (_, actions) => paypalOptions.onInitButton(actions),\n            createOrder: () => this.onCreateOrder(methodId, gatewayId, paypalOptions),\n            onApprove: (data) => this.handleApprove(data, submitForm),\n            onCancel: () => {\n                this.toggleLoadingIndicator(false);\n                this.deinitializePollingMechanism();\n            },\n            onError: (error) => {\n                this.deinitializePollingMechanism();\n                this.handleFailure(error, onError);\n            },\n            onClick: async (_, actions) =>\n                paypalOptions.onValidate(actions.resolve, actions.reject),\n        };\n\n        this.paypalButton = paypalAmpsSdk.Buttons(buttonOptions);\n\n        if (!this.paypalButton.isEligible()) {\n            return;\n        }\n\n        if (onRenderButton && typeof onRenderButton === 'function') {\n            onRenderButton();\n        }\n\n        this.paypalButton.render(container);\n    }\n\n    private async onCreateOrder(\n        methodId: string,\n        gatewayId: string,\n        paypalOptions: PayPalCommerceAlternativeMethodsPaymentOptions,\n    ): Promise<string> {\n        const { onValidate } = paypalOptions;\n\n        const onValidationPassed = () => {\n            this.toggleLoadingIndicator(true);\n\n            return () => Promise.resolve();\n        };\n\n        await onValidate(onValidationPassed, noop);\n\n        const orderId = await this.paypalCommerceIntegrationService.createOrder(\n            'paypalcommercealternativemethodscheckout',\n        );\n\n        if (this.isNonInstantPaymentMethod(methodId)) {\n            const order = { useStoreCredit: false };\n            const options = {\n                params: {\n                    methodId,\n                    gatewayId,\n                },\n            };\n\n            await this.paymentIntegrationService.submitOrder(order, options);\n            await this.paypalCommerceIntegrationService.submitPayment(methodId, orderId, gatewayId);\n        }\n\n        return orderId;\n    }\n\n    private handleApprove(\n        { orderID }: ApproveCallbackPayload,\n        submitForm: PayPalCommerceAlternativeMethodsPaymentOptions['submitForm'],\n    ): void {\n        this.orderId = orderID;\n\n        submitForm();\n    }\n\n    private handleFailure(\n        error: Error,\n        onError: PayPalCommerceAlternativeMethodsPaymentOptions['onError'],\n    ): void {\n        this.toggleLoadingIndicator(false);\n\n        if (onError && typeof onError === 'function') {\n            onError(error);\n        }\n    }\n\n    /**\n     *\n     * Fields methods\n     *\n     * */\n    private renderFields(\n        methodId: string,\n        paypalOptions: PayPalCommerceAlternativeMethodsPaymentOptions,\n    ): void {\n        const paypalAmpsSdk = this.getPaypalAmpsSdkOrThrow();\n        const state = this.paymentIntegrationService.getState();\n        const { firstName, lastName, email } = state.getBillingAddressOrThrow();\n\n        const { apmFieldsContainer, apmFieldsStyles } = paypalOptions;\n\n        if (!apmFieldsContainer) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.paypalcommercealternativemethods\" argument should contain \"apmFieldsContainer\".',\n            );\n        }\n\n        const fieldContainerElement = document.querySelector(apmFieldsContainer);\n\n        if (fieldContainerElement) {\n            fieldContainerElement.innerHTML = '';\n        }\n\n        const fieldsOptions = {\n            fundingSource: methodId,\n            style: apmFieldsStyles || {},\n            fields: {\n                name: {\n                    value: `${firstName} ${lastName}`,\n                },\n                email: {\n                    value: email,\n                },\n            },\n        };\n\n        const paypalPaymentFields = paypalAmpsSdk.PaymentFields(fieldsOptions);\n\n        paypalPaymentFields.render(apmFieldsContainer);\n    }\n\n    /**\n     *\n     * Loading Indicator methods\n     *\n     * */\n    private toggleLoadingIndicator(isLoading: boolean): void {\n        if (isLoading && this.loadingIndicatorContainer) {\n            this.loadingIndicator.show(this.loadingIndicatorContainer);\n        } else {\n            this.loadingIndicator.hide();\n        }\n    }\n\n    /**\n     *\n     * Utils\n     *\n     * */\n    private isNonInstantPaymentMethod(methodId: string): boolean {\n        return methodId.toUpperCase() in NonInstantAlternativePaymentMethods;\n    }\n\n    private getPaypalAmpsSdkOrThrow() {\n        if (!this.paypalApms) {\n            throw new PaymentMethodClientUnavailableError();\n        }\n\n        return this.paypalApms;\n    }\n}\n","import {\n    PaymentStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\nimport { createPayPalSdkScriptLoader } from '@bigcommerce/checkout-sdk/paypal-utils';\nimport { LoadingIndicator } from '@bigcommerce/checkout-sdk/ui';\n\nimport createPayPalCommerceIntegrationService from '../create-paypal-commerce-integration-service';\nimport { LOADING_INDICATOR_STYLES } from '../paypal-commerce-constants';\n\nimport PayPalCommerceAlternativeMethodsPaymentStrategy from './paypal-commerce-alternative-methods-payment-strategy';\n\nconst createPayPalCommerceAlternativeMethodsPaymentStrategy: PaymentStrategyFactory<\n    PayPalCommerceAlternativeMethodsPaymentStrategy\n> = (paymentIntegrationService) =>\n    new PayPalCommerceAlternativeMethodsPaymentStrategy(\n        paymentIntegrationService,\n        createPayPalCommerceIntegrationService(paymentIntegrationService),\n        createPayPalSdkScriptLoader(),\n        new LoadingIndicator({\n            containerStyles: LOADING_INDICATOR_STYLES,\n        }),\n    );\n\nexport default toResolvableModule(createPayPalCommerceAlternativeMethodsPaymentStrategy, [\n    { gateway: 'paypalcommercealternativemethods' },\n]);\n","import { HostedInstrument, NonceInstrument } from './payment';\n\ntype PaymentInstrument = CardInstrument | AccountInstrument | HostedInstrument | NonceInstrument;\n\nexport default PaymentInstrument;\n\nexport interface BaseInstrument {\n    bigpayToken: string;\n    defaultInstrument: boolean;\n    provider: string;\n    trustedShippingAddress: boolean;\n    method: string;\n    type: string;\n}\n\nexport enum UntrustedShippingCardVerificationType {\n    CVV = 'cvv',\n    PAN = 'pan',\n}\n\nexport interface CardInstrument extends BaseInstrument {\n    brand: string;\n    expiryMonth: string;\n    expiryYear: string;\n    iin: string;\n    last4: string;\n    type: 'card';\n    untrustedShippingCardVerificationMode: UntrustedShippingCardVerificationType;\n}\n\ninterface BaseAccountInstrument extends BaseInstrument {\n    method: string;\n    type: 'account' | 'bank';\n}\n\nexport interface PayPalInstrument extends BaseAccountInstrument {\n    externalId: string;\n    method: 'paypal';\n}\n\nexport interface AchInstrument extends BaseAccountInstrument {\n    issuer: string;\n    accountNumber: string;\n    type: 'bank';\n    method: 'ach' | 'ecp';\n}\n\nexport interface BankInstrument extends BaseAccountInstrument {\n    accountNumber: string;\n    issuer: string;\n    iban: string;\n    method: string;\n    type: 'bank';\n}\n\nexport type AccountInstrument = PayPalInstrument | BankInstrument | AchInstrument;\n\nexport interface VaultAccessToken {\n    vaultAccessToken: string;\n    vaultAccessExpiry: number;\n}\n\nexport interface SessionContext {\n    customerId: number;\n    storeId: string;\n    currencyCode?: string;\n}\n\nexport interface InstrumentRequestContext extends SessionContext {\n    authToken: string;\n}\n","import {\n    BuyNowCartRequestBody,\n    CardInstrument,\n    CustomerAddress,\n    HostedInstrument,\n    ShippingOption,\n    VaultedInstrument,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\n/**\n *\n * PayPal Funding sources\n *\n */\nexport type FundingType = string[];\nexport type EnableFundingType = FundingType | string;\n\nexport interface PayPalCommerceSDKFunding {\n    CARD: string;\n    PAYPAL: string;\n    CREDIT: string;\n    PAYLATER: string;\n    OXXO: string;\n    SEPA: string;\n    VENMO: string;\n}\n\n/**\n *\n * PayPal BuyNow\n *\n */\nexport interface PayPalBuyNowInitializeOptions {\n    getBuyNowCartRequestBody(): BuyNowCartRequestBody;\n}\n\n/**\n *\n * PayPal Initialization Data\n *\n */\nexport interface PayPalInitializationData {\n    attributionId?: string;\n    availableAlternativePaymentMethods: FundingType;\n    buttonStyle?: PayPalButtonStyleOptions;\n    buyerCountry?: string;\n    clientId: string;\n    clientToken?: string;\n    fastlaneStyles?: FastlaneStylesSettings;\n    connectClientToken?: string; // TODO: remove when PPCP Fastlane A/B test will be finished\n    enabledAlternativePaymentMethods: FundingType;\n    isDeveloperModeApplicable?: boolean;\n    intent?: PayPalIntent;\n    isAcceleratedCheckoutEnabled?: boolean; // PayPal Fastlane related\n    isFastlaneShippingOptionAutoSelectEnabled?: boolean; // PayPal Fastlane related\n    isFastlaneStylingEnabled?: boolean;\n    isHostedCheckoutEnabled?: boolean;\n    isPayPalAnalyticsV2Enabled?: boolean; // PayPal Fastlane related\n    isPayPalCreditAvailable?: boolean;\n    isPayPalCommerceAnalyticsV2Enabled?: boolean; // PayPal Fastlane related\n    isVenmoEnabled?: boolean;\n    isGooglePayEnabled?: boolean;\n    merchantId?: string;\n    orderId?: string;\n    shouldRenderFields?: boolean;\n    shouldRunAcceleratedCheckout?: boolean; // TODO: remove when PPCP Fastlane A/B test will be finished\n    paymentButtonStyles?: Record<string, PayPalButtonStyleOptions>;\n    paypalBNPLConfiguration?: PayPalBNPLConfigurationItem[];\n    threeDSVerificationMethod?: string;\n}\n\n/**\n *\n * PayPalHostWindow contains different\n * PayPal Sdk instances for different purposes\n *\n */\nexport interface PayPalHostWindow extends Window {\n    paypal?: PayPalSDK;\n    paypalFastlane?: PayPalFastlane;\n    paypalFastlaneSdk?: PayPalFastlaneSdk;\n    paypalMessages?: PayPalMessagesSdk;\n    paypalApms?: PayPalApmSdk;\n    paypalGooglePay?: PayPalGooglePaySdk;\n}\n\n/**\n *\n * PayPal SDK config\n *\n */\nexport interface PayPalSdkConfig {\n    options: {\n        'client-id'?: string;\n        'merchant-id'?: string;\n        'buyer-country'?: string;\n        'enable-funding'?: EnableFundingType;\n        'disable-funding'?: FundingType;\n        currency?: string;\n        commit?: boolean;\n        intent?: PayPalIntent;\n        components?: PayPalSdkComponents;\n    };\n    attributes: {\n        'data-client-metadata-id'?: string;\n        'data-partner-attribution-id'?: string;\n        'data-sdk-client-token'?: string;\n        'data-namespace'?: string;\n        'data-client-token'?: string;\n    };\n}\n\nexport enum PayPalIntent {\n    AUTHORIZE = 'authorize',\n    CAPTURE = 'capture',\n}\n\nexport type PayPalSdkComponents = Array<\n    | 'fastlane'\n    | 'three-domain-secure'\n    | 'buttons'\n    | 'funding-eligibility'\n    | 'hosted-fields'\n    | 'messages'\n    | 'payment-fields'\n    | 'legal'\n    | 'googlepay'\n    | 'connect'\n    | 'card-fields'\n>;\n\nexport type PayPalLegal = (params: { fundingSource: string }) => {\n    render(container: string): void;\n};\n\nexport interface LegalFunding {\n    FUNDING: {\n        PAY_UPON_INVOICE: string;\n    };\n}\n\n/**\n *\n * PayPal Sdk instances\n *\n */\nexport interface PayPalSDK {\n    CardFields: (data: PaypalCardFieldsConfig) => Promise<PayPalCardFields>;\n    Googlepay: () => {\n        config: () => Promise<GooglePayConfig>;\n        confirmOrder: (arg0: {\n            orderId: string;\n            paymentMethodData: ConfirmOrderData;\n        }) => Promise<{ status: string }>;\n        initiatePayerAction: () => void;\n    };\n    FUNDING: PayPalCommerceSDKFunding;\n    HostedFields: {\n        isEligible(): boolean;\n        render(data: PayPalHostedFieldsRenderOptions): Promise<PayPalHostedFields>;\n    };\n    Legal: PayPalLegal & LegalFunding;\n    Buttons(options: PayPalButtonsOptions): PayPalButtons;\n    PaymentFields(options: PayPalPaymentFieldsOptions): PayPalPaymentFields;\n    Messages(options: PayPalMessagesOptions): PayPalMessages;\n}\n\nexport interface PaypalCardFieldsConfig {\n    inputEvents: {\n        onChange(data: PayPalCardFieldsState): void;\n        onFocus(data: PayPalCardFieldsState): void;\n        onBlur(data: PayPalCardFieldsState): void;\n        onInputSubmitRequest(data: PayPalCardFieldsState): void;\n    };\n    createVaultSetupToken?: (data: PayPalCardFieldsState) => void;\n    createOrder?: () => Promise<string>;\n    style: PayPalHostedFieldsRenderOptions['styles'];\n    onApprove(data: PayPalCardFieldsOnApproveData): void;\n    onError(): void;\n}\n\ninterface PayPalFieldsInitializationData {\n    placeholder?: string;\n}\n\nexport interface PayPalCardFields {\n    isEligible(): boolean;\n    CVVField(config?: PayPalFieldsInitializationData): PayPalFields;\n    ExpiryField(config?: PayPalFieldsInitializationData): PayPalFields;\n    NameField(config?: PayPalFieldsInitializationData): PayPalFields;\n    NumberField(config?: PayPalFieldsInitializationData): PayPalFields;\n    submit(config?: PayPalCardFieldsSubmitConfig): Promise<void>;\n    getState(): Promise<PayPalCardFieldsState>;\n}\n\nexport interface PayPalCardFieldsSubmitConfig {\n    billingAddress: {\n        company?: string;\n        addressLine1: string;\n        addressLine2?: string;\n        adminArea1: string; // State\n        adminArea2: string; // City\n        postalCode: string;\n        countryCode?: string;\n    };\n}\n\nexport interface PayPalCardFieldsOnApproveData {\n    vaultSetupToken?: string;\n    orderID: string;\n    liabilityShift?: LiabilityShiftEnum;\n}\n\ninterface PayPalCardFieldsFieldData {\n    isFocused: boolean;\n    isEmpty: boolean;\n    isValid: boolean;\n    isPotentiallyValid: boolean;\n}\n\ntype PayPalCardFieldsCard = PayPalHostedFieldsCard;\n\nexport interface PayPalCardFieldsState {\n    cards: PayPalCardFieldsCard[];\n    emittedBy: string;\n    isFormValid: boolean;\n    errors: string[];\n    fields: {\n        cardCvvField: PayPalCardFieldsFieldData;\n        cardNumberField: PayPalCardFieldsFieldData;\n        cardNameField?: PayPalCardFieldsFieldData;\n        cardExpiryField: PayPalCardFieldsFieldData;\n    };\n}\n\nexport interface PayPalFields {\n    render(container: HTMLElement | string): Promise<void>;\n    clear(): void;\n    removeClass(className: string): Promise<void>;\n    close(): Promise<void>;\n}\n\nexport interface PayPalFastlaneSdk {\n    ThreeDomainSecureClient: {\n        isEligible(params: threeDSecureParameters): Promise<boolean>;\n        show(): Promise<ThreeDomainSecureClientShowResponse>;\n    };\n    Fastlane(options?: PayPalFastlaneOptions): Promise<PayPalFastlane>;\n}\n\ninterface ThreeDomainSecureClientShowResponse {\n    liabilityShift: LiabilityShiftEnum;\n    authenticationState: TDSecureAuthenticationState;\n    nonce: string; // Enriched nonce or the original nonce\n}\n\nexport enum TDSecureAuthenticationState {\n    Succeeded = 'succeeded',\n    Cancelled = 'cancelled',\n    Errored = 'errored',\n}\n\nexport enum LiabilityShiftEnum {\n    Possible = 'POSSIBLE',\n    No = 'NO',\n    Unknown = 'UNKNOWN',\n    Yes = 'YES',\n}\n\nexport interface threeDSecureParameters {\n    amount: string;\n    currency: string;\n    nonce: string;\n    threeDSRequested: boolean;\n    transactionContext: {\n        experience_context: {\n            brand_name?: string;\n            locale: string;\n            return_url: string;\n            cancel_url: string;\n        };\n    };\n}\n\nexport interface PayPalMessagesSdk {\n    Messages(options: MessagingOptions): MessagingRender;\n}\n\nexport interface PayPalApmSdk {\n    Buttons(options: PayPalButtonsOptions): PayPalButtons;\n    PaymentFields(options: PayPalPaymentFieldsOptions): PayPalPaymentFields;\n}\n\nexport interface PayPalGooglePaySdk {\n    Googlepay(): GooglePay;\n}\n\n/**\n *\n * PayPal Payments Hosted Fields\n *\n */\nexport interface PayPalHostedFieldsRenderOptions {\n    fields?: {\n        number?: PayPalHostedFieldOption;\n        cvv?: PayPalHostedFieldOption;\n        expirationDate?: PayPalHostedFieldOption;\n    };\n    paymentsSDK?: boolean;\n    styles?: {\n        input?: { [key: string]: string };\n        '.invalid'?: { [key: string]: string };\n        '.valid'?: { [key: string]: string };\n        ':focus'?: { [key: string]: string };\n    };\n    createOrder(): Promise<string>;\n}\n\nexport interface PayPalHostedFieldOption {\n    selector: string;\n    placeholder?: string;\n}\n\nexport interface PayPalHostedFields {\n    submit(options?: PayPalHostedFieldsSubmitOptions): Promise<PayPalHostedFieldsApprove>;\n    getState(): PayPalHostedFieldsState;\n    on(eventName: string, callback: (event: PayPalHostedFieldsState) => void): void;\n}\n\nexport interface PayPalHostedFieldsSubmitOptions {\n    contingencies?: Array<'3D_SECURE'>;\n    cardholderName?: string;\n}\n\nexport interface PayPalHostedFieldsApprove {\n    orderId: string;\n    liabilityShift?: 'POSSIBLE' | 'NO' | 'UNKNOWN';\n}\n\nexport interface PayPalHostedFieldsState {\n    cards: PayPalHostedFieldsCard[];\n    emittedBy: string;\n    fields: {\n        number?: PayPalHostedFieldsFieldData;\n        expirationDate?: PayPalHostedFieldsFieldData;\n        expirationMonth?: PayPalHostedFieldsFieldData;\n        expirationYear?: PayPalHostedFieldsFieldData;\n        cvv?: PayPalHostedFieldsFieldData;\n        postalCode?: PayPalHostedFieldsFieldData;\n    };\n}\n\nexport interface PayPalHostedFieldsCard {\n    type: string;\n    niceType: string;\n    code: {\n        name: string;\n        size: number;\n    };\n}\n\nexport interface PayPalHostedFieldsFieldData {\n    container: HTMLElement;\n    isFocused: boolean;\n    isEmpty: boolean;\n    isPotentiallyValid: boolean;\n    isValid: boolean;\n}\n\n/**\n *\n * PayPal Buttons\n *\n */\nexport interface PayPalButtons {\n    render(id: string): void;\n    close(): void;\n    isEligible(): boolean;\n}\n\nexport interface PayPalButtonsOptions {\n    experience?: string;\n    style?: PayPalButtonStyleOptions;\n    fundingSource: string;\n    createOrder(): Promise<string>;\n    onApprove(\n        data: ApproveCallbackPayload,\n        actions: ApproveCallbackActions,\n    ): Promise<boolean | void> | void;\n    onInit?(data: InitCallbackPayload, actions: InitCallbackActions): Promise<void>;\n    onComplete?(data: CompleteCallbackDataPayload): Promise<void>;\n    onClick?(data: ClickCallbackPayload, actions: ClickCallbackActions): Promise<void> | void;\n    onError?(error: Error): void;\n    onCancel?(): void;\n    onShippingAddressChange?(data: ShippingAddressChangeCallbackPayload): Promise<void>;\n    onShippingOptionsChange?(data: ShippingOptionChangeCallbackPayload): Promise<void>;\n}\n\nexport interface ShippingOptionChangeCallbackPayload {\n    orderId: string;\n    selectedShippingOption: PayPalSelectedShippingOption;\n}\n\nexport interface ShippingAddressChangeCallbackPayload {\n    orderId: string;\n    shippingAddress: PayPalAddress;\n}\n\nexport interface ClickCallbackPayload {\n    fundingSource: string;\n}\n\nexport interface ClickCallbackActions {\n    reject(): void;\n    resolve(): void;\n}\n\nexport interface InitCallbackPayload {\n    correlationID: string;\n}\n\nexport interface InitCallbackActions {\n    disable(): void;\n    enable(): void;\n}\n\nexport interface PayPalAddress {\n    city: string;\n    countryCode: string;\n    postalCode: string;\n    state: string;\n}\n\nexport interface PaypalAddressCallbackData {\n    city: string;\n    country_code: string;\n    postal_code: string;\n    state: string;\n}\n\nexport interface PayPalSelectedShippingOption {\n    amount: {\n        currency_code: string;\n        value: string;\n    };\n    id: string;\n    label: string;\n    selected: boolean;\n    type: string;\n}\n\nexport interface ApproveCallbackPayload {\n    orderID?: string;\n}\n\nexport interface ApproveCallbackActions {\n    order: {\n        get: () => Promise<PayPalOrderDetails>;\n    };\n}\n\nexport interface PayPalOrderDetails {\n    payer: {\n        name: {\n            given_name: string;\n            surname: string;\n        };\n        email_address: string;\n        address: PayPalOrderAddress;\n        phone?: {\n            phone_number: {\n                national_number: string;\n            };\n        };\n    };\n    purchase_units: Array<{\n        shipping: {\n            address: PayPalOrderAddress;\n            name: {\n                full_name: string;\n            };\n        };\n    }>;\n}\n\nexport interface PayPalOrderAddress {\n    address_line_1: string;\n    address_line_2: string;\n    admin_area_2: string;\n    admin_area_1?: string;\n    postal_code: string;\n    country_code: string;\n}\n\nexport interface CompleteCallbackDataPayload {\n    intent: string;\n    orderID: string;\n}\n\nexport enum StyleButtonLabel {\n    paypal = 'paypal',\n    checkout = 'checkout',\n    buynow = 'buynow',\n    pay = 'pay',\n    installment = 'installment',\n}\n\nexport enum StyleButtonColor {\n    gold = 'gold',\n    blue = 'blue',\n    silver = 'silver',\n    black = 'black',\n    white = 'white',\n}\n\nexport enum StyleButtonShape {\n    pill = 'pill',\n    rect = 'rect',\n}\n\nexport interface PayPalButtonStyleOptions {\n    color?: StyleButtonColor;\n    shape?: StyleButtonShape;\n    height?: number;\n    label?: StyleButtonLabel;\n}\n\nexport interface PayPalButtonOptions {\n    fundingSource: string;\n    style?: PayPalButtonStyleOptions;\n    onClick?: () => void;\n    onCancel?: () => void;\n    onPaymentComplete?: () => void;\n}\n\n/**\n *\n * PayPal Messages\n */\n// TODO: This interface can be removed once the PayPaySDK interface is removed\nexport interface PayPalMessages {\n    render(id: string): void;\n}\n\n// TODO: This interface can be removed once the PayPaySDK interface is removed\nexport interface PayPalMessagesOptions {\n    amount: number;\n    placement: string;\n    style?: PayPalMessagesStyleOptions;\n    fundingSource?: string;\n}\n\n// TODO: This interface can be removed once the PayPaySDK interface is removed\nexport interface PayPalMessagesStyleOptions {\n    layout?: string;\n}\n\n/**\n *\n * Google Pay related types\n *\n */\n\ninterface GooglePay {\n    config: () => Promise<GooglePayConfig>;\n    confirmOrder: (confirmOrderConfig: ConfirmOrderConfig) => Promise<{ status: string }>;\n    initiatePayerAction: (payerActionConfig: PayerActionConfig) => Promise<void>;\n}\n\ninterface ConfirmOrderConfig {\n    orderId: string;\n    paymentMethodData: ConfirmOrderData;\n}\n\nexport interface ConfirmOrderData {\n    tokenizationData: {\n        type: string;\n        token: string;\n    };\n    info: {\n        cardNetwork: string;\n        cardDetails: string;\n    };\n    type: string;\n}\n\ninterface PayerActionConfig {\n    orderId: string;\n}\n\nexport interface GooglePayConfig {\n    allowedPaymentMethods: AllowedPaymentMethods[];\n    apiVersion: number;\n    apiVersionMinor: number;\n    countryCode: string;\n    isEligible: boolean;\n    merchantInfo: {\n        merchantId: string;\n        merchantOrigin: string;\n    };\n}\n\nexport interface AllowedPaymentMethods {\n    type: string;\n    parameters: {\n        allowedAuthMethods: string[];\n        allowedCardNetworks: string[];\n        billingAddressRequired: boolean;\n        assuranceDetailsRequired: boolean;\n        billingAddressParameters: {\n            format: string;\n        };\n    };\n    tokenizationSpecification: {\n        type: string;\n        parameters: {\n            gateway: string;\n            gatewayMerchantId: string;\n        };\n    };\n}\n\n/**\n *\n * PayPal  Payment fields\n *\n */\nexport interface PayPalPaymentFields {\n    render(id: string): void;\n}\n\nexport interface PayPalPaymentFieldsOptions {\n    style?: PayPalFieldsStyleOptions;\n    fundingSource: string;\n    fields: {\n        name?: {\n            value?: string;\n        };\n        email?: {\n            value?: string;\n        };\n    };\n}\n\nexport interface PayPalFieldsStyleOptions {\n    variables?: {\n        fontFamily?: string;\n        fontSizeBase?: string;\n        fontSizeSm?: string;\n        fontSizeM?: string;\n        fontSizeLg?: string;\n        textColor?: string;\n        colorTextPlaceholder?: string;\n        colorBackground?: string;\n        colorInfo?: string;\n        colorDanger?: string;\n        borderRadius?: string;\n        borderColor?: string;\n        borderWidth?: string;\n        borderFocusColor?: string;\n        spacingUnit?: string;\n    };\n    rules?: {\n        [key: string]: any;\n    };\n}\n\n/**\n *\n * PayLater Messages related types\n * doc: https://developer.paypal.com/docs/checkout/pay-later/us/integrate/reference\n */\nexport interface MessagingRender {\n    render(container: string): void;\n}\n\nexport interface MessagesStyleOptions {\n    color?: string; // 'blue' | 'black' | 'white' | 'white-no-border' | 'gray' | 'monochrome' | 'grayscale'\n    layout?: string; // 'text' | 'flex'\n    logo?: {\n        type?: string; // 'primary' | 'alternative' | 'inline' | 'none'\n        position?: string; // 'left' | 'right' | 'top'\n    };\n    ratio?: string; // '1x1' | '1x4' | '8x1' | '20x1'\n    text?: {\n        align?: string; // 'left' | 'right' | 'center'\n        color?: string; // 'black' | 'white' | 'monochrome' | 'grayscale'\n        size?: number; // from 10 to 16\n    };\n}\n\nexport interface MessagingOptions {\n    amount: number;\n    placement: string;\n    style?: MessagesStyleOptions;\n}\n\nexport interface PayPalBNPLConfigurationItem {\n    id: string;\n    name: string;\n    status: boolean;\n    styles: Record<string, string>;\n}\n\n/**\n *\n * PayPal Fastlane related types\n *\n */\nexport interface PayPalFastlane {\n    identity: PayPalFastlaneIdentity;\n    events: PayPalFastlaneEvents;\n    profile: PayPalFastlaneProfile;\n    FastlaneCardComponent(\n        options: PayPalFastlaneCardComponentOptions,\n    ): Promise<PayPalFastlaneCardComponentMethods>;\n}\n\nexport interface PayPalFastlaneOptions {\n    styles?: PayPalFastlaneStylesOption;\n}\n\nexport interface PayPalFastlaneIdentity {\n    lookupCustomerByEmail(email: string): Promise<PayPalFastlaneLookupCustomerByEmailResult>;\n    triggerAuthenticationFlow(\n        customerContextId: string,\n    ): Promise<PayPalFastlaneAuthenticationResult>;\n}\n\nexport interface PayPalFastlaneLookupCustomerByEmailResult {\n    customerContextId?: string;\n}\n\nexport interface PayPalFastlaneAuthenticationResult {\n    authenticationState?: PayPalFastlaneAuthenticationState;\n    profileData?: PayPalFastlaneProfileData;\n}\n\nexport enum PayPalFastlaneAuthenticationState {\n    SUCCEEDED = 'succeeded',\n    FAILED = 'failed',\n    CANCELED = 'canceled',\n    UNRECOGNIZED = 'unrecognized',\n}\n\nexport interface PayPalFastlaneProfileData {\n    name: PayPalFastlaneProfileName;\n    shippingAddress: PayPalFastlaneShippingAddress;\n    card: PayPalFastlaneProfileCard;\n}\n\nexport interface PayPalFastlaneProfileName {\n    fullName: string;\n    firstName?: string;\n    lastName?: string;\n}\n\nexport interface PayPalFastlaneProfilePhone {\n    countryCode: string;\n    nationalNumber: string;\n}\n\nexport interface PayPalFastlaneShippingAddress {\n    name: PayPalFastlaneProfileName;\n    phoneNumber: PayPalFastlaneProfilePhone;\n    address: PayPalFastlaneAddress;\n}\n\nexport interface PayPalFastlaneProfileCard {\n    id: string; // nonce / token\n    paymentSource: PayPalFastlanePaymentSource;\n}\n\nexport interface PayPalFastlanePaymentSource {\n    card: PayPalFastlaneCardSource;\n}\n\nexport interface PayPalFastlaneCardSource {\n    brand: string;\n    expiry: string; // \"YYYY-MM\"\n    lastDigits: string; // \"1111\"\n    name: string;\n    billingAddress: PayPalFastlaneAddress;\n}\n\nexport interface PayPalFastlaneAddress {\n    company?: string;\n    addressLine1: string;\n    addressLine2?: string;\n    adminArea1: string; // State\n    adminArea2: string; // City\n    postalCode: string;\n    countryCode?: string;\n}\n\nexport interface PayPalFastlaneProfileToBcCustomerDataMappingResult {\n    authenticationState: PayPalFastlaneAuthenticationState;\n    addresses: CustomerAddress[];\n    billingAddress?: CustomerAddress;\n    shippingAddress?: CustomerAddress;\n    instruments: CardInstrument[];\n}\n\nexport interface PayPalFastlaneStylesOption {\n    root?: {\n        backgroundColorPrimary?: string;\n        errorColor?: string;\n        fontFamily?: string;\n        fontSizeBase?: string;\n        padding?: string;\n        primaryColor?: string;\n    };\n    input?: {\n        borderRadius?: string;\n        borderColor?: string;\n        focusBorderColor?: string;\n        backgroundColor?: string;\n        borderWidth?: string;\n        textColorBase?: string;\n    };\n    toggle?: {\n        colorPrimary?: string;\n        colorSecondary?: string;\n    };\n    text?: {\n        body?: {\n            color?: string;\n            fontSize?: string;\n        };\n        caption?: {\n            color?: string;\n            fontSize?: string;\n        };\n    };\n    branding?: string; // 'light' | 'dark'\n}\n\nexport interface PayPalFastlaneProfile {\n    showCardSelector(): Promise<PayPalFastlaneCardSelectorResponse>;\n    showShippingAddressSelector(): Promise<PayPalFastlaneShippingAddressSelectorResponse>;\n}\n\nexport interface PayPalFastlaneShippingAddressSelectorResponse {\n    selectionChanged: boolean;\n    selectedAddress: PayPalFastlaneShippingAddress;\n}\n\nexport interface PayPalFastlaneCardSelectorResponse {\n    selectionChanged: boolean;\n    selectedCard: PayPalFastlaneProfileCard;\n}\n\nexport interface PayPalFastlaneCardComponentMethods {\n    getPaymentToken(\n        options: PayPalFastlaneGetPaymentTokenOptions,\n    ): Promise<PayPalFastlaneProfileCard>;\n    render(element: string): void;\n}\n\nexport interface PayPalFastlaneGetPaymentTokenOptions {\n    name?: PayPalFastlaneProfileName;\n    billingAddress?: PayPalFastlaneAddress;\n}\n\nexport interface PayPalFastlaneCardComponentOptions {\n    fields?: PayPalFastlaneCardComponentFields;\n}\n\nexport interface PayPalFastlaneCardComponentFields {\n    cardholderName?: {\n        enabled?: boolean;\n        prefill?: string;\n    };\n    phoneNumber?: {\n        placeholder?: string;\n        prefill?: string;\n    };\n}\n\nexport interface PayPalFastlaneEvents {\n    apmSelected: (options: PayPalFastlaneApmSelectedEventOptions) => void;\n    emailSubmitted: (options: PayPalFastlaneEmailEnteredEventOptions) => void;\n    orderPlaced: (options: PayPalFastlaneOrderPlacedEventOptions) => void;\n}\n\nexport interface PayPalFastlaneEventCommonOptions {\n    context_type: 'cs_id';\n    context_id: string; // checkout session id\n    page_type: 'checkout_page';\n    page_name: string; // title of the checkout initiation page\n    partner_name: 'bigc';\n    user_type: 'store_member' | 'store_guest'; // type of the user on the merchant site\n    store_id: string;\n    merchant_name: string;\n    experiment: string; // stringify JSON object \"[{ treatment_group: 'test' | 'control' }]\"\n}\n\nexport interface PayPalFastlaneApmSelectedEventOptions extends PayPalFastlaneEventCommonOptions {\n    apm_shown: '0' | '1'; // alternate payment shown on the checkout page\n    apm_list: string; // list of alternate payment shown on checkout page\n    apm_selected: string; // alternate payment method selected / methodId\n    apm_location: 'pre-email section' | 'payment section'; // placement of APM, whether it be above the email entry or in the radio buttons\n}\n\nexport interface PayPalFastlaneEmailEnteredEventOptions extends PayPalFastlaneEventCommonOptions {\n    user_email_saved: boolean; // shows whether checkout was loaded with or without a saved email\n    apm_shown: '0' | '1'; // alternate payment shown on the checkout page\n    apm_list: string; // list of alternate payment shown on checkout page 'applepay,googlepay,paypal'\n}\n\nexport interface PayPalFastlaneOrderPlacedEventOptions extends PayPalFastlaneEventCommonOptions {\n    selected_payment_method: string;\n    currency_code: string;\n}\n\nexport interface PayPalFastlanePaymentFormattedPayload {\n    paypal_connect_token?: {\n        order_id?: string;\n        token: string;\n    };\n    paypal_fastlane_token?: {\n        order_id?: string;\n        token: string;\n    };\n}\n\nexport interface FastlaneStylesSettings {\n    fastlaneRootSettingsBackgroundColor?: string;\n    fastlaneRootSettingsErrorColor?: string;\n    fastlaneRootSettingsFontFamily?: string;\n    fastlaneRootSettingsPadding?: string;\n    fastlaneRootSettingsPrimaryColor?: string;\n    fastlaneRootSettingsFontSize?: string;\n    fastlaneInputSettingsBackgroundColor?: string;\n    fastlaneInputSettingsBorderRadius?: string;\n    fastlaneInputSettingsBorderWidth?: string;\n    fastlaneInputSettingsTextColorBase?: string;\n    fastlaneInputSettingsBorderColor?: string;\n    fastlaneInputSettingsFocusBorderBase?: string;\n    fastlaneToggleSettingsColorPrimary?: string;\n    fastlaneToggleSettingsColorSecondary?: string;\n    fastlaneTextBodySettingsColor?: string;\n    fastlaneTextBodySettingsFontSize?: string;\n    fastlaneTextCaptionSettingsFontSize?: string;\n    fastlaneTextCaptionSettingsColor?: string;\n    fastlaneBrandingSettings?: string;\n}\n\n/**\n *\n * Other\n *\n */\nexport enum NonInstantAlternativePaymentMethods {\n    OXXO = 'oxxo',\n}\n\nexport interface PayPalOrderData {\n    orderId: string;\n    setupToken?: string;\n    approveUrl: string;\n}\n\nexport interface PayPalUpdateOrderRequestBody {\n    availableShippingOptions?: ShippingOption[];\n    cartId: string;\n    selectedShippingOption?: ShippingOption;\n}\n\nexport interface PayPalUpdateOrderResponse {\n    statusCode: number;\n}\n\nexport interface PayPalCreateOrderRequestBody extends HostedInstrument, VaultedInstrument {\n    cartId: string;\n    metadataId?: string;\n    setupToken?: boolean;\n    fastlaneToken?: string;\n}\n\nexport enum PayPalOrderStatus {\n    Approved = 'APPROVED',\n    Created = 'CREATED',\n    PayerActionRequired = 'PAYER_ACTION_REQUIRED',\n    PollingStop = 'POLLING_STOP',\n    PollingError = 'POLLING_ERROR',\n}\n\nexport interface PayPalOrderStatusData {\n    status: PayPalOrderStatus;\n}\n\nexport interface PayPalCreateOrderCardFieldsResponse {\n    orderId: string;\n    setupToken?: string;\n}\n","interface CookieOptions {\n    expires?: Date;\n    path?: string;\n    domain?: string;\n    secure?: boolean;\n}\n\nexport default class CookieStorage {\n    static get(name: string): string | null {\n        const cookieKey = `${encodeURIComponent(`${name}`)}=`;\n        const cookie = document.cookie;\n\n        let value = null;\n\n        const firstIndex = cookie.indexOf(cookieKey);\n\n        if (firstIndex > -1) {\n            let lastIndex = cookie.indexOf(';', firstIndex);\n\n            if (lastIndex === -1) {\n                lastIndex = cookie.length;\n            }\n\n            value = decodeURIComponent(cookie.substring(firstIndex + cookieKey.length, lastIndex));\n        }\n\n        return value;\n    }\n\n    static set(name: string, value: string, options: CookieOptions = { secure: true }) {\n        let cookieText = `${encodeURIComponent(name)}=${encodeURIComponent(value)}`;\n\n        const { expires, path, domain, secure } = options;\n\n        if (expires) {\n            cookieText += `; expires=${expires.toUTCString()}`;\n        } else {\n            const now = new Date();\n            // info: default cookie expiration time after setup\n            const minutes = 60;\n\n            now.setTime(now.getTime() + minutes * 60 * 1000);\n\n            cookieText += `; expires=${now.toUTCString()}`;\n        }\n\n        if (path) {\n            cookieText += `; path=${path}`;\n        }\n\n        if (domain) {\n            cookieText += `; domain=${domain}`;\n        }\n\n        if (secure) {\n            cookieText += '; secure';\n        }\n\n        document.cookie = cookieText;\n    }\n\n    static remove(name: string, options?: CookieOptions) {\n        CookieStorage.set(name, '', { expires: new Date(0), ...options });\n    }\n}\n","// copied from packages/core/src/hosted-form/hosted-field-type.ts\n\nenum HostedFieldType {\n    CardCode = 'cardCode',\n    CardCodeVerification = 'cardCodeVerification',\n    CardExpiry = 'cardExpiry',\n    CardName = 'cardName',\n    CardNumber = 'cardNumber',\n    CardNumberVerification = 'cardNumberVerification',\n    CardExpiryVerification = 'cardExpiryVerification',\n}\n\nexport default HostedFieldType;\n","import { isEqual, omit } from 'lodash';\n\nimport {\n    Address,\n    CardInstrument,\n    CustomerAddress,\n    PaymentMethodClientUnavailableError,\n    UntrustedShippingCardVerificationType,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\nimport { CookieStorage } from '@bigcommerce/checkout-sdk/storage';\n\nimport {\n    PayPalFastlane,\n    PayPalFastlaneAddress,\n    PayPalFastlaneAuthenticationResult,\n    PayPalFastlaneAuthenticationState,\n    PayPalFastlaneLookupCustomerByEmailResult,\n    PayPalFastlaneProfileCard,\n    PayPalFastlaneProfileName,\n    PayPalFastlaneProfilePhone,\n    PayPalFastlaneProfileToBcCustomerDataMappingResult,\n    PayPalFastlaneSdk,\n    PayPalFastlaneStylesOption,\n    PayPalHostWindow,\n} from './paypal-types';\n\nexport default class PaypalFastlaneUtils {\n    private window: PayPalHostWindow;\n\n    constructor() {\n        this.window = window;\n    }\n\n    async initializePayPalFastlane(\n        paypalFastlaneSdk: PayPalFastlaneSdk,\n        isTestModeEnabled: boolean,\n        styles?: PayPalFastlaneStylesOption,\n    ): Promise<PayPalFastlane> {\n        if (isTestModeEnabled) {\n            window.localStorage.setItem('fastlaneEnv', 'sandbox');\n            window.localStorage.setItem('axoEnv', 'sandbox'); // TODO: remove if this key does not use on PayPal side\n        }\n\n        if (!this.window.paypalFastlane) {\n            const defaultStyles = {\n                root: {\n                    backgroundColorPrimary: 'transparent',\n                },\n            };\n\n            this.window.paypalFastlane = await paypalFastlaneSdk.Fastlane({\n                styles: styles || defaultStyles,\n            });\n        }\n\n        return this.window.paypalFastlane;\n    }\n\n    getPayPalFastlaneOrThrow(): PayPalFastlane {\n        if (!this.window.paypalFastlane) {\n            throw new PaymentMethodClientUnavailableError();\n        }\n\n        return this.window.paypalFastlane;\n    }\n\n    /**\n     *\n     * Detects the customer to PayPal Fastlane relation and\n     * returns customerContextId to use it for authentication\n     *\n     */\n    async lookupCustomerOrThrow(email: string): Promise<PayPalFastlaneLookupCustomerByEmailResult> {\n        const paypalFastlane = this.getPayPalFastlaneOrThrow();\n\n        return paypalFastlane.identity.lookupCustomerByEmail(email);\n    }\n\n    /**\n     *\n     * Triggers authentication flow (shows OTP popup) if the customer recognised as PayPal Fastlane user\n     * and returns PayPal Fastlane Profile data to use it in BC checkout\n     *\n     */\n    async triggerAuthenticationFlowOrThrow(\n        customerContextId?: string,\n    ): Promise<PayPalFastlaneAuthenticationResult> {\n        if (!customerContextId) {\n            return {};\n        }\n\n        const paypalFastlane = this.getPayPalFastlaneOrThrow();\n\n        return paypalFastlane.identity.triggerAuthenticationFlow(customerContextId);\n    }\n\n    /**\n     *\n     * 'updateStorageSessionId' method is used to:\n     * - set session id after user was authenticated (or unrecognised) to trigger authentication after page refresh\n     *\n     * Flow info:\n     * If user unrecognised then the lookup method will be working but the OTP will not be shown\n     * If user recognised and not canceled then the lookup method will be working and the OTP will be shown only if needed\n     * If user cancels the OPT then OTP will not be triggered after page refresh\n     *\n     */\n    updateStorageSessionId(sessionId: string): void {\n        const expires = new Date();\n\n        expires.setDate(expires.getDate() + 14); // 2 weeks expiry\n\n        const cookiesOption = {\n            expires,\n            secure: true,\n        };\n\n        CookieStorage.set('bc-fastlane-sessionId', sessionId, cookiesOption);\n    }\n\n    removeStorageSessionId(): void {\n        CookieStorage.remove('bc-fastlane-sessionId');\n    }\n\n    getStorageSessionId(): string {\n        return CookieStorage.get('bc-fastlane-sessionId') || '';\n    }\n\n    /**\n     *\n     * 'mapPayPalFastlaneProfileToBcCustomerData' method is responsible for:\n     * - mapping PayPal Fastlane Profile data to BC data shape\n     * - returning mapped data to use for updating PaymentProviderCustomer state and\n     * update shipping and billing addresses\n     *\n     */\n    mapPayPalFastlaneProfileToBcCustomerData(\n        methodId: string,\n        authenticationResult: PayPalFastlaneAuthenticationResult,\n    ): PayPalFastlaneProfileToBcCustomerDataMappingResult {\n        const { authenticationState, profileData } = authenticationResult;\n\n        const paypalBillingAddress = profileData?.card?.paymentSource?.card?.billingAddress;\n        const paypalShippingAddress = profileData?.shippingAddress;\n        const paypalProfileName = profileData?.name;\n        const paypalInstrument = profileData?.card;\n\n        const shippingAddress = paypalShippingAddress\n            ? this.mapPayPalToBcAddress(\n                  paypalShippingAddress.address,\n                  paypalShippingAddress.name,\n                  paypalShippingAddress.phoneNumber,\n              )\n            : undefined;\n        const billingAddress =\n            paypalBillingAddress && paypalProfileName\n                ? this.mapPayPalToBcAddress(\n                      paypalBillingAddress,\n                      paypalProfileName,\n                      paypalShippingAddress?.phoneNumber,\n                  )\n                : undefined;\n        const instruments = paypalInstrument\n            ? this.mapPayPalToBcInstrument(methodId, paypalInstrument)\n            : [];\n\n        const addresses = this.filterAddresses([shippingAddress, billingAddress]);\n\n        return {\n            authenticationState:\n                authenticationState || PayPalFastlaneAuthenticationState.UNRECOGNIZED,\n            addresses,\n            billingAddress,\n            shippingAddress,\n            instruments,\n        };\n    }\n\n    mapPayPalToBcInstrument(\n        methodId: string,\n        instrument: PayPalFastlaneProfileCard,\n    ): CardInstrument[] {\n        const { id, paymentSource } = instrument;\n        const { brand, expiry, lastDigits } = paymentSource.card;\n\n        const [expiryYear, expiryMonth] = expiry.split('-');\n\n        return [\n            {\n                bigpayToken: id,\n                brand,\n                defaultInstrument: false,\n                expiryMonth,\n                expiryYear,\n                iin: '',\n                last4: lastDigits,\n                method: methodId,\n                provider: methodId,\n                trustedShippingAddress: false,\n                untrustedShippingCardVerificationMode: UntrustedShippingCardVerificationType.PAN,\n                type: 'card',\n            },\n        ];\n    }\n\n    mapBcToPayPalAddress(address?: Address): PayPalFastlaneAddress {\n        return {\n            company: address?.company || '',\n            addressLine1: address?.address1 || '',\n            addressLine2: address?.address2 || '',\n            adminArea1: address?.stateOrProvinceCode || address?.stateOrProvince || '',\n            adminArea2: address?.city || '',\n            postalCode: address?.postalCode || '',\n            countryCode: address?.countryCode || '',\n        };\n    }\n\n    mapPayPalToBcAddress(\n        address: PayPalFastlaneAddress,\n        profileName: PayPalFastlaneProfileName,\n        phone?: PayPalFastlaneProfilePhone,\n        customFields?: CustomerAddress['customFields'],\n    ): CustomerAddress {\n        const [firstName, lastName] = profileName.fullName.split(' ');\n\n        const phoneData = {\n            nationalNumber: phone?.nationalNumber || '',\n            countryCode: phone?.countryCode || '',\n        };\n\n        return {\n            id: Date.now(),\n            type: 'paypal-address',\n            firstName: profileName.firstName || firstName || '',\n            lastName: profileName.lastName || lastName || '',\n            company: address.company || '',\n            address1: address.addressLine1,\n            address2: address.addressLine2 || '',\n            city: address.adminArea2,\n            stateOrProvince: address.adminArea1,\n            stateOrProvinceCode: address.adminArea1,\n            country: address.countryCode || '', // TODO: update country with valid naming\n            countryCode: address.countryCode || '',\n            postalCode: address.postalCode,\n            phone: phoneData.countryCode + phoneData.nationalNumber,\n            customFields: customFields || [],\n        };\n    }\n\n    /**\n     *\n     * This method is responsible for filtering PayPal Fastlane addresses if they are the same\n     * and returns an array of addresses to use them for shipping and/or billing address selections\n     * so the customer will be able to use addresses from PayPal Fastlane in checkout flow\n     *\n     */\n    filterAddresses(addresses: Array<CustomerAddress | undefined>): CustomerAddress[] {\n        return addresses.reduce(\n            (customerAddresses: CustomerAddress[], currentAddress: CustomerAddress | undefined) => {\n                if (!currentAddress) {\n                    return customerAddresses;\n                }\n\n                const sameAddressInTheArray = customerAddresses.some((customerAddress) =>\n                    this.isEqualAddresses(customerAddress, currentAddress),\n                );\n\n                return sameAddressInTheArray\n                    ? customerAddresses\n                    : [...customerAddresses, currentAddress];\n            },\n            [],\n        );\n    }\n\n    private isEqualAddresses(\n        firstAddress: CustomerAddress,\n        secondAddress: CustomerAddress,\n    ): boolean {\n        return isEqual(this.normalizeAddress(firstAddress), this.normalizeAddress(secondAddress));\n    }\n\n    private normalizeAddress(address: CustomerAddress) {\n        return omit(address, ['id', 'phone']);\n    }\n}\n","import PaypalFastlaneUtils from './paypal-fastlane-utils';\n\nexport default function createPaypalFastlaneUtils(): PaypalFastlaneUtils {\n    return new PaypalFastlaneUtils();\n}\n","import HostedFieldType from './hosted-field-type';\nimport { HostedCardFieldOptionsMap, HostedStoredCardFieldOptionsMap } from './hosted-form-options';\n\nexport default function isCreditCardFormFields(\n    fields: HostedCardFieldOptionsMap | HostedStoredCardFieldOptionsMap,\n): fields is HostedCardFieldOptionsMap {\n    return (\n        HostedFieldType.CardNumber in fields &&\n        HostedFieldType.CardName in fields &&\n        HostedFieldType.CardExpiry in fields\n    );\n}\n","import HostedFieldType from './hosted-field-type';\nimport { HostedCardFieldOptionsMap, HostedStoredCardFieldOptionsMap } from './hosted-form-options';\n\nexport default function isCreditCardVaultedFormFields(\n    fields: HostedCardFieldOptionsMap | HostedStoredCardFieldOptionsMap,\n): fields is HostedStoredCardFieldOptionsMap {\n    return (\n        HostedFieldType.CardNumberVerification in fields &&\n        HostedFieldType.CardCodeVerification in fields &&\n        HostedFieldType.CardExpiryVerification in fields\n    );\n}\n","import StandardError from './standard-error';\n\n/**\n * This error should be thrown when a payment method experiences some kind of\n * failure (i.e.: its client library returns a rejected promise). And there is\n * no other error type that is more specific than this one.\n */\nexport default class PaymentMethodFailedError extends StandardError {\n    constructor(message?: string) {\n        super(\n            message ||\n                'Unable to proceed because the client library of a payment method has thrown an unexpected error.',\n        );\n\n        this.name = 'PaymentMethodFailedError';\n        this.type = 'payment_method_client_invalid';\n    }\n}\n","import StandardError from './standard-error';\n\nexport enum NotInitializedErrorType {\n    CheckoutButtonNotInitialized,\n    CustomerNotInitialized,\n    PaymentNotInitialized,\n    ShippingNotInitialized,\n    SpamProtectionNotInitialized,\n}\n\n/**\n * Throw this error if a method requires a certain initialization call to be\n * made first. Some objects can be constructed but they cannot be used until a\n * separate initialization call is made.\n */\nexport default class NotInitializedError extends StandardError {\n    constructor(public subtype: NotInitializedErrorType) {\n        super(getErrorMessage(subtype));\n\n        this.name = 'NotInitializedError';\n        this.type = 'not_initialized';\n    }\n}\n\nfunction getErrorMessage(type: NotInitializedErrorType): string {\n    switch (type) {\n        case NotInitializedErrorType.CustomerNotInitialized:\n            return 'Unable to proceed because the customer step of checkout has not been initialized.';\n\n        case NotInitializedErrorType.PaymentNotInitialized:\n            return 'Unable to proceed because the payment step of checkout has not been initialized.';\n\n        case NotInitializedErrorType.ShippingNotInitialized:\n            return 'Unable to proceed because the shipping step of checkout has not been initialized.';\n\n        case NotInitializedErrorType.SpamProtectionNotInitialized:\n            return 'Unable to proceed because the checkout spam protection has not been initialized.';\n\n        default:\n            return 'Unable to proceed because the required component has not been initialized.';\n    }\n}\n","import StandardError from './standard-error';\n\nexport interface PaymentInvalidFormErrorDetails {\n    [key: string]: Array<{ message: string; type: string }>;\n}\n\nexport default class PaymentInvalidFormError extends StandardError {\n    constructor(public details: PaymentInvalidFormErrorDetails, message?: string) {\n        super(message || 'Unable to proceed because the payment form contains invalid data.');\n\n        this.name = 'PaymentInvalidFormError';\n        this.type = 'payment_invalid_form';\n    }\n}\n","import { isNil, omitBy } from 'lodash';\n\nimport {\n    HostedCardFieldOptions,\n    HostedCardFieldOptionsMap,\n    HostedFieldBlurEventData,\n    HostedFieldEnterEventData,\n    HostedFieldFocusEventData,\n    HostedFieldStylesMap,\n    HostedFieldType,\n    HostedFieldValidateEventData,\n    HostedFormOptions,\n    HostedInputValidateErrorData,\n    HostedInputValidateErrorDataMap,\n    HostedInstrument,\n    HostedStoredCardFieldOptionsMap,\n    InvalidArgumentError,\n    isCreditCardFormFields,\n    isCreditCardVaultedFormFields,\n    isHostedInstrumentLike,\n    isVaultedInstrument,\n    NotInitializedError,\n    NotInitializedErrorType,\n    OrderFinalizationNotRequiredError,\n    OrderPaymentRequestBody,\n    OrderRequestBody,\n    Payment,\n    PaymentArgumentInvalidError,\n    PaymentInitializeOptions,\n    PaymentIntegrationService,\n    PaymentInvalidFormError,\n    PaymentInvalidFormErrorDetails,\n    PaymentMethodFailedError,\n    PaymentRequestOptions,\n    PaymentStrategy,\n    VaultedInstrument,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\nimport { isPayPalCommerceAcceleratedCheckoutCustomer } from '@bigcommerce/checkout-sdk/paypal-commerce-utils';\nimport {\n    PayPalFastlaneUtils,\n    PayPalInitializationData,\n    PayPalSdkScriptLoader,\n} from '@bigcommerce/checkout-sdk/paypal-utils';\n\nimport PayPalCommerceIntegrationService from '../paypal-commerce-integration-service';\nimport {\n    LiabilityShiftEnum,\n    PayPalCommerceCardFields,\n    PayPalCommerceCardFieldsConfig,\n    PayPalCommerceCardFieldsOnApproveData,\n    PayPalCommerceCardFieldsState,\n    PayPalCommerceFields,\n    PayPalCommerceHostedFieldsRenderOptions,\n} from '../paypal-commerce-types';\n\nimport PayPalCommerceCreditCardsPaymentInitializeOptions, {\n    WithPayPalCommerceCreditCardsPaymentInitializeOptions,\n} from './paypal-commerce-credit-cards-payment-initialize-options';\n\nexport default class PayPalCommerceCreditCardsPaymentStrategy implements PaymentStrategy {\n    private executionPaymentData?: OrderPaymentRequestBody['paymentData'];\n    private isCreditCardForm?: boolean;\n    private isCreditCardVaultedForm?: boolean;\n\n    private cardFields?: PayPalCommerceCardFields;\n    private cvvField?: PayPalCommerceFields;\n    private expiryField?: PayPalCommerceFields;\n    private numberField?: PayPalCommerceFields;\n    private nameField?: PayPalCommerceFields;\n\n    private hostedFormOptions?: HostedFormOptions;\n    private returnedOrderId?: string;\n    private returnedVaultedToken?: string;\n\n    constructor(\n        private paymentIntegrationService: PaymentIntegrationService,\n        private paypalCommerceIntegrationService: PayPalCommerceIntegrationService,\n        private paypalSdkScriptLoader: PayPalSdkScriptLoader,\n        private paypalFastlaneUtils: PayPalFastlaneUtils,\n    ) {}\n\n    async initialize(\n        options: PaymentInitializeOptions & WithPayPalCommerceCreditCardsPaymentInitializeOptions,\n    ): Promise<void> {\n        const { methodId, paypalcommercecreditcards, paypalcommerce } = options;\n        const paypalCommerceInitializationOptions = paypalcommercecreditcards || paypalcommerce;\n\n        const { form, onCreditCardFieldsRenderingError, onLoadComplete } =\n            paypalCommerceInitializationOptions || {};\n\n        if (!methodId) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.methodId\" argument is not provided.',\n            );\n        }\n\n        if (!form) {\n            throw new InvalidArgumentError(\n                'Unable to proceed because \"options.paypalcommercecreditcards.form\" argument is not provided.',\n            );\n        }\n\n        this.hostedFormOptions = form;\n\n        this.isCreditCardForm = isCreditCardFormFields(form.fields);\n        this.isCreditCardVaultedForm =\n            isCreditCardVaultedFormFields(form.fields) && !this.hasUndefinedValues();\n\n        await this.paymentIntegrationService.loadPaymentMethod(methodId);\n        await this.paypalCommerceIntegrationService.loadPayPalSdk(methodId, undefined, true, true);\n\n        if (this.isCreditCardForm || this.isCreditCardVaultedForm) {\n            await this.initializeFields(form, onCreditCardFieldsRenderingError);\n        }\n\n        onLoadComplete?.();\n\n        if (this.shouldInitializePayPalFastlane(methodId)) {\n            await this.initializePayPalFastlaneOrThrow(methodId);\n        }\n    }\n\n    async execute(payload: OrderRequestBody, options?: PaymentRequestOptions): Promise<void> {\n        const { payment, ...order } = payload;\n        const { methodId, paymentData } = payment || {};\n\n        if (!payment || !methodId) {\n            throw new PaymentArgumentInvalidError(['payment']);\n        }\n\n        this.executionPaymentData = paymentData;\n\n        if (this.isCreditCardForm || this.isCreditCardVaultedForm) {\n            await this.validateHostedFormOrThrow();\n            await this.submitHostedForm();\n        } else {\n            // This condition is triggered when we pay with vaulted instrument and shipping address is truste\n            const { orderId } = await this.paypalCommerceIntegrationService.createOrderCardFields(\n                'paypalcommercecreditcardscheckout',\n                this.getInstrumentParams(),\n            );\n\n            this.returnedOrderId = orderId;\n        }\n\n        const submitPaymentPayload = this.preparePaymentPayload(\n            methodId,\n            paymentData,\n            this.returnedOrderId,\n            this.returnedVaultedToken,\n        );\n\n        await this.paymentIntegrationService.submitOrder(order, options);\n        await this.paymentIntegrationService.submitPayment(submitPaymentPayload);\n    }\n\n    finalize(): Promise<void> {\n        return Promise.reject(new OrderFinalizationNotRequiredError());\n    }\n\n    async deinitialize(): Promise<void> {\n        await this.cvvField?.close();\n        await this.expiryField?.close();\n        await this.numberField?.close();\n        await this.nameField?.close();\n\n        return Promise.resolve();\n    }\n\n    /**\n     *\n     * Submit Payment Payload preparing method\n     *\n     * `vaultedToken` is used when we pay with vaulted instrument (with trusted shipping address and untrusted)\n     * `setupToken` is used when we pay with vaulted instrument (untrusted shipping address)\n     * `orderId` is used in every case (basic card payment, trusted shipping address and untrusted)\n     */\n    private preparePaymentPayload(\n        methodId: string,\n        paymentData: OrderPaymentRequestBody['paymentData'],\n        orderId?: string,\n        nonce?: string,\n    ): Payment {\n        const { shouldSaveInstrument = false, shouldSetAsDefaultInstrument = false } =\n            isHostedInstrumentLike(paymentData) ? paymentData : {};\n\n        const instrumentId =\n            paymentData && isVaultedInstrument(paymentData) ? paymentData.instrumentId : undefined;\n\n        const bigpay_token = omitBy(\n            {\n                verification_nonce: nonce,\n                token: instrumentId,\n            },\n            isNil,\n        );\n\n        return {\n            methodId,\n            paymentData: {\n                shouldSaveInstrument,\n                shouldSetAsDefaultInstrument,\n                instrumentId,\n                formattedPayload: {\n                    ...(nonce || instrumentId ? { bigpay_token } : {}),\n                    ...(orderId ? { card_with_order: { order_id: orderId } } : {}),\n                },\n            },\n        };\n    }\n\n    /**\n     *\n     * Card fields initialize\n     *\n     */\n    private async initializeFields(\n        formOptions: HostedFormOptions,\n        onCreditCardFieldsRenderingError?: PayPalCommerceCreditCardsPaymentInitializeOptions['onCreditCardFieldsRenderingError'],\n    ): Promise<void> {\n        const { fields, styles } = formOptions;\n\n        const paypalSdk = this.paypalCommerceIntegrationService.getPayPalSdkOrThrow();\n        const executeCallback = this.getExecuteCallback(fields);\n\n        const cardFieldsConfig: PayPalCommerceCardFieldsConfig = {\n            style: this.getInputStyles(styles),\n            onApprove: ({\n                orderID,\n                vaultSetupToken,\n                liabilityShift,\n            }: PayPalCommerceCardFieldsOnApproveData) => {\n                if (\n                    liabilityShift === LiabilityShiftEnum.No ||\n                    liabilityShift === LiabilityShiftEnum.Unknown\n                ) {\n                    throw new Error();\n                }\n\n                return this.handleApprove({ orderID, vaultSetupToken });\n            },\n            onError: () => {\n                throw new PaymentMethodFailedError();\n            },\n            inputEvents: {\n                onChange: (event) => this.onChangeHandler(formOptions, event),\n                onFocus: (event) => this.onFocusHandler(formOptions, event),\n                onBlur: (event) => this.onBlurHandler(formOptions, event),\n                onInputSubmitRequest: (event) => this.onInputSubmitRequest(formOptions, event),\n            },\n            ...executeCallback,\n        };\n\n        this.cardFields = await paypalSdk.CardFields(cardFieldsConfig);\n\n        if (!this.cardFields.isEligible()) {\n            throw new NotInitializedError(NotInitializedErrorType.PaymentNotInitialized);\n        }\n\n        try {\n            this.stylizeInputContainers(fields);\n\n            if (isCreditCardFormFields(fields)) {\n                await this.renderFields(fields);\n            }\n\n            if (isCreditCardVaultedFormFields(fields)) {\n                await this.renderVaultedFields(fields);\n            }\n        } catch (error: unknown) {\n            if (typeof onCreditCardFieldsRenderingError === 'function') {\n                onCreditCardFieldsRenderingError(error);\n            }\n        }\n    }\n\n    /**\n     *\n     * Get execute callback method\n     * Depends on shipping address is trusted or not we should pass to PP\n     * `createVaultSetupToken` callback if address is untrusted or\n     * `createOrder` if address is trusted\n     *\n     */\n    private getExecuteCallback(\n        fields: HostedCardFieldOptionsMap | HostedStoredCardFieldOptionsMap,\n    ) {\n        const isVaultedForm = isCreditCardVaultedFormFields(fields);\n\n        return isVaultedForm ? this.createVaultSetupTokenCallback() : this.createOrderCallback();\n    }\n\n    private createVaultSetupTokenCallback() {\n        return {\n            createVaultSetupToken: async () => {\n                const { setupToken } =\n                    (await this.paypalCommerceIntegrationService.createOrderCardFields(\n                        'paypalcommercecreditcardscheckout',\n                        {\n                            ...this.getInstrumentParams(),\n                            setupToken: true,\n                        },\n                    )) || {};\n\n                return setupToken;\n            },\n        };\n    }\n\n    private createOrderCallback() {\n        return {\n            createOrder: async () => {\n                const { orderId } =\n                    (await this.paypalCommerceIntegrationService.createOrderCardFields(\n                        'paypalcommercecreditcardscheckout',\n                        this.getInstrumentParams(),\n                    )) || {};\n\n                return orderId;\n            },\n        };\n    }\n\n    /**\n     *\n     * onApprove method\n     * When submitting a form with a `submitHostedForm` method if there is no error\n     * then onApprove callback is triggered and depends on the flow\n     * we will receive an `orderID` if it's basic paying and `vaultSetupToken` if we are paying\n     * with vaulted instrument and shipping address is untrusted\n     *\n     */\n    private handleApprove({ orderID, vaultSetupToken }: PayPalCommerceCardFieldsOnApproveData) {\n        if (orderID) {\n            this.returnedOrderId = orderID;\n        }\n\n        if (vaultSetupToken) {\n            this.returnedVaultedToken = vaultSetupToken;\n        }\n    }\n\n    /**\n     *\n     * Rendering Card Fields methods\n     *\n     */\n    private async renderFields(fieldsOptions: HostedCardFieldOptionsMap) {\n        const cardFields = this.getCardFieldsOrThrow();\n\n        if (fieldsOptions.cardCode?.containerId) {\n            this.cvvField = cardFields.CVVField({\n                placeholder: '',\n            });\n            await this.cvvField.render(`#${fieldsOptions.cardCode.containerId}`);\n        }\n\n        if (fieldsOptions.cardExpiry?.containerId) {\n            this.expiryField = cardFields.ExpiryField();\n            await this.expiryField.render(`#${fieldsOptions.cardExpiry.containerId}`);\n        }\n\n        if (fieldsOptions.cardName?.containerId) {\n            this.nameField = cardFields.NameField({\n                placeholder: '',\n            });\n            await this.nameField.render(`#${fieldsOptions.cardName.containerId}`);\n        }\n\n        if (fieldsOptions.cardNumber?.containerId) {\n            this.numberField = cardFields.NumberField({\n                placeholder: '',\n            });\n            await this.numberField.render(`#${fieldsOptions.cardNumber.containerId}`);\n        }\n    }\n\n    private async renderVaultedFields(fieldsOptions: HostedStoredCardFieldOptionsMap) {\n        const cardFields = this.getCardFieldsOrThrow();\n\n        if (fieldsOptions.cardCodeVerification?.containerId) {\n            this.cvvField = cardFields.CVVField({\n                placeholder: '',\n            });\n            await this.cvvField.render(`#${fieldsOptions.cardCodeVerification.containerId}`);\n        }\n\n        if (fieldsOptions.cardExpiryVerification?.containerId) {\n            this.expiryField = cardFields.ExpiryField();\n            await this.expiryField.render(`#${fieldsOptions.cardExpiryVerification.containerId}`);\n        }\n\n        if (fieldsOptions.cardNumberVerification?.containerId) {\n            this.numberField = cardFields.NumberField({\n                placeholder: '',\n            });\n            await this.numberField.render(`#${fieldsOptions.cardNumberVerification.containerId}`);\n        }\n    }\n\n    /**\n     *\n     * Instrument params method\n     *\n     */\n    private getInstrumentParams(): HostedInstrument | VaultedInstrument {\n        if (!this.executionPaymentData) {\n            return {};\n        }\n\n        if (isHostedInstrumentLike(this.executionPaymentData)) {\n            const { shouldSaveInstrument, shouldSetAsDefaultInstrument } =\n                this.executionPaymentData;\n\n            return {\n                shouldSaveInstrument,\n                shouldSetAsDefaultInstrument,\n            };\n        }\n\n        if (isVaultedInstrument(this.executionPaymentData)) {\n            const { instrumentId } = this.executionPaymentData;\n\n            return {\n                instrumentId,\n            };\n        }\n\n        return {};\n    }\n\n    private getFieldTypeByEmittedField({\n        emittedBy,\n    }: PayPalCommerceCardFieldsState):\n        | HostedFieldBlurEventData\n        | HostedFieldEnterEventData\n        | HostedFieldFocusEventData {\n        return {\n            fieldType: this.mapFieldType(emittedBy),\n        };\n    }\n\n    /**\n     *\n     * Form submit method\n     * Triggers a form submit\n     * */\n    private async submitHostedForm() {\n        const cardFields = this.getCardFieldsOrThrow();\n        const state = this.paymentIntegrationService.getState();\n        const billingAddress = state.getBillingAddressOrThrow();\n\n        const submitConfig = {\n            billingAddress: {\n                company: billingAddress.company,\n                addressLine1: billingAddress.address1,\n                addressLine2: billingAddress.address2,\n                adminArea1: billingAddress.stateOrProvinceCode,\n                adminArea2: billingAddress.city,\n                postalCode: billingAddress.postalCode,\n                countryCode: billingAddress.countryCode,\n            },\n        };\n\n        try {\n            if (this.isCreditCardVaultedForm) {\n                await cardFields.submit();\n            } else {\n                await cardFields.submit(submitConfig);\n            }\n        } catch (_) {\n            throw new PaymentMethodFailedError(\n                'Failed authentication. Please try to authorize again.',\n            );\n        }\n    }\n\n    /**\n     *\n     * Validation and errors\n     *\n     */\n    private async validateHostedFormOrThrow() {\n        const cardFields = this.getCardFieldsOrThrow();\n        const cardFieldsState = await cardFields.getState().then((data) => data);\n        const validationData = this.getValidityData(cardFieldsState);\n\n        if (validationData.isValid) {\n            return;\n        }\n\n        this.hostedFormOptions?.onValidate?.(validationData);\n\n        throw new PaymentInvalidFormError(this.mapValidationErrors(validationData.errors));\n    }\n\n    private getValidityData({\n        fields,\n    }: PayPalCommerceCardFieldsState): HostedFieldValidateEventData {\n        const updatedFields = { ...fields };\n\n        delete updatedFields.cardNameField;\n\n        const fieldsKeys = Object.keys(updatedFields) as Array<\n            keyof PayPalCommerceCardFieldsState['fields']\n        >;\n\n        const isValid = fieldsKeys.every((key) => updatedFields[key]?.isValid);\n\n        const errors = fieldsKeys.reduce((fieldsErrors, key) => {\n            const fieldType = this.mapFieldType(key);\n\n            return {\n                ...fieldsErrors,\n                [fieldType]: updatedFields[key]?.isValid\n                    ? undefined\n                    : [this.getInvalidErrorByFieldType(fieldType)],\n            };\n        }, {});\n\n        return { isValid, errors };\n    }\n\n    private getInvalidErrorByFieldType(fieldType: string): HostedInputValidateErrorData {\n        switch (fieldType) {\n            case HostedFieldType.CardCode:\n            case HostedFieldType.CardCodeVerification:\n                return {\n                    fieldType,\n                    message: 'Invalid card code',\n                    type: 'invalid_card_code',\n                };\n\n            case HostedFieldType.CardNumber:\n            case HostedFieldType.CardNumberVerification:\n                return {\n                    fieldType,\n                    message: 'Invalid card number',\n                    type: 'invalid_card_number',\n                };\n\n            case HostedFieldType.CardExpiry:\n            case HostedFieldType.CardExpiryVerification:\n                return {\n                    fieldType,\n                    message: 'Invalid card expiry',\n                    type: 'invalid_card_expiry',\n                };\n\n            default:\n                return {\n                    fieldType,\n                    message: 'Invalid field',\n                    type: 'invalid',\n                };\n        }\n    }\n\n    private mapValidationErrors(\n        validationErrors: HostedInputValidateErrorDataMap = {},\n    ): PaymentInvalidFormErrorDetails {\n        const errors: PaymentInvalidFormErrorDetails = {};\n        const validationErrorsKeys = Object.keys(validationErrors) as Array<\n            keyof HostedInputValidateErrorDataMap\n        >;\n\n        validationErrorsKeys.forEach((key) => {\n            errors[key] = [\n                {\n                    message: validationErrors[key]?.[0]?.message || '',\n                    type: key,\n                },\n            ];\n        });\n\n        return errors;\n    }\n\n    /**\n     *\n     * Fields mappers\n     *\n     */\n    private mapFieldType(type: string): HostedFieldType {\n        switch (type) {\n            case 'name':\n                return HostedFieldType.CardName;\n\n            case 'cardNumberField':\n            case 'number':\n                return this.isCreditCardForm\n                    ? HostedFieldType.CardNumber\n                    : HostedFieldType.CardNumberVerification;\n\n            case 'cardExpiryField':\n            case 'expiry':\n                return this.isCreditCardForm\n                    ? HostedFieldType.CardExpiry\n                    : HostedFieldType.CardExpiryVerification;\n\n            case 'cardCvvField':\n            case 'cvv':\n                return this.isCreditCardForm\n                    ? HostedFieldType.CardCode\n                    : HostedFieldType.CardCodeVerification;\n\n            default:\n                throw new Error('Unexpected field type');\n        }\n    }\n\n    /**\n     *\n     * Utils\n     *\n     */\n    private getCardFieldsOrThrow(): PayPalCommerceCardFields {\n        if (!this.cardFields) {\n            throw new NotInitializedError(NotInitializedErrorType.PaymentNotInitialized);\n        }\n\n        return this.cardFields;\n    }\n\n    private getInputStyles(\n        styles?: HostedFieldStylesMap,\n    ): PayPalCommerceHostedFieldsRenderOptions['styles'] {\n        const commonStyles = {\n            'font-size': styles?.default?.fontSize || '1rem',\n            'font-family':\n                styles?.default?.fontFamily || 'Montserrat, Arial, Helvetica, sans-serif',\n            'font-weight': styles?.default?.fontWeight || '400',\n            outline: 'none',\n            padding: '9px 13px',\n        };\n\n        const defaultStyles = { ...commonStyles, color: '#333333' };\n        const errorStyles = { ...commonStyles, color: 'red' };\n\n        return {\n            input: defaultStyles,\n            '.invalid': errorStyles,\n            '.valid': defaultStyles,\n            ':focus': defaultStyles,\n        };\n    }\n\n    private stylizeInputContainers(\n        fields: HostedCardFieldOptionsMap | HostedStoredCardFieldOptionsMap,\n    ): void {\n        Object.values(fields || {}).forEach((id: HostedCardFieldOptions) => {\n            const element = document.getElementById(`${id?.containerId || ''}`);\n\n            if (element) {\n                element.style.padding = '0px';\n                element.style.boxShadow = 'none';\n                element.style.border = 'none';\n                element.style.background = 'transparent';\n                element.style.marginBottom = '10px';\n                element.style.marginLeft = '-5px';\n            }\n        });\n    }\n\n    private hasUndefinedValues() {\n        if (this.hostedFormOptions) {\n            return Object.values(this.hostedFormOptions.fields).some(\n                (value) => value === undefined,\n            );\n        }\n\n        return true;\n    }\n\n    /**\n     *\n     * Input events methods\n     *\n     */\n    private onChangeHandler(\n        formOptions: HostedFormOptions,\n        event: PayPalCommerceCardFieldsState,\n    ): void {\n        formOptions?.onValidate?.(this.getValidityData(event));\n    }\n\n    private onFocusHandler(\n        formOptions: HostedFormOptions,\n        event: PayPalCommerceCardFieldsState,\n    ): void {\n        formOptions?.onFocus?.(this.getFieldTypeByEmittedField(event));\n    }\n\n    private onBlurHandler(\n        formOptions: HostedFormOptions,\n        event: PayPalCommerceCardFieldsState,\n    ): void {\n        formOptions?.onBlur?.(this.getFieldTypeByEmittedField(event));\n    }\n\n    private onInputSubmitRequest(\n        formOptions: HostedFormOptions,\n        event: PayPalCommerceCardFieldsState,\n    ): void {\n        formOptions?.onEnter?.(this.getFieldTypeByEmittedField(event));\n    }\n\n    /**\n     *\n     * PayPal Commerce Accelerated checkout related methods\n     *\n     */\n    // TODO: remove this part when PPCP AXO A/B testing will be finished\n    private shouldInitializePayPalFastlane(methodId: string) {\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod = state.getPaymentMethodOrThrow<PayPalInitializationData>(methodId);\n        const paymentProviderCustomer = state.getPaymentProviderCustomer();\n        const paypalCommercePaymentProviderCustomer = isPayPalCommerceAcceleratedCheckoutCustomer(\n            paymentProviderCustomer,\n        )\n            ? paymentProviderCustomer\n            : {};\n\n        return (\n            paymentMethod?.initializationData?.isAcceleratedCheckoutEnabled &&\n            paymentMethod?.initializationData?.isPayPalCommerceAnalyticsV2Enabled &&\n            !paypalCommercePaymentProviderCustomer?.authenticationState\n        );\n    }\n\n    // TODO: remove this part when PPCP AXO A/B testing will be finished\n    private async initializePayPalFastlaneOrThrow(methodId: string): Promise<void> {\n        try {\n            const state = this.paymentIntegrationService.getState();\n            const cart = state.getCartOrThrow();\n            const paymentMethod = state.getPaymentMethodOrThrow<PayPalInitializationData>(methodId);\n            const { initializationData } = paymentMethod;\n\n            if (!initializationData?.connectClientToken) {\n                return;\n            }\n\n            const payPalFastlaneSdk = await this.paypalSdkScriptLoader.getPayPalFastlaneSdk(\n                paymentMethod,\n                cart.currency.code,\n                cart.id,\n            );\n\n            await this.paypalFastlaneUtils.initializePayPalFastlane(\n                payPalFastlaneSdk,\n                !!initializationData?.isDeveloperModeApplicable,\n            );\n        } catch (_: unknown) {\n            // We should avoid throwing any error from this flow to do no brake default flow\n            // This flow is optional\n        }\n    }\n}\n","import {\n    PaymentProviderCustomer,\n    PayPalConnectCustomer,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nexport default function isPayPalCommerceAcceleratedCheckoutCustomer(\n    customer?: PaymentProviderCustomer,\n): customer is PayPalConnectCustomer {\n    if (!customer) {\n        return false;\n    }\n\n    return (\n        'authenticationState' in customer || 'addresses' in customer || 'instruments' in customer\n    );\n}\n","import {\n    PaymentStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\nimport {\n    createPayPalFastlaneUtils,\n    createPayPalSdkScriptLoader,\n} from '@bigcommerce/checkout-sdk/paypal-utils';\n\nimport createPayPalCommerceIntegrationService from '../create-paypal-commerce-integration-service';\n\nimport PayPalCommerceCreditCardsPaymentStrategy from './paypal-commerce-credit-cards-payment-strategy';\n\nconst createPaypalCommerceCreditCardsPaymentStrategy: PaymentStrategyFactory<\n    PayPalCommerceCreditCardsPaymentStrategy\n> = (paymentIntegrationService) =>\n    new PayPalCommerceCreditCardsPaymentStrategy(\n        paymentIntegrationService,\n        createPayPalCommerceIntegrationService(paymentIntegrationService),\n        createPayPalSdkScriptLoader(),\n        createPayPalFastlaneUtils(),\n    );\n\nexport default toResolvableModule(createPaypalCommerceCreditCardsPaymentStrategy, [\n    { id: 'paypalcommercecreditcards' },\n]);\n","import { noop } from 'lodash';\n\nimport {\n    InvalidArgumentError,\n    OrderFinalizationNotRequiredError,\n    OrderRequestBody,\n    PaymentArgumentInvalidError,\n    PaymentInitializeOptions,\n    PaymentIntegrationService,\n    PaymentRequestOptions,\n    PaymentStrategy,\n    TimeoutError,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\nimport { LoadingIndicator } from '@bigcommerce/checkout-sdk/ui';\n\nimport PayPalCommerceIntegrationService from '../paypal-commerce-integration-service';\nimport {\n    BirthDate,\n    PayPalCommerceInitializationData,\n    PayPalOrderStatus,\n} from '../paypal-commerce-types';\n\nimport {\n    PaypalCommerceRatePay,\n    WithPayPalCommerceRatePayPaymentInitializeOptions,\n} from './paypal-commerce-ratepay-initialize-options';\n\nconst POLLING_INTERVAL = 3000;\nconst MAX_POLLING_TIME = 300000;\n\nexport default class PaypalCommerceRatepayPaymentStrategy implements PaymentStrategy {\n    private guid?: string;\n    private paypalcommerceratepay?: PaypalCommerceRatePay;\n    private loadingIndicatorContainer?: string;\n    private pollingTimer = 0;\n    private stopPolling = noop;\n\n    constructor(\n        private paymentIntegrationService: PaymentIntegrationService,\n        private paypalCommerceIntegrationService: PayPalCommerceIntegrationService,\n        private loadingIndicator: LoadingIndicator,\n        private pollingInterval: number = POLLING_INTERVAL,\n        private maxPollingIntervalTime: number = MAX_POLLING_TIME,\n    ) {}\n\n    async initialize(\n        options: PaymentInitializeOptions & WithPayPalCommerceRatePayPaymentInitializeOptions,\n    ): Promise<void> {\n        const { gatewayId, methodId, paypalcommerceratepay } = options;\n\n        if (!methodId) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.methodId\" argument is not provided.',\n            );\n        }\n\n        if (!gatewayId) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.gatewayId\" argument is not provided.',\n            );\n        }\n\n        if (!paypalcommerceratepay) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.paypalcommerceratepay\" argument is not provided.`,\n            );\n        }\n\n        const { legalTextContainer, container, loadingContainerId } = paypalcommerceratepay;\n\n        if (!container) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.container\" argument is not provided.`,\n            );\n        }\n\n        if (!legalTextContainer) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.legalTextContainer\" argument is not provided.`,\n            );\n        }\n\n        if (!loadingContainerId) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.loadingContainerId\" argument is not provided.`,\n            );\n        }\n\n        this.loadingIndicatorContainer = loadingContainerId;\n\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod = state.getPaymentMethodOrThrow<PayPalCommerceInitializationData>(\n            methodId,\n            gatewayId,\n        );\n        const { merchantId } = paymentMethod.initializationData || {};\n\n        if (!merchantId) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because merchantId argument is not provided.`,\n            );\n        }\n\n        this.paypalcommerceratepay = paypalcommerceratepay;\n\n        await this.paypalCommerceIntegrationService.loadPayPalSdk(methodId);\n\n        this.createFraudNetScript(merchantId, methodId, gatewayId);\n\n        this.loadFraudnetConfig();\n\n        this.renderLegalText(legalTextContainer, container);\n    }\n\n    async execute(payload: OrderRequestBody, options?: PaymentRequestOptions): Promise<void> {\n        const { payment, ...order } = payload;\n\n        const { getFieldsValues } = this.paypalcommerceratepay || {};\n\n        if (!payment) {\n            throw new PaymentArgumentInvalidError(['payment']);\n        }\n\n        if (!getFieldsValues || typeof getFieldsValues !== 'function') {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.getFieldsValues\" argument is not provided.`,\n            );\n        }\n\n        this.toggleLoadingIndicator(true);\n\n        try {\n            const orderId = await this.paypalCommerceIntegrationService.createOrder(\n                'paypalcommercealternativemethodscheckout',\n                { metadataId: this.guid },\n            );\n\n            const { ratepayBirthDate, ratepayPhoneNumber, ratepayPhoneCountryCode } =\n                getFieldsValues();\n\n            const paymentData = {\n                formattedPayload: {\n                    vault_payment_instrument: null,\n                    set_as_default_stored_instrument: null,\n                    device_info: null,\n                    method_id: payment.methodId,\n                    rate_pay: {\n                        birth_date: this.normalizeDate(ratepayBirthDate),\n                        phone: {\n                            national_number: ratepayPhoneNumber,\n                            country_code: ratepayPhoneCountryCode.split('+')[1],\n                        },\n                    },\n                    paypal_account: {\n                        order_id: orderId,\n                    },\n                },\n            };\n\n            await this.paymentIntegrationService.submitOrder(order, options);\n            await this.paymentIntegrationService.submitPayment({\n                methodId: payment.methodId,\n                paymentData,\n            });\n\n            return await new Promise((resolve, reject) => {\n                this.initializePollingMechanism(\n                    payment.methodId,\n                    resolve,\n                    reject,\n                    payment.gatewayId,\n                );\n            });\n        } catch (error: unknown) {\n            this.handleError(error);\n\n            return new Promise((_resolve, reject) => reject());\n        }\n    }\n\n    finalize(): Promise<void> {\n        return Promise.reject(new OrderFinalizationNotRequiredError());\n    }\n\n    deinitialize(): Promise<void> {\n        const { legalTextContainer } = this.paypalcommerceratepay || {};\n        const fraudNetScript = document.querySelectorAll('[data-id=\"fraudnetScript\"]')[0];\n        const fraudNetConfig = document.querySelectorAll('[data-id=\"fraudnetConfig\"]')[0];\n\n        this.deinitializePollingMechanism();\n\n        fraudNetScript.remove();\n        fraudNetConfig.remove();\n\n        if (legalTextContainer) {\n            const legalTextContainerElement = document.getElementById(legalTextContainer);\n\n            legalTextContainerElement?.remove();\n        }\n\n        return Promise.resolve();\n    }\n\n    private normalizeDate(date: BirthDate) {\n        const formattedDate = this.formatDate(date.getDate());\n        const formattedMonth = this.formatDate(date.getMonth() + 1);\n\n        return `${date.getFullYear()}-${formattedMonth}-${formattedDate}`;\n    }\n\n    private formatDate(date: number): string {\n        return `${date < 10 ? 0 : ''}${date}`;\n    }\n\n    private renderLegalText(legalTextContainerElementId: string, container: string) {\n        const legalTextContainerId = legalTextContainerElementId;\n        const buttonContainerId = container.split('#')[1];\n        const buttonContainer = document.getElementById(buttonContainerId);\n        const buttonContainerParent = buttonContainer?.parentNode;\n        const legalTextContainer = document.createElement('div');\n\n        legalTextContainer.style.marginBottom = '20px';\n        legalTextContainer.setAttribute('id', legalTextContainerId);\n        buttonContainerParent?.prepend(legalTextContainer);\n\n        const paypalSdk = this.paypalCommerceIntegrationService.getPayPalSdkOrThrow();\n        const ratePayButton = paypalSdk.Legal({\n            fundingSource: paypalSdk.Legal.FUNDING.PAY_UPON_INVOICE,\n        });\n        const legalTextContainerElement = document.getElementById(legalTextContainerId);\n\n        if (legalTextContainerElement) {\n            ratePayButton.render(`#${legalTextContainerId}`);\n        } else {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"legalTextContainerElement\" argument is not found.`,\n            );\n        }\n    }\n\n    private handleError(error: unknown): void {\n        const { onError } = this.paypalcommerceratepay || {};\n\n        this.resetPollingMechanism();\n        this.toggleLoadingIndicator(false);\n\n        if (onError && typeof onError === 'function') {\n            onError(error);\n        }\n    }\n\n    private createFraudNetScript(merchantId: string, methodId: string, gatewayId: string) {\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod = state.getPaymentMethodOrThrow(methodId, gatewayId);\n        const { testMode } = paymentMethod.config;\n        const scriptElement = document.createElement('script');\n\n        scriptElement.setAttribute('type', 'application/json');\n        scriptElement.setAttribute('fncls', 'fnparams-dede7cc5-15fd-4c75-a9f4-36c430ee3a99');\n        scriptElement.setAttribute('data-id', 'fraudnetScript');\n        this.guid = this.generateGUID();\n\n        const fraudNetConfig = {\n            f: this.guid,\n            s: `${merchantId}_checkout-page`,\n            sandbox: testMode,\n        };\n\n        scriptElement.innerHTML = JSON.stringify(fraudNetConfig);\n        document.body.appendChild(scriptElement);\n    }\n\n    private generateGUID() {\n        let guid = '';\n        const characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n\n        for (let i = 0; i < 32; i += 1) {\n            const randomIndex = Math.floor(Math.random() * characters.length);\n\n            guid += characters[randomIndex];\n        }\n\n        return guid;\n    }\n\n    private loadFraudnetConfig() {\n        const script = document.createElement('script');\n\n        script.setAttribute('data-id', 'fraudnetConfig');\n        script.src = 'https://c.paypal.com/da/r/fb.js';\n        document.body.appendChild(script);\n    }\n\n    private async reinitializeStrategy(\n        options: PaymentInitializeOptions & WithPayPalCommerceRatePayPaymentInitializeOptions,\n    ): Promise<void> {\n        await this.deinitialize();\n        await this.initialize(options);\n    }\n\n    /**\n     *\n     * Polling mechanism\n     *\n     *\n     * */\n    private async initializePollingMechanism(\n        methodId: string,\n        resolvePromise: () => void,\n        rejectPromise: () => void,\n        gatewayId?: string,\n    ): Promise<void> {\n        await new Promise<void>((resolve, reject) => {\n            const timeout = setTimeout(resolve, this.pollingInterval);\n\n            this.stopPolling = () => {\n                clearTimeout(timeout);\n                this.toggleLoadingIndicator(false);\n\n                return reject();\n            };\n        });\n\n        try {\n            this.pollingTimer += this.pollingInterval;\n\n            const orderStatus = await this.paypalCommerceIntegrationService.getOrderStatus(\n                'paypalcommercealternativemethods',\n                {\n                    params: {\n                        useMetadata: true,\n                    },\n                },\n            );\n\n            const isOrderApproved = orderStatus === PayPalOrderStatus.PollingStop;\n            const isPollingError = orderStatus === PayPalOrderStatus.PollingError;\n\n            if (isOrderApproved) {\n                this.deinitializePollingMechanism();\n\n                return resolvePromise();\n            }\n\n            if (isPollingError) {\n                return rejectPromise();\n            }\n\n            if (!isOrderApproved && this.pollingTimer < this.maxPollingIntervalTime) {\n                return await this.initializePollingMechanism(\n                    methodId,\n                    resolvePromise,\n                    rejectPromise,\n                    gatewayId,\n                );\n            }\n\n            await this.reinitializeStrategy({\n                methodId,\n                gatewayId,\n                paypalcommerceratepay: this.paypalcommerceratepay,\n            });\n\n            this.handleError(new TimeoutError());\n        } catch (error) {\n            this.handleError(error);\n            rejectPromise();\n        }\n    }\n\n    private deinitializePollingMechanism(): void {\n        this.stopPolling();\n        this.pollingTimer = 0;\n    }\n\n    private resetPollingMechanism(): void {\n        this.deinitializePollingMechanism();\n    }\n\n    /**\n     *\n     * Loading Indicator methods\n     *\n     * */\n    private toggleLoadingIndicator(isLoading: boolean): void {\n        if (isLoading && this.loadingIndicatorContainer) {\n            this.loadingIndicator.show(this.loadingIndicatorContainer);\n        } else {\n            this.loadingIndicator.hide();\n        }\n    }\n}\n","import {\n    PaymentStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\nimport { LoadingIndicator } from '@bigcommerce/checkout-sdk/ui';\n\nimport createPayPalCommerceIntegrationService from '../create-paypal-commerce-integration-service';\nimport { LOADING_INDICATOR_STYLES } from '../paypal-commerce-constants';\n\nimport PaypalCommerceRatepayPaymentStrategy from './paypal-commerce-ratepay-payment-strategy';\n\nconst createPaypalCommerceRatepayPaymentStrategy: PaymentStrategyFactory<\n    PaypalCommerceRatepayPaymentStrategy\n> = (paymentIntegrationService) =>\n    new PaypalCommerceRatepayPaymentStrategy(\n        paymentIntegrationService,\n        createPayPalCommerceIntegrationService(paymentIntegrationService),\n        new LoadingIndicator({\n            containerStyles: { ...LOADING_INDICATOR_STYLES, position: 'fixed' },\n        }),\n    );\n\nexport default toResolvableModule(createPaypalCommerceRatepayPaymentStrategy, [\n    { gateway: 'paypalcommercealternativemethods', id: 'ratepay' },\n]);\n","import { omitBy } from 'lodash';\n\nimport { FastlaneStylesSettings, PayPalFastlaneStylesOption } from '../index';\n\nfunction isInvalidStyleOption(styleOption: unknown) {\n    return typeof styleOption !== 'string';\n}\n\nexport default function getFastlaneStyles(\n    styleSettings?: FastlaneStylesSettings,\n    uiStyles?: PayPalFastlaneStylesOption,\n) {\n    if (!uiStyles && !styleSettings) {\n        return undefined;\n    }\n\n    return cleanUpFastlaneStyles(mergeFastlaneStyles(styleSettings, uiStyles));\n}\n\nfunction mergeFastlaneStyles(\n    styleSettings?: FastlaneStylesSettings,\n    uiStyles?: PayPalFastlaneStylesOption,\n): PayPalFastlaneStylesOption {\n    return {\n        root: {\n            backgroundColorPrimary:\n                styleSettings?.fastlaneRootSettingsBackgroundColor ||\n                uiStyles?.root?.backgroundColorPrimary,\n            errorColor: styleSettings?.fastlaneRootSettingsErrorColor || uiStyles?.root?.errorColor,\n            fontFamily: styleSettings?.fastlaneRootSettingsFontFamily || uiStyles?.root?.fontFamily,\n            fontSizeBase:\n                styleSettings?.fastlaneRootSettingsFontSize || uiStyles?.root?.fontSizeBase,\n            padding: styleSettings?.fastlaneRootSettingsPadding || uiStyles?.root?.padding,\n            primaryColor:\n                styleSettings?.fastlaneRootSettingsPrimaryColor || uiStyles?.root?.primaryColor,\n        },\n        input: {\n            borderRadius:\n                styleSettings?.fastlaneInputSettingsBorderRadius || uiStyles?.input?.borderRadius,\n            borderColor:\n                styleSettings?.fastlaneInputSettingsBorderColor || uiStyles?.input?.borderColor,\n            focusBorderColor:\n                styleSettings?.fastlaneInputSettingsFocusBorderBase ||\n                uiStyles?.input?.focusBorderColor,\n            backgroundColor:\n                styleSettings?.fastlaneInputSettingsBackgroundColor ||\n                uiStyles?.input?.backgroundColor,\n            borderWidth:\n                styleSettings?.fastlaneInputSettingsBorderWidth || uiStyles?.input?.borderWidth,\n            textColorBase:\n                styleSettings?.fastlaneInputSettingsTextColorBase || uiStyles?.input?.textColorBase,\n        },\n        toggle: {\n            colorPrimary:\n                styleSettings?.fastlaneToggleSettingsColorPrimary || uiStyles?.toggle?.colorPrimary,\n            colorSecondary:\n                styleSettings?.fastlaneToggleSettingsColorSecondary ||\n                uiStyles?.toggle?.colorSecondary,\n        },\n        text: {\n            body: {\n                color: styleSettings?.fastlaneTextBodySettingsColor || uiStyles?.text?.body?.color,\n                fontSize:\n                    styleSettings?.fastlaneTextBodySettingsFontSize ||\n                    uiStyles?.text?.body?.fontSize,\n            },\n            caption: {\n                color:\n                    styleSettings?.fastlaneTextCaptionSettingsColor ||\n                    uiStyles?.text?.caption?.color,\n                fontSize:\n                    styleSettings?.fastlaneTextCaptionSettingsFontSize ||\n                    uiStyles?.text?.caption?.fontSize,\n            },\n        },\n        branding: styleSettings?.fastlaneBrandingSettings || uiStyles?.branding,\n    };\n}\n\nfunction cleanUpFastlaneStyles(styles: PayPalFastlaneStylesOption) {\n    const fastlaneStyles: PayPalFastlaneStylesOption = {};\n\n    const root = omitBy(styles.root, isInvalidStyleOption);\n    const input = omitBy(styles.input, isInvalidStyleOption);\n    const toggle = omitBy(styles.toggle, isInvalidStyleOption);\n    const textBody = omitBy(styles.text?.body, isInvalidStyleOption);\n    const textCaption = omitBy(styles.text?.caption, isInvalidStyleOption);\n    const branding = styles.branding;\n\n    if (Object.keys(root).length) {\n        fastlaneStyles.root = root;\n    }\n\n    if (Object.keys(input).length) {\n        fastlaneStyles.input = input;\n    }\n\n    if (Object.keys(toggle).length) {\n        fastlaneStyles.toggle = toggle;\n    }\n\n    if (Object.keys(textBody).length) {\n        fastlaneStyles.text = {};\n        fastlaneStyles.text.body = textBody;\n    }\n\n    if (Object.keys(textCaption).length) {\n        fastlaneStyles.text = {\n            ...fastlaneStyles.text,\n        };\n        fastlaneStyles.text.caption = textCaption;\n    }\n\n    if (branding) {\n        fastlaneStyles.branding = branding;\n    }\n\n    return fastlaneStyles;\n}\n","import {\n    PaymentProviderCustomer,\n    PayPalConnectCustomer,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\n// TODO: update PayPalConnectCustomer with PayPalFastlaneCustomer\nexport default function isPayPalFastlaneCustomer(\n    customer?: PaymentProviderCustomer,\n): customer is PayPalConnectCustomer {\n    if (!customer) {\n        return false;\n    }\n\n    return (\n        'authenticationState' in customer || 'addresses' in customer || 'instruments' in customer\n    );\n}\n","import {\n    CardInstrument,\n    InvalidArgumentError,\n    isHostedInstrumentLike,\n    isVaultedInstrument,\n    OrderFinalizationNotRequiredError,\n    OrderPaymentRequestBody,\n    OrderRequestBody,\n    Payment,\n    PaymentArgumentInvalidError,\n    PaymentInitializeOptions,\n    PaymentIntegrationService,\n    PaymentMethodClientUnavailableError,\n    PaymentMethodInvalidError,\n    PaymentRequestOptions,\n    PaymentStrategy,\n    VaultedInstrument,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\nimport {\n    getFastlaneStyles,\n    isPayPalFastlaneCustomer,\n    isPaypalFastlaneRequestError,\n    PayPalFastlaneAuthenticationState,\n    PayPalFastlaneCardComponentMethods,\n    PayPalFastlaneCardComponentOptions,\n    PayPalFastlanePaymentFormattedPayload,\n    PayPalFastlaneSdk,\n    PayPalFastlaneUtils,\n    PayPalInitializationData,\n    PayPalSdkScriptLoader,\n    TDSecureAuthenticationState,\n} from '@bigcommerce/checkout-sdk/paypal-utils';\nimport { isExperimentEnabled } from '@bigcommerce/checkout-sdk/utility';\n\nimport PayPalCommerceRequestSender from '../paypal-commerce-request-sender';\nimport { LiabilityShiftEnum } from '../paypal-commerce-types';\n\nimport PayPalCommerceFastlanePaymentInitializeOptions, {\n    WithPayPalCommerceFastlanePaymentInitializeOptions,\n} from './paypal-commerce-fastlane-payment-initialize-options';\n\nexport default class PaypalCommerceFastlanePaymentStrategy implements PaymentStrategy {\n    private paypalComponentMethods?: PayPalFastlaneCardComponentMethods;\n    private paypalFastlaneSdk?: PayPalFastlaneSdk;\n    private threeDSVerificationMethod?: string;\n    private paypalcommercefastlane?: PayPalCommerceFastlanePaymentInitializeOptions;\n    private orderId?: string;\n    private methodId?: string;\n\n    constructor(\n        private paymentIntegrationService: PaymentIntegrationService,\n        private paypalCommerceRequestSender: PayPalCommerceRequestSender,\n        private paypalSdkScriptLoader: PayPalSdkScriptLoader,\n        private paypalFastlaneUtils: PayPalFastlaneUtils,\n    ) {}\n\n    /**\n     *\n     * Default methods\n     *\n     * */\n    async initialize(\n        options: PaymentInitializeOptions & WithPayPalCommerceFastlanePaymentInitializeOptions,\n    ): Promise<void> {\n        const { methodId, paypalcommercefastlane } = options;\n\n        this.methodId = methodId;\n\n        this.paypalcommercefastlane = paypalcommercefastlane;\n\n        if (!methodId) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.methodId\" argument is not provided.',\n            );\n        }\n\n        if (!paypalcommercefastlane) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.paypalcommercefastlane\" argument is not provided.',\n            );\n        }\n\n        if (!paypalcommercefastlane.onInit || typeof paypalcommercefastlane.onInit !== 'function') {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.paypalcommercefastlane.onInit\" argument is not provided or it is not a function.',\n            );\n        }\n\n        if (\n            !paypalcommercefastlane.onChange ||\n            typeof paypalcommercefastlane.onChange !== 'function'\n        ) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.paypalcommercefastlane.onChange\" argument is not provided or it is not a function.',\n            );\n        }\n\n        await this.paymentIntegrationService.loadPaymentMethod(methodId);\n\n        const state = this.paymentIntegrationService.getState();\n        const cart = state.getCartOrThrow();\n        const paymentMethod = state.getPaymentMethodOrThrow<PayPalInitializationData>(methodId);\n        const { isDeveloperModeApplicable, isFastlaneStylingEnabled } =\n            paymentMethod.initializationData || {};\n\n        this.threeDSVerificationMethod =\n            paymentMethod.initializationData?.threeDSVerificationMethod;\n\n        this.paypalFastlaneSdk = await this.paypalSdkScriptLoader.getPayPalFastlaneSdk(\n            paymentMethod,\n            cart.currency.code,\n            cart.id,\n        );\n\n        const paypalFastlaneStyling = isFastlaneStylingEnabled\n            ? paymentMethod?.initializationData?.fastlaneStyles\n            : {};\n\n        const fastlaneStyles = getFastlaneStyles(\n            paypalFastlaneStyling,\n            paypalcommercefastlane?.styles,\n        );\n\n        await this.paypalFastlaneUtils.initializePayPalFastlane(\n            this.paypalFastlaneSdk,\n            !!isDeveloperModeApplicable,\n            fastlaneStyles,\n        );\n\n        if (this.shouldRunAuthenticationFlow()) {\n            await this.runPayPalAuthenticationFlowOrThrow(methodId);\n        }\n\n        await this.initializePayPalPaymentComponent();\n\n        paypalcommercefastlane.onInit((container: string) =>\n            this.renderPayPalPaymentComponent(container),\n        );\n        paypalcommercefastlane.onChange(() => this.handlePayPalStoredInstrumentChange(methodId));\n    }\n\n    async execute(orderRequest: OrderRequestBody, options?: PaymentRequestOptions): Promise<void> {\n        const { payment, ...order } = orderRequest;\n\n        if (!payment) {\n            throw new PaymentArgumentInvalidError(['payment']);\n        }\n\n        const { paymentData, methodId } = payment;\n\n        const isVaultedFlow = paymentData && isVaultedInstrument(paymentData);\n\n        try {\n            await this.paymentIntegrationService.submitOrder(order, options);\n\n            const paymentPayload = isVaultedFlow\n                ? await this.prepareVaultedInstrumentPaymentPayload(methodId, paymentData)\n                : await this.preparePaymentPayload(methodId, paymentData);\n\n            await this.paymentIntegrationService.submitPayment<PayPalFastlanePaymentFormattedPayload>(\n                paymentPayload,\n            );\n\n            this.paypalFastlaneUtils.removeStorageSessionId();\n        } catch (error) {\n            if (\n                isPaypalFastlaneRequestError(error) &&\n                error.response.body.name === 'INVALID_REQUEST'\n            ) {\n                const invalidRequestError = {\n                    translationKey: 'payment.errors.invalid_request_error',\n                };\n\n                this.handleError(invalidRequestError);\n\n                return Promise.reject();\n            }\n\n            if (error instanceof Error && error.name !== 'FastlaneError') {\n                throw error;\n            }\n\n            return Promise.reject();\n        }\n    }\n\n    finalize(): Promise<void> {\n        return Promise.reject(new OrderFinalizationNotRequiredError());\n    }\n\n    async deinitialize(): Promise<void> {\n        return Promise.resolve();\n    }\n\n    /**\n     *\n     * Authentication flow methods\n     *\n     */\n    private shouldRunAuthenticationFlow(): boolean {\n        const state = this.paymentIntegrationService.getState();\n        const cart = state.getCartOrThrow();\n        const customer = state.getCustomerOrThrow();\n        const paymentProviderCustomer = state.getPaymentProviderCustomer();\n        const paypalFastlaneCustomer = isPayPalFastlaneCustomer(paymentProviderCustomer)\n            ? paymentProviderCustomer\n            : {};\n\n        const paypalFastlaneSessionId = this.paypalFastlaneUtils.getStorageSessionId();\n\n        if (\n            !customer.isGuest ||\n            paypalFastlaneCustomer?.authenticationState ===\n                PayPalFastlaneAuthenticationState.CANCELED\n        ) {\n            return false;\n        }\n\n        return !paypalFastlaneCustomer?.authenticationState && paypalFastlaneSessionId === cart.id;\n    }\n\n    private async runPayPalAuthenticationFlowOrThrow(methodId: string): Promise<void> {\n        try {\n            const state = this.paymentIntegrationService.getState();\n            const cart = state.getCartOrThrow();\n            const customer = state.getCustomer();\n            const billingAddress = state.getBillingAddress();\n            const customerEmail = customer?.email || billingAddress?.email || '';\n\n            const { customerContextId } = await this.paypalFastlaneUtils.lookupCustomerOrThrow(\n                customerEmail,\n            );\n\n            const authenticationResult =\n                await this.paypalFastlaneUtils.triggerAuthenticationFlowOrThrow(customerContextId);\n\n            const { authenticationState, addresses, instruments } =\n                this.paypalFastlaneUtils.mapPayPalFastlaneProfileToBcCustomerData(\n                    methodId,\n                    authenticationResult,\n                );\n\n            await this.paymentIntegrationService.updatePaymentProviderCustomer({\n                authenticationState,\n                addresses,\n                instruments,\n            });\n\n            const isAuthenticationFlowCanceled =\n                authenticationResult.authenticationState ===\n                PayPalFastlaneAuthenticationState.CANCELED;\n\n            if (isAuthenticationFlowCanceled) {\n                this.paypalFastlaneUtils.removeStorageSessionId();\n            } else {\n                this.paypalFastlaneUtils.updateStorageSessionId(cart.id);\n            }\n        } catch (error) {\n            // Info: Do not throw anything here to avoid blocking customer from passing checkout flow\n        }\n    }\n\n    /**\n     *\n     * PayPal Fastlane Card Component rendering method\n     *\n     */\n    private async initializePayPalPaymentComponent(): Promise<void> {\n        const state = this.paymentIntegrationService.getState();\n        const billingAddress = state.getBillingAddressOrThrow();\n        const phone = billingAddress.phone;\n        const fullName = `${billingAddress.firstName} ${billingAddress.lastName}`.trim();\n\n        const paypalFastlane = this.paypalFastlaneUtils.getPayPalFastlaneOrThrow();\n\n        const cardComponentOptions: PayPalFastlaneCardComponentOptions = {\n            fields: {\n                cardholderName: {\n                    prefill: fullName,\n                    enabled: true,\n                },\n                ...(phone && {\n                    phoneNumber: {\n                        prefill: phone,\n                    },\n                }),\n            },\n        };\n\n        this.paypalComponentMethods = await paypalFastlane.FastlaneCardComponent(\n            cardComponentOptions,\n        );\n    }\n\n    private renderPayPalPaymentComponent(container?: string): void {\n        const paypalComponentMethods = this.getPayPalComponentMethodsOrThrow();\n\n        if (!container) {\n            throw new InvalidArgumentError(\n                'Unable to render card component because \"container\" argument is not provided.',\n            );\n        }\n\n        paypalComponentMethods.render(container);\n    }\n\n    private getPayPalComponentMethodsOrThrow(): PayPalFastlaneCardComponentMethods {\n        if (!this.paypalComponentMethods) {\n            throw new PaymentMethodClientUnavailableError();\n        }\n\n        return this.paypalComponentMethods;\n    }\n\n    /**\n     *\n     * Payment Payload preparation methods\n     *\n     */\n    private async prepareVaultedInstrumentPaymentPayload(\n        methodId: string,\n        paymentData: VaultedInstrument,\n    ): Promise<Payment<PayPalFastlanePaymentFormattedPayload>> {\n        const { instrumentId } = paymentData;\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod = state.getPaymentMethodOrThrow<PayPalInitializationData>(methodId);\n        const is3DSEnabled =\n            this.isPaypalCommerceFastlaneThreeDSAvailable() && paymentMethod.config.is3dsEnabled;\n\n        if (!is3DSEnabled) {\n            await this.createOrder(instrumentId);\n        }\n\n        const fastlaneToken = is3DSEnabled ? await this.get3DSNonce(instrumentId) : instrumentId;\n\n        return {\n            methodId,\n            paymentData: {\n                formattedPayload: {\n                    paypal_fastlane_token: {\n                        order_id: this.orderId,\n                        token: fastlaneToken,\n                    },\n                },\n            },\n        };\n    }\n\n    private async preparePaymentPayload(\n        methodId: string,\n        paymentData: OrderPaymentRequestBody['paymentData'],\n    ): Promise<Payment<PayPalFastlanePaymentFormattedPayload>> {\n        const state = this.paymentIntegrationService.getState();\n        const billingAddress = state.getBillingAddressOrThrow();\n        const paymentMethod = state.getPaymentMethodOrThrow<PayPalInitializationData>(methodId);\n\n        const fullName = `${billingAddress.firstName} ${billingAddress.lastName}`.trim();\n\n        const { getPaymentToken } = this.getPayPalComponentMethodsOrThrow();\n\n        const { id } = await getPaymentToken({\n            name: { fullName },\n            billingAddress: this.paypalFastlaneUtils.mapBcToPayPalAddress(billingAddress),\n        });\n\n        const is3DSEnabled =\n            this.isPaypalCommerceFastlaneThreeDSAvailable() && paymentMethod.config.is3dsEnabled;\n\n        if (!is3DSEnabled) {\n            await this.createOrder(id);\n        }\n\n        const fastlaneToken = is3DSEnabled ? await this.get3DSNonce(id) : id;\n\n        const { shouldSaveInstrument = false, shouldSetAsDefaultInstrument = false } =\n            isHostedInstrumentLike(paymentData) ? paymentData : {};\n\n        return {\n            methodId,\n            paymentData: {\n                ...paymentData,\n                shouldSaveInstrument,\n                shouldSetAsDefaultInstrument,\n                formattedPayload: {\n                    paypal_fastlane_token: {\n                        order_id: this.orderId,\n                        token: fastlaneToken,\n                    },\n                },\n            },\n        };\n    }\n\n    private async createOrder(id: string): Promise<void> {\n        const state = this.paymentIntegrationService.getState();\n        const cartId = state.getCartOrThrow().id;\n\n        if (this.methodId) {\n            const { orderId } = await this.paypalCommerceRequestSender.createOrder(this.methodId, {\n                cartId,\n                fastlaneToken: id,\n            });\n\n            this.orderId = orderId;\n        }\n    }\n\n    /**\n     *\n     * 3DSecure methods\n     *\n     * */\n    private async get3DSNonce(paypalNonce: string): Promise<string> {\n        const state = this.paymentIntegrationService.getState();\n        const cart = state.getCartOrThrow();\n        const order = state.getOrderOrThrow();\n        const checkoutUrl = state.getStoreConfigOrThrow().links.checkoutLink;\n\n        const threeDomainSecureComponent = this.paypalFastlaneSdk?.ThreeDomainSecureClient;\n\n        if (!threeDomainSecureComponent) {\n            throw new PaymentMethodClientUnavailableError();\n        }\n\n        const threeDomainSecureParameters = {\n            amount: order.orderAmount.toFixed(2),\n            currency: cart.currency.code,\n            nonce: paypalNonce,\n            threeDSRequested: this.threeDSVerificationMethod === 'SCA_ALWAYS',\n            transactionContext: {\n                experience_context: {\n                    locale: 'en-US',\n                    return_url: checkoutUrl,\n                    cancel_url: checkoutUrl,\n                },\n            },\n        };\n\n        const isThreeDomainSecureEligible = await threeDomainSecureComponent.isEligible(\n            threeDomainSecureParameters,\n        );\n\n        if (isThreeDomainSecureEligible) {\n            const { liabilityShift, authenticationState, nonce } =\n                await threeDomainSecureComponent.show();\n\n            if (\n                liabilityShift === LiabilityShiftEnum.No ||\n                liabilityShift === LiabilityShiftEnum.Unknown ||\n                authenticationState === TDSecureAuthenticationState.Errored ||\n                authenticationState === TDSecureAuthenticationState.Cancelled\n            ) {\n                throw new PaymentMethodInvalidError();\n            }\n\n            if (\n                authenticationState === TDSecureAuthenticationState.Succeeded &&\n                [LiabilityShiftEnum.Yes, LiabilityShiftEnum.Possible].includes(liabilityShift)\n            ) {\n                await this.createOrder(nonce);\n\n                return nonce;\n            }\n        }\n\n        return paypalNonce;\n    }\n\n    /**\n     *\n     * PayPal Fastlane instrument change\n     *\n     */\n    private async handlePayPalStoredInstrumentChange(\n        methodId: string,\n    ): Promise<CardInstrument | undefined> {\n        const paypalAxoSdk = this.paypalFastlaneUtils.getPayPalFastlaneOrThrow();\n\n        const { selectionChanged, selectedCard } = await paypalAxoSdk.profile.showCardSelector();\n\n        if (selectionChanged) {\n            const state = this.paymentIntegrationService.getState();\n            const paymentProviderCustomer = state.getPaymentProviderCustomer();\n            const paypalFastlaneCustomer = isPayPalFastlaneCustomer(paymentProviderCustomer)\n                ? paymentProviderCustomer\n                : {};\n\n            const selectedInstrument = this.paypalFastlaneUtils.mapPayPalToBcInstrument(\n                methodId,\n                selectedCard,\n            )[0];\n\n            await this.paymentIntegrationService.updatePaymentProviderCustomer({\n                ...paypalFastlaneCustomer,\n                instruments: [selectedInstrument],\n            });\n\n            return selectedInstrument;\n        }\n\n        return undefined;\n    }\n\n    /**\n     *\n     * PayPal Fastlane experiments handling\n     *\n     */\n    private isPaypalCommerceFastlaneThreeDSAvailable(): boolean {\n        const state = this.paymentIntegrationService.getState();\n        const features = state.getStoreConfigOrThrow().checkoutSettings.features;\n\n        return isExperimentEnabled(features, 'PROJECT-7080.paypalcommerce_fastlane_three_ds');\n    }\n\n    private handleError(error: unknown): void {\n        if (\n            this.paypalcommercefastlane?.onError &&\n            typeof this.paypalcommercefastlane.onError === 'function'\n        ) {\n            this.paypalcommercefastlane.onError(error);\n        }\n    }\n}\n","export interface PaypalFastlaneRequestError {\n    name: string;\n    message: string;\n    response: {\n        body: {\n            name: string;\n        };\n    };\n}\n\nexport default function isPaypalFastlaneRequestError(\n    error: unknown,\n): error is PaypalFastlaneRequestError {\n    return (\n        typeof error === 'object' &&\n        error !== null &&\n        'message' in error &&\n        'response' in error &&\n        'body' in (error as PaypalFastlaneRequestError).response &&\n        'name' in (error as PaypalFastlaneRequestError).response.body\n    );\n}\n","import { createRequestSender } from '@bigcommerce/request-sender';\n\nimport {\n    PaymentStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\nimport {\n    createPayPalFastlaneUtils,\n    createPayPalSdkScriptLoader,\n} from '@bigcommerce/checkout-sdk/paypal-utils';\n\nimport PayPalCommerceRequestSender from '../paypal-commerce-request-sender';\n\nimport PayPalCommerceFastlanePaymentStrategy from './paypal-commerce-fastlane-payment-strategy';\n\nconst createPayPalCommerceFastlanePaymentStrategy: PaymentStrategyFactory<\n    PayPalCommerceFastlanePaymentStrategy\n> = (paymentIntegrationService) => {\n    const { getHost } = paymentIntegrationService.getState();\n\n    return new PayPalCommerceFastlanePaymentStrategy(\n        paymentIntegrationService,\n        new PayPalCommerceRequestSender(createRequestSender({ host: getHost() })),\n        createPayPalSdkScriptLoader(),\n        createPayPalFastlaneUtils(),\n    );\n};\n\nexport default toResolvableModule(createPayPalCommerceFastlanePaymentStrategy, [\n    { id: 'paypalcommerceacceleratedcheckout' }, // PayPal Fastlane relates to 'paypalcommerceacceleratedcheckout' method id\n]);\n","import { noop } from 'lodash';\n\nimport {\n    CustomerCredentials,\n    CustomerInitializeOptions,\n    CustomerStrategy,\n    DefaultCheckoutButtonHeight,\n    ExecutePaymentMethodCheckoutOptions,\n    InvalidArgumentError,\n    MissingDataError,\n    MissingDataErrorType,\n    PaymentIntegrationService,\n    RequestOptions,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport PayPalCommerceIntegrationService from '../paypal-commerce-integration-service';\nimport {\n    ApproveCallbackActions,\n    ApproveCallbackPayload,\n    PayPalCommerceButtonsOptions,\n    PayPalCommerceInitializationData,\n    ShippingAddressChangeCallbackPayload,\n    ShippingOptionChangeCallbackPayload,\n} from '../paypal-commerce-types';\n\nimport PayPalCommerceCustomerInitializeOptions, {\n    WithPayPalCommerceCustomerInitializeOptions,\n} from './paypal-commerce-customer-initialize-options';\n\nexport default class PayPalCommerceCustomerStrategy implements CustomerStrategy {\n    private onError = noop;\n\n    constructor(\n        private paymentIntegrationService: PaymentIntegrationService,\n        private paypalCommerceIntegrationService: PayPalCommerceIntegrationService,\n    ) {}\n\n    async initialize(\n        options: CustomerInitializeOptions & WithPayPalCommerceCustomerInitializeOptions,\n    ): Promise<void> {\n        const { paypalcommerce, methodId } = options;\n\n        if (!methodId) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.methodId\" argument is not provided.',\n            );\n        }\n\n        if (!paypalcommerce) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.paypalcommerce\" argument is not provided.',\n            );\n        }\n\n        if (!paypalcommerce.container) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.paypalcommerce.container\" argument is not provided.',\n            );\n        }\n\n        if (paypalcommerce.onClick && typeof paypalcommerce.onClick !== 'function') {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.paypalcommerce.onClick\" argument is not a function.',\n            );\n        }\n\n        this.onError = paypalcommerce.onError || noop;\n\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod = state.getPaymentMethod(methodId);\n\n        if (!paymentMethod) {\n            await this.paymentIntegrationService.loadPaymentMethod(methodId);\n        }\n\n        const paypalSdk = await this.paypalCommerceIntegrationService.loadPayPalSdk(methodId);\n\n        if (!paypalSdk || !paypalSdk.Buttons || typeof paypalSdk.Buttons !== 'function') {\n            console.error(\n                '[BC PayPal]: PayPal Button could not be rendered, due to issues with loading PayPal SDK',\n            );\n\n            return;\n        }\n\n        this.renderButton(methodId, paypalcommerce);\n    }\n\n    deinitialize(): Promise<void> {\n        return Promise.resolve();\n    }\n\n    async signIn(credentials: CustomerCredentials, options?: RequestOptions): Promise<void> {\n        await this.paymentIntegrationService.signInCustomer(credentials, options);\n\n        return Promise.resolve();\n    }\n\n    async signOut(options?: RequestOptions): Promise<void> {\n        await this.paymentIntegrationService.signOutCustomer(options);\n\n        return Promise.resolve();\n    }\n\n    executePaymentMethodCheckout(options?: ExecutePaymentMethodCheckoutOptions): Promise<void> {\n        options?.continueWithCheckoutCallback?.();\n\n        return Promise.resolve();\n    }\n\n    private renderButton(\n        methodId: string,\n        paypalcommerce: PayPalCommerceCustomerInitializeOptions,\n    ): void {\n        const { container, onClick, onComplete } = paypalcommerce;\n\n        const paypalSdk = this.paypalCommerceIntegrationService.getPayPalSdkOrThrow();\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod =\n            state.getPaymentMethodOrThrow<PayPalCommerceInitializationData>(methodId);\n        const { isHostedCheckoutEnabled, paymentButtonStyles, isAppSwitchEnabled } =\n            paymentMethod.initializationData || {};\n        const { checkoutTopButtonStyles } = paymentButtonStyles || {};\n\n        const defaultCallbacks = {\n            ...(this.isPaypalCommerceAppSwitchEnabled(methodId) && {\n                appSwitchWhenAvailable: true,\n            }),\n            createOrder: () => this.paypalCommerceIntegrationService.createOrder('paypalcommerce'),\n            onApprove: ({ orderID }: ApproveCallbackPayload) =>\n                this.paypalCommerceIntegrationService.tokenizePayment(methodId, orderID),\n            ...(onClick && { onClick: () => onClick() }),\n        };\n\n        const hostedCheckoutCallbacks = {\n            ...(!isAppSwitchEnabled && {\n                onShippingAddressChange: (data: ShippingAddressChangeCallbackPayload) =>\n                    this.onShippingAddressChange(data),\n                onShippingOptionsChange: (data: ShippingOptionChangeCallbackPayload) =>\n                    this.onShippingOptionsChange(data),\n            }),\n            onApprove: (data: ApproveCallbackPayload, actions: ApproveCallbackActions) =>\n                this.onHostedCheckoutApprove(data, actions, methodId, onComplete),\n        };\n\n        const buttonRenderOptions: PayPalCommerceButtonsOptions = {\n            fundingSource: paypalSdk.FUNDING.PAYPAL,\n            style: this.paypalCommerceIntegrationService.getValidButtonStyle({\n                ...checkoutTopButtonStyles,\n                height: DefaultCheckoutButtonHeight,\n            }),\n            ...defaultCallbacks,\n            ...(isHostedCheckoutEnabled && hostedCheckoutCallbacks),\n        };\n\n        const paypalButton = paypalSdk.Buttons(buttonRenderOptions);\n\n        if (paypalButton.isEligible()) {\n            if (paypalButton.hasReturned?.() && this.isPaypalCommerceAppSwitchEnabled(methodId)) {\n                paypalButton.resume?.();\n            } else {\n                paypalButton.render(`#${container}`);\n            }\n        } else {\n            this.paypalCommerceIntegrationService.removeElement(container);\n        }\n    }\n\n    private async onHostedCheckoutApprove(\n        data: ApproveCallbackPayload,\n        actions: ApproveCallbackActions,\n        methodId: string,\n        onComplete?: () => void,\n    ): Promise<void> {\n        if (!data.orderID) {\n            throw new MissingDataError(MissingDataErrorType.MissingOrderId);\n        }\n\n        const cart = this.paymentIntegrationService.getState().getCartOrThrow();\n        const orderDetails = await actions.order.get();\n\n        try {\n            const billingAddress =\n                this.paypalCommerceIntegrationService.getBillingAddressFromOrderDetails(\n                    orderDetails,\n                );\n\n            await this.paymentIntegrationService.updateBillingAddress(billingAddress);\n\n            if (cart.lineItems.physicalItems.length > 0) {\n                const shippingAddress =\n                    this.paypalCommerceIntegrationService.getShippingAddressFromOrderDetails(\n                        orderDetails,\n                    );\n\n                await this.paymentIntegrationService.updateShippingAddress(shippingAddress);\n                await this.paypalCommerceIntegrationService.updateOrder();\n            }\n\n            await this.paymentIntegrationService.submitOrder({}, { params: { methodId } });\n            await this.paypalCommerceIntegrationService.submitPayment(methodId, data.orderID);\n\n            if (onComplete && typeof onComplete === 'function') {\n                onComplete();\n            }\n        } catch (error) {\n            this.handleError(error);\n        }\n    }\n\n    private async onShippingAddressChange(\n        data: ShippingAddressChangeCallbackPayload,\n    ): Promise<void> {\n        const address = this.paypalCommerceIntegrationService.getAddress({\n            city: data.shippingAddress.city,\n            countryCode: data.shippingAddress.countryCode,\n            postalCode: data.shippingAddress.postalCode,\n            stateOrProvinceCode: data.shippingAddress.state,\n        });\n\n        try {\n            // Info: we use the same address to fill billing and shipping addresses to have valid quota on BE for order updating process\n            // on this stage we don't have access to valid customer's address except shipping data\n            await this.paymentIntegrationService.updateBillingAddress(address);\n            await this.paymentIntegrationService.updateShippingAddress(address);\n\n            const shippingOption = this.paypalCommerceIntegrationService.getShippingOptionOrThrow();\n\n            await this.paymentIntegrationService.selectShippingOption(shippingOption.id);\n            await this.paypalCommerceIntegrationService.updateOrder();\n        } catch (error) {\n            this.handleError(error);\n        }\n    }\n\n    private async onShippingOptionsChange(\n        data: ShippingOptionChangeCallbackPayload,\n    ): Promise<void> {\n        const shippingOption = this.paypalCommerceIntegrationService.getShippingOptionOrThrow(\n            data.selectedShippingOption.id,\n        );\n\n        try {\n            await this.paymentIntegrationService.selectShippingOption(shippingOption.id);\n            await this.paypalCommerceIntegrationService.updateOrder();\n        } catch (error) {\n            this.handleError(error);\n        }\n    }\n\n    private handleError(error: unknown) {\n        if (typeof this.onError === 'function') {\n            this.onError(error);\n        } else {\n            throw error;\n        }\n    }\n\n    /**\n     *\n     * PayPal AppSwitch enabling handling\n     *\n     */\n    private isPaypalCommerceAppSwitchEnabled(methodId: string): boolean {\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod =\n            state.getPaymentMethodOrThrow<PayPalCommerceInitializationData>(methodId);\n\n        return paymentMethod.initializationData?.isAppSwitchEnabled || false;\n    }\n}\n","const DefaultCheckoutButtonHeight = 40;\n\nexport default DefaultCheckoutButtonHeight;\n","import {\n    CustomerStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport createPayPalCommerceIntegrationService from '../create-paypal-commerce-integration-service';\n\nimport PayPalCommerceCustomerStrategy from './paypal-commerce-customer-strategy';\n\nconst createPayPalCommerceCustomerStrategy: CustomerStrategyFactory<\n    PayPalCommerceCustomerStrategy\n> = (paymentIntegrationService) =>\n    new PayPalCommerceCustomerStrategy(\n        paymentIntegrationService,\n        createPayPalCommerceIntegrationService(paymentIntegrationService),\n    );\n\nexport default toResolvableModule(createPayPalCommerceCustomerStrategy, [{ id: 'paypalcommerce' }]);\n","import { noop } from 'lodash';\n\nimport {\n    CustomerCredentials,\n    CustomerInitializeOptions,\n    CustomerStrategy,\n    DefaultCheckoutButtonHeight,\n    ExecutePaymentMethodCheckoutOptions,\n    InvalidArgumentError,\n    MissingDataError,\n    MissingDataErrorType,\n    PaymentIntegrationService,\n    RequestOptions,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport PayPalCommerceIntegrationService from '../paypal-commerce-integration-service';\nimport {\n    ApproveCallbackActions,\n    ApproveCallbackPayload,\n    PayPalCommerceButtonsOptions,\n    PayPalCommerceInitializationData,\n    ShippingAddressChangeCallbackPayload,\n    ShippingOptionChangeCallbackPayload,\n} from '../paypal-commerce-types';\n\nimport PayPalCommerceCreditCustomerInitializeOptions, {\n    WithPayPalCommerceCreditCustomerInitializeOptions,\n} from './paypal-commerce-credit-customer-initialize-options';\n\nexport default class PayPalCommerceCreditCustomerStrategy implements CustomerStrategy {\n    private onError = noop;\n\n    constructor(\n        private paymentIntegrationService: PaymentIntegrationService,\n        private paypalCommerceIntegrationService: PayPalCommerceIntegrationService,\n    ) {}\n\n    async initialize(\n        options: CustomerInitializeOptions & WithPayPalCommerceCreditCustomerInitializeOptions,\n    ): Promise<void> {\n        const { paypalcommercecredit, methodId } = options;\n\n        if (!methodId) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.methodId\" argument is not provided.',\n            );\n        }\n\n        if (!paypalcommercecredit) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.paypalcommercecredit\" argument is not provided.',\n            );\n        }\n\n        if (!paypalcommercecredit.container) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.paypalcommercecredit.container\" argument is not provided.',\n            );\n        }\n\n        if (paypalcommercecredit.onClick && typeof paypalcommercecredit.onClick !== 'function') {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.paypalcommercecredit.onClick\" argument is not a function.',\n            );\n        }\n\n        this.onError = paypalcommercecredit.onError || noop;\n\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod = state.getPaymentMethod(methodId);\n\n        if (!paymentMethod) {\n            await this.paymentIntegrationService.loadPaymentMethod(methodId);\n        }\n\n        const paypalSdk = await this.paypalCommerceIntegrationService.loadPayPalSdk(methodId);\n\n        if (!paypalSdk || !paypalSdk.Buttons || typeof paypalSdk.Buttons !== 'function') {\n            console.error(\n                '[BC PayPal]: PayPal Button could not be rendered, due to issues with loading PayPal SDK',\n            );\n\n            return;\n        }\n\n        this.renderButton(methodId, paypalcommercecredit);\n    }\n\n    deinitialize(): Promise<void> {\n        return Promise.resolve();\n    }\n\n    async signIn(credentials: CustomerCredentials, options?: RequestOptions): Promise<void> {\n        await this.paymentIntegrationService.signInCustomer(credentials, options);\n    }\n\n    async signOut(options?: RequestOptions): Promise<void> {\n        await this.paymentIntegrationService.signOutCustomer(options);\n    }\n\n    executePaymentMethodCheckout(options?: ExecutePaymentMethodCheckoutOptions): Promise<void> {\n        options?.continueWithCheckoutCallback?.();\n\n        return Promise.resolve();\n    }\n\n    private renderButton(\n        methodId: string,\n        paypalCommerceCredit: PayPalCommerceCreditCustomerInitializeOptions,\n    ): void {\n        const { container, onComplete, onClick } = paypalCommerceCredit;\n\n        const paypalSdk = this.paypalCommerceIntegrationService.getPayPalSdkOrThrow();\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod =\n            state.getPaymentMethodOrThrow<PayPalCommerceInitializationData>(methodId);\n        const { isHostedCheckoutEnabled, paymentButtonStyles, isAppSwitchEnabled } =\n            paymentMethod.initializationData || {};\n        const { checkoutTopButtonStyles } = paymentButtonStyles || {};\n\n        const defaultCallbacks = {\n            createOrder: () =>\n                this.paypalCommerceIntegrationService.createOrder('paypalcommercecredit'),\n            onApprove: ({ orderID }: ApproveCallbackPayload) =>\n                this.paypalCommerceIntegrationService.tokenizePayment(methodId, orderID),\n            ...(onClick && { onClick: () => onClick() }),\n        };\n\n        const hostedCheckoutCallbacks = {\n            ...(!isAppSwitchEnabled && {\n                onShippingAddressChange: (data: ShippingAddressChangeCallbackPayload) =>\n                    this.onShippingAddressChange(data),\n                onShippingOptionsChange: (data: ShippingOptionChangeCallbackPayload) =>\n                    this.onShippingOptionsChange(data),\n            }),\n            onApprove: (data: ApproveCallbackPayload, actions: ApproveCallbackActions) =>\n                this.onHostedCheckoutApprove(data, actions, methodId, onComplete),\n        };\n\n        const fundingSources = [paypalSdk.FUNDING.PAYLATER, paypalSdk.FUNDING.CREDIT];\n        let hasRenderedSmartButton = false;\n\n        fundingSources.forEach((fundingSource) => {\n            if (!hasRenderedSmartButton) {\n                const buttonRenderOptions: PayPalCommerceButtonsOptions = {\n                    fundingSource,\n                    style: this.paypalCommerceIntegrationService.getValidButtonStyle({\n                        ...checkoutTopButtonStyles,\n                        height: DefaultCheckoutButtonHeight,\n                    }),\n                    ...defaultCallbacks,\n                    ...(isHostedCheckoutEnabled && hostedCheckoutCallbacks),\n                };\n\n                const paypalButton = paypalSdk.Buttons(buttonRenderOptions);\n\n                if (paypalButton.isEligible()) {\n                    paypalButton.render(`#${container}`);\n                    hasRenderedSmartButton = true;\n                }\n            }\n        });\n\n        if (!hasRenderedSmartButton) {\n            this.paypalCommerceIntegrationService.removeElement(container);\n        }\n    }\n\n    private async onHostedCheckoutApprove(\n        data: ApproveCallbackPayload,\n        actions: ApproveCallbackActions,\n        methodId: string,\n        onComplete?: () => void,\n    ): Promise<void> {\n        if (!data.orderID) {\n            throw new MissingDataError(MissingDataErrorType.MissingOrderId);\n        }\n\n        const cart = this.paymentIntegrationService.getState().getCartOrThrow();\n        const orderDetails = await actions.order.get();\n\n        try {\n            const billingAddress =\n                this.paypalCommerceIntegrationService.getBillingAddressFromOrderDetails(\n                    orderDetails,\n                );\n\n            await this.paymentIntegrationService.updateBillingAddress(billingAddress);\n\n            if (cart.lineItems.physicalItems.length > 0) {\n                const shippingAddress =\n                    this.paypalCommerceIntegrationService.getShippingAddressFromOrderDetails(\n                        orderDetails,\n                    );\n\n                await this.paymentIntegrationService.updateShippingAddress(shippingAddress);\n                await this.paypalCommerceIntegrationService.updateOrder();\n            }\n\n            await this.paymentIntegrationService.submitOrder({}, { params: { methodId } });\n            await this.paypalCommerceIntegrationService.submitPayment(methodId, data.orderID);\n\n            if (onComplete && typeof onComplete === 'function') {\n                onComplete();\n            }\n        } catch (error) {\n            this.handleError(error);\n        }\n    }\n\n    private async onShippingAddressChange(\n        data: ShippingAddressChangeCallbackPayload,\n    ): Promise<void> {\n        const address = this.paypalCommerceIntegrationService.getAddress({\n            city: data.shippingAddress.city,\n            countryCode: data.shippingAddress.countryCode,\n            postalCode: data.shippingAddress.postalCode,\n            stateOrProvinceCode: data.shippingAddress.state,\n        });\n\n        try {\n            // Info: we use the same address to fill billing and shipping addresses to have valid quota on BE for order updating process\n            // on this stage we don't have access to valid customer's address except shipping data\n            await this.paymentIntegrationService.updateBillingAddress(address);\n            await this.paymentIntegrationService.updateShippingAddress(address);\n\n            const shippingOption = this.paypalCommerceIntegrationService.getShippingOptionOrThrow();\n\n            await this.paymentIntegrationService.selectShippingOption(shippingOption.id);\n            await this.paypalCommerceIntegrationService.updateOrder();\n        } catch (error) {\n            this.handleError(error);\n        }\n    }\n\n    private async onShippingOptionsChange(\n        data: ShippingOptionChangeCallbackPayload,\n    ): Promise<void> {\n        const shippingOption = this.paypalCommerceIntegrationService.getShippingOptionOrThrow(\n            data.selectedShippingOption.id,\n        );\n\n        try {\n            await this.paymentIntegrationService.selectShippingOption(shippingOption.id);\n            await this.paypalCommerceIntegrationService.updateOrder();\n        } catch (error) {\n            this.handleError(error);\n        }\n    }\n\n    private handleError(error: unknown) {\n        if (typeof this.onError === 'function') {\n            this.onError(error);\n        } else {\n            throw error;\n        }\n    }\n}\n","import {\n    CustomerStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport createPayPalCommerceIntegrationService from '../create-paypal-commerce-integration-service';\n\nimport PayPalCommerceCreditCustomerStrategy from './paypal-commerce-credit-customer-strategy';\n\nconst createPayPalCommerceCreditCustomerStrategy: CustomerStrategyFactory<\n    PayPalCommerceCreditCustomerStrategy\n> = (paymentIntegrationService) =>\n    new PayPalCommerceCreditCustomerStrategy(\n        paymentIntegrationService,\n        createPayPalCommerceIntegrationService(paymentIntegrationService),\n    );\n\nexport default toResolvableModule(createPayPalCommerceCreditCustomerStrategy, [\n    { id: 'paypalcommercecredit' },\n]);\n","import {\n    CustomerCredentials,\n    CustomerInitializeOptions,\n    CustomerStrategy,\n    DefaultCheckoutButtonHeight,\n    ExecutePaymentMethodCheckoutOptions,\n    InvalidArgumentError,\n    PaymentIntegrationService,\n    RequestOptions,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport PayPalCommerceIntegrationService from '../paypal-commerce-integration-service';\nimport {\n    ApproveCallbackPayload,\n    PayPalCommerceButtonsOptions,\n    PayPalCommerceInitializationData,\n} from '../paypal-commerce-types';\n\nimport PayPalCommerceVenmoCustomerInitializeOptions, {\n    WithPayPalCommerceVenmoCustomerInitializeOptions,\n} from './paypal-commerce-venmo-customer-initialize-options';\n\nexport default class PayPalCommerceVenmoCustomerStrategy implements CustomerStrategy {\n    constructor(\n        private paymentIntegrationService: PaymentIntegrationService,\n        private paypalCommerceIntegrationService: PayPalCommerceIntegrationService,\n    ) {}\n\n    async initialize(\n        options: CustomerInitializeOptions & WithPayPalCommerceVenmoCustomerInitializeOptions,\n    ): Promise<void> {\n        const { paypalcommercevenmo, methodId } = options;\n\n        if (!methodId) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.methodId\" argument is not provided.',\n            );\n        }\n\n        if (!paypalcommercevenmo) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.paypalcommercevenmo\" argument is not provided.',\n            );\n        }\n\n        if (!paypalcommercevenmo.container) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.paypalcommercevenmo.container\" argument is not provided.',\n            );\n        }\n\n        if (paypalcommercevenmo.onClick && typeof paypalcommercevenmo.onClick !== 'function') {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.paypalcommercevenmo.onClick\" argument is not a function.',\n            );\n        }\n\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod = state.getPaymentMethod(methodId);\n\n        if (!paymentMethod) {\n            await this.paymentIntegrationService.loadPaymentMethod(methodId);\n        }\n\n        const paypalSdk = await this.paypalCommerceIntegrationService.loadPayPalSdk(methodId);\n\n        if (!paypalSdk || !paypalSdk.Buttons || typeof paypalSdk.Buttons !== 'function') {\n            console.error(\n                '[BC PayPal]: PayPal Button could not be rendered, due to issues with loading PayPal SDK',\n            );\n\n            return;\n        }\n\n        this.renderButton(methodId, paypalcommercevenmo);\n    }\n\n    deinitialize(): Promise<void> {\n        return Promise.resolve();\n    }\n\n    async signIn(credentials: CustomerCredentials, options?: RequestOptions): Promise<void> {\n        await this.paymentIntegrationService.signInCustomer(credentials, options);\n    }\n\n    async signOut(options?: RequestOptions): Promise<void> {\n        await this.paymentIntegrationService.signOutCustomer(options);\n    }\n\n    executePaymentMethodCheckout(options?: ExecutePaymentMethodCheckoutOptions): Promise<void> {\n        options?.continueWithCheckoutCallback?.();\n\n        return Promise.resolve();\n    }\n\n    private renderButton(\n        methodId: string,\n        paypalcommercevenmo: PayPalCommerceVenmoCustomerInitializeOptions,\n    ): void {\n        const { container, onClick } = paypalcommercevenmo;\n\n        const paypalSdk = this.paypalCommerceIntegrationService.getPayPalSdkOrThrow();\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod =\n            state.getPaymentMethodOrThrow<PayPalCommerceInitializationData>(methodId);\n        const { paymentButtonStyles } = paymentMethod.initializationData || {};\n        const { checkoutTopButtonStyles } = paymentButtonStyles || {};\n\n        const buttonRenderOptions: PayPalCommerceButtonsOptions = {\n            fundingSource: paypalSdk.FUNDING.VENMO,\n            style: this.paypalCommerceIntegrationService.getValidButtonStyle({\n                ...checkoutTopButtonStyles,\n                height: DefaultCheckoutButtonHeight,\n            }),\n            createOrder: () =>\n                this.paypalCommerceIntegrationService.createOrder('paypalcommercevenmo'),\n            onApprove: ({ orderID }: ApproveCallbackPayload) =>\n                this.paypalCommerceIntegrationService.tokenizePayment(methodId, orderID),\n            ...(onClick && { onClick: () => onClick() }),\n        };\n\n        const paypalButtonRender = paypalSdk.Buttons(buttonRenderOptions);\n\n        if (paypalButtonRender.isEligible()) {\n            paypalButtonRender.render(`#${container}`);\n        } else {\n            this.paypalCommerceIntegrationService.removeElement(container);\n        }\n    }\n}\n","import {\n    CustomerStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport createPayPalCommerceIntegrationService from '../create-paypal-commerce-integration-service';\n\nimport PayPalCommerceVenmoCustomerStrategy from './paypal-commerce-venmo-customer-strategy';\n\nconst createPayPalCommerceVenmoCustomerStrategy: CustomerStrategyFactory<\n    PayPalCommerceVenmoCustomerStrategy\n> = (paymentIntegrationService) =>\n    new PayPalCommerceVenmoCustomerStrategy(\n        paymentIntegrationService,\n        createPayPalCommerceIntegrationService(paymentIntegrationService),\n    );\n\nexport default toResolvableModule(createPayPalCommerceVenmoCustomerStrategy, [\n    { id: 'paypalcommercevenmo' },\n]);\n","import {\n    CustomerCredentials,\n    CustomerInitializeOptions,\n    CustomerStrategy,\n    ExecutePaymentMethodCheckoutOptions,\n    InvalidArgumentError,\n    PaymentIntegrationService,\n    RequestOptions,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\nimport {\n    getFastlaneStyles,\n    PayPalFastlaneAuthenticationResult,\n    PayPalFastlaneAuthenticationState,\n    PayPalFastlaneStylesOption,\n    PayPalFastlaneUtils,\n    PayPalInitializationData,\n    PayPalSdkScriptLoader,\n} from '@bigcommerce/checkout-sdk/paypal-utils';\n\nimport PayPalCommerceFastlaneCustomerInitializeOptions, {\n    WithPayPalCommerceFastlaneCustomerInitializeOptions,\n} from './paypal-commerce-fastlane-customer-initialize-options';\n\nexport default class PayPalCommerceFastlaneCustomerStrategy implements CustomerStrategy {\n    constructor(\n        private paymentIntegrationService: PaymentIntegrationService,\n        private paypalSdkScriptLoader: PayPalSdkScriptLoader,\n        private paypalFastlaneUtils: PayPalFastlaneUtils,\n    ) {}\n\n    async initialize(\n        options: CustomerInitializeOptions & WithPayPalCommerceFastlaneCustomerInitializeOptions,\n    ): Promise<void> {\n        const { methodId, paypalcommercefastlane } = options;\n\n        if (!methodId) {\n            throw new InvalidArgumentError(\n                'Unable to proceed because \"methodId\" argument is not provided.',\n            );\n        }\n\n        try {\n            await this.paymentIntegrationService.loadPaymentMethod(methodId);\n\n            const state = this.paymentIntegrationService.getState();\n            const cart = state.getCartOrThrow();\n            const paymentMethod = state.getPaymentMethodOrThrow<PayPalInitializationData>(methodId);\n\n            const isTestModeEnabled = !!paymentMethod.initializationData?.isDeveloperModeApplicable;\n\n            const paypalFastlaneSdk = await this.paypalSdkScriptLoader.getPayPalFastlaneSdk(\n                paymentMethod,\n                cart.currency.code,\n                cart.id,\n            );\n\n            await this.paypalFastlaneUtils.initializePayPalFastlane(\n                paypalFastlaneSdk,\n                isTestModeEnabled,\n                this.getFastlaneStyles(methodId, paypalcommercefastlane),\n            );\n        } catch (_) {\n            // TODO: add logger to be able to debug issues if there any\n            // Info: Do not throw anything here to avoid blocking customer from passing checkout flow\n        }\n\n        return Promise.resolve();\n    }\n\n    async deinitialize(): Promise<void> {\n        return Promise.resolve();\n    }\n\n    async signIn(credentials: CustomerCredentials, options?: RequestOptions): Promise<void> {\n        await this.paymentIntegrationService.signInCustomer(credentials, options);\n    }\n\n    async signOut(options?: RequestOptions): Promise<void> {\n        await this.paymentIntegrationService.signOutCustomer(options);\n    }\n\n    async executePaymentMethodCheckout(\n        options?: ExecutePaymentMethodCheckoutOptions,\n    ): Promise<void> {\n        const { checkoutPaymentMethodExecuted, continueWithCheckoutCallback, methodId } =\n            options || {};\n\n        if (!methodId) {\n            throw new InvalidArgumentError(\n                'Unable to proceed because \"methodId\" argument is not provided.',\n            );\n        }\n\n        if (typeof continueWithCheckoutCallback !== 'function') {\n            throw new InvalidArgumentError(\n                'Unable to proceed because \"continueWithCheckoutCallback\" argument is not provided and it must be a function.',\n            );\n        }\n\n        const state = this.paymentIntegrationService.getState();\n        const customer = state.getCustomerOrThrow();\n\n        if (customer.isGuest) {\n            if (\n                checkoutPaymentMethodExecuted &&\n                typeof checkoutPaymentMethodExecuted === 'function'\n            ) {\n                checkoutPaymentMethodExecuted();\n            }\n\n            try {\n                await this.runPayPalAuthenticationFlowOrThrow(methodId);\n            } catch (_) {\n                // TODO: add logger to be able to debug issues if there any\n                // Info: Do not throw anything here to avoid blocking customer from passing checkout flow\n            }\n        }\n\n        continueWithCheckoutCallback();\n    }\n\n    /**\n     *\n     * Authentication flow methods\n     *\n     */\n    private async runPayPalAuthenticationFlowOrThrow(methodId: string): Promise<void> {\n        const state = this.paymentIntegrationService.getState();\n        const cartId = state.getCartOrThrow().id;\n        const customer = state.getCustomer();\n        const billingAddress = state.getBillingAddress();\n        const customerEmail = customer?.email || billingAddress?.email || '';\n\n        const { customerContextId } = await this.paypalFastlaneUtils.lookupCustomerOrThrow(\n            customerEmail,\n        );\n\n        const authenticationResult =\n            await this.paypalFastlaneUtils.triggerAuthenticationFlowOrThrow(customerContextId);\n\n        const isAuthenticationFlowCanceled =\n            authenticationResult.authenticationState === PayPalFastlaneAuthenticationState.CANCELED;\n\n        await this.updateCustomerDataState(methodId, authenticationResult);\n\n        if (isAuthenticationFlowCanceled) {\n            this.paypalFastlaneUtils.removeStorageSessionId();\n        } else {\n            this.paypalFastlaneUtils.updateStorageSessionId(cartId);\n        }\n    }\n\n    private async updateCustomerDataState(\n        methodId: string,\n        authenticationResult: PayPalFastlaneAuthenticationResult,\n    ): Promise<void> {\n        const state = this.paymentIntegrationService.getState();\n        const cart = state.getCartOrThrow();\n\n        const { authenticationState, addresses, billingAddress, shippingAddress, instruments } =\n            this.paypalFastlaneUtils.mapPayPalFastlaneProfileToBcCustomerData(\n                methodId,\n                authenticationResult,\n            );\n\n        await this.paymentIntegrationService.updatePaymentProviderCustomer({\n            authenticationState,\n            addresses,\n            instruments,\n        });\n\n        if (billingAddress) {\n            await this.paymentIntegrationService.updateBillingAddress(billingAddress);\n        }\n\n        if (shippingAddress && cart.lineItems.physicalItems.length > 0) {\n            const updatedState = await this.paymentIntegrationService.updateShippingAddress(\n                shippingAddress,\n            );\n\n            const paymentMethod =\n                updatedState.getPaymentMethodOrThrow<PayPalInitializationData>(methodId);\n            const { isFastlaneShippingOptionAutoSelectEnabled } =\n                paymentMethod.initializationData || {};\n            const consignments = updatedState.getConsignments() || [];\n            const availableShippingOptions = consignments[0]?.availableShippingOptions || [];\n            const firstShippingOption = availableShippingOptions[0];\n            const recommendedShippingOption = availableShippingOptions.find(\n                (option) => option.isRecommended,\n            );\n\n            if (\n                (recommendedShippingOption || firstShippingOption) &&\n                isFastlaneShippingOptionAutoSelectEnabled\n            ) {\n                const shippingOptionId = recommendedShippingOption?.id || firstShippingOption.id;\n\n                await this.paymentIntegrationService.selectShippingOption(shippingOptionId);\n            }\n        }\n    }\n\n    /**\n     *\n     * Fastlane styling methods\n     *\n     */\n    private getFastlaneStyles(\n        methodId: string,\n        paypalcommercefastlane: PayPalCommerceFastlaneCustomerInitializeOptions | undefined,\n    ): PayPalFastlaneStylesOption | undefined {\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod = state.getPaymentMethodOrThrow<PayPalInitializationData>(methodId);\n\n        const { fastlaneStyles, isFastlaneStylingEnabled } = paymentMethod.initializationData || {};\n\n        return getFastlaneStyles(\n            isFastlaneStylingEnabled ? fastlaneStyles : {},\n            paypalcommercefastlane?.styles,\n        );\n    }\n}\n","import {\n    CustomerStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\nimport {\n    createPayPalFastlaneUtils,\n    createPayPalSdkScriptLoader,\n} from '@bigcommerce/checkout-sdk/paypal-utils';\n\nimport PayPalCommerceFastlaneCustomerStrategy from './paypal-commerce-fastlane-customer-strategy';\n\nconst createPayPalCommerceFastlaneCustomerStrategy: CustomerStrategyFactory<\n    PayPalCommerceFastlaneCustomerStrategy\n> = (paymentIntegrationService) =>\n    new PayPalCommerceFastlaneCustomerStrategy(\n        paymentIntegrationService,\n        createPayPalSdkScriptLoader(),\n        createPayPalFastlaneUtils(),\n    );\n\nexport default toResolvableModule(createPayPalCommerceFastlaneCustomerStrategy, [\n    { id: 'paypalcommerceacceleratedcheckout' }, // this method id will be provided for users from test group\n    { id: 'paypalcommercecreditcards' }, // this method id will be provided for users from control group\n]);\n","import {\n    CheckoutButtonInitializeOptions,\n    CheckoutButtonStrategy,\n    InvalidArgumentError,\n    MissingDataError,\n    MissingDataErrorType,\n    PaymentIntegrationService,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport PayPalCommerceIntegrationService from '../paypal-commerce-integration-service';\nimport {\n    ApproveCallbackActions,\n    ApproveCallbackPayload,\n    PayPalBuyNowInitializeOptions,\n    PayPalCommerceButtonsOptions,\n    PayPalCommerceInitializationData,\n    ShippingAddressChangeCallbackPayload,\n    ShippingOptionChangeCallbackPayload,\n} from '../paypal-commerce-types';\n\nimport PayPalCommerceButtonInitializeOptions, {\n    WithPayPalCommerceButtonInitializeOptions,\n} from './paypal-commerce-button-initialize-options';\n\nexport default class PayPalCommerceButtonStrategy implements CheckoutButtonStrategy {\n    constructor(\n        private paymentIntegrationService: PaymentIntegrationService,\n        private paypalCommerceIntegrationService: PayPalCommerceIntegrationService,\n    ) {}\n\n    async initialize(\n        options: CheckoutButtonInitializeOptions & WithPayPalCommerceButtonInitializeOptions,\n    ): Promise<void> {\n        const { paypalcommerce, containerId, methodId } = options;\n\n        const isBuyNowFlow = Boolean(paypalcommerce?.buyNowInitializeOptions);\n\n        if (!methodId) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.methodId\" argument is not provided.',\n            );\n        }\n\n        if (!containerId) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.containerId\" argument is not provided.`,\n            );\n        }\n\n        if (!paypalcommerce) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.paypalcommerce\" argument is not provided.`,\n            );\n        }\n\n        if (isBuyNowFlow && !paypalcommerce.currencyCode) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.paypalcommerce.currencyCode\" argument is not provided.`,\n            );\n        }\n\n        if (\n            isBuyNowFlow &&\n            typeof paypalcommerce.buyNowInitializeOptions?.getBuyNowCartRequestBody !== 'function'\n        ) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.paypalcommerce.buyNowInitializeOptions.getBuyNowCartRequestBody\" argument is not provided or it is not a function.`,\n            );\n        }\n\n        if (!isBuyNowFlow) {\n            // Info: default checkout should not be loaded for BuyNow flow,\n            // since there is no checkout session available for that.\n            await this.paymentIntegrationService.loadDefaultCheckout();\n        }\n\n        // Info: we are using provided currency code for buy now cart,\n        // because checkout session is not available before buy now cart creation,\n        // hence application will throw an error on getCartOrThrow method call\n        const currencyCode = isBuyNowFlow\n            ? paypalcommerce.currencyCode\n            : this.paymentIntegrationService.getState().getCartOrThrow().currency.code;\n\n        await this.paypalCommerceIntegrationService.loadPayPalSdk(methodId, currencyCode, false);\n\n        this.renderButton(containerId, methodId, paypalcommerce, isBuyNowFlow);\n    }\n\n    deinitialize(): Promise<void> {\n        return Promise.resolve();\n    }\n\n    private renderButton(\n        containerId: string,\n        methodId: string,\n        paypalcommerce: PayPalCommerceButtonInitializeOptions,\n        isBuyNowFlow?: boolean,\n    ): void {\n        const { buyNowInitializeOptions, style, onComplete, onEligibilityFailure } = paypalcommerce;\n\n        const paypalSdk = this.paypalCommerceIntegrationService.getPayPalSdkOrThrow();\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod =\n            state.getPaymentMethodOrThrow<PayPalCommerceInitializationData>(methodId);\n        const { isHostedCheckoutEnabled, isAppSwitchEnabled } =\n            paymentMethod.initializationData || {};\n\n        const defaultCallbacks = {\n            ...(!isBuyNowFlow &&\n                this.isPaypalCommerceAppSwitchEnabled(methodId) && {\n                    appSwitchWhenAvailable: true,\n                }),\n            createOrder: () => this.paypalCommerceIntegrationService.createOrder('paypalcommerce'),\n            onApprove: ({ orderID }: ApproveCallbackPayload) =>\n                this.paypalCommerceIntegrationService.tokenizePayment(methodId, orderID),\n        };\n\n        const buyNowFlowCallbacks = {\n            onClick: () => this.handleClick(buyNowInitializeOptions),\n            onCancel: () => this.paymentIntegrationService.loadDefaultCheckout(),\n        };\n\n        const hostedCheckoutCallbacks = {\n            ...(!isAppSwitchEnabled && {\n                onShippingAddressChange: (data: ShippingAddressChangeCallbackPayload) =>\n                    this.onShippingAddressChange(data),\n                onShippingOptionsChange: (data: ShippingOptionChangeCallbackPayload) =>\n                    this.onShippingOptionsChange(data),\n            }),\n            onApprove: (data: ApproveCallbackPayload, actions: ApproveCallbackActions) =>\n                this.onHostedCheckoutApprove(data, actions, methodId, onComplete),\n        };\n\n        const buttonRenderOptions: PayPalCommerceButtonsOptions = {\n            fundingSource: paypalSdk.FUNDING.PAYPAL,\n            style: this.paypalCommerceIntegrationService.getValidButtonStyle(style),\n            ...defaultCallbacks,\n            ...(buyNowInitializeOptions && buyNowFlowCallbacks),\n            ...(isHostedCheckoutEnabled && hostedCheckoutCallbacks),\n        };\n\n        const paypalButton = paypalSdk.Buttons(buttonRenderOptions);\n\n        if (paypalButton.isEligible()) {\n            if (paypalButton.hasReturned?.() && this.isPaypalCommerceAppSwitchEnabled(methodId)) {\n                paypalButton.resume?.();\n            } else {\n                paypalButton.render(`#${containerId}`);\n            }\n        } else if (onEligibilityFailure && typeof onEligibilityFailure === 'function') {\n            onEligibilityFailure();\n        } else {\n            this.paypalCommerceIntegrationService.removeElement(containerId);\n        }\n    }\n\n    private async handleClick(\n        buyNowInitializeOptions?: PayPalBuyNowInitializeOptions,\n    ): Promise<void> {\n        if (buyNowInitializeOptions) {\n            const buyNowCart = await this.paypalCommerceIntegrationService.createBuyNowCartOrThrow(\n                buyNowInitializeOptions,\n            );\n\n            await this.paymentIntegrationService.loadCheckout(buyNowCart.id);\n        }\n    }\n\n    private async onHostedCheckoutApprove(\n        data: ApproveCallbackPayload,\n        actions: ApproveCallbackActions,\n        methodId: string,\n        onComplete?: () => void,\n    ): Promise<boolean> {\n        if (!data.orderID) {\n            throw new MissingDataError(MissingDataErrorType.MissingOrderId);\n        }\n\n        const state = this.paymentIntegrationService.getState();\n        const cart = state.getCartOrThrow();\n        const orderDetails = await actions.order.get();\n\n        try {\n            const billingAddress =\n                this.paypalCommerceIntegrationService.getBillingAddressFromOrderDetails(\n                    orderDetails,\n                );\n\n            await this.paymentIntegrationService.updateBillingAddress(billingAddress);\n\n            if (cart.lineItems.physicalItems.length > 0) {\n                const shippingAddress =\n                    this.paypalCommerceIntegrationService.getShippingAddressFromOrderDetails(\n                        orderDetails,\n                    );\n\n                await this.paymentIntegrationService.updateShippingAddress(shippingAddress);\n                await this.paypalCommerceIntegrationService.updateOrder();\n            }\n\n            await this.paymentIntegrationService.submitOrder({}, { params: { methodId } });\n            await this.paypalCommerceIntegrationService.submitPayment(methodId, data.orderID);\n\n            if (onComplete && typeof onComplete === 'function') {\n                onComplete();\n            }\n\n            return true; // FIXME: Do we really need to return true here?\n        } catch (error) {\n            if (typeof error === 'string') {\n                throw new Error(error);\n            }\n\n            throw error;\n        }\n    }\n\n    private async onShippingAddressChange(\n        data: ShippingAddressChangeCallbackPayload,\n    ): Promise<void> {\n        const address = this.paypalCommerceIntegrationService.getAddress({\n            city: data.shippingAddress.city,\n            countryCode: data.shippingAddress.countryCode,\n            postalCode: data.shippingAddress.postalCode,\n            stateOrProvinceCode: data.shippingAddress.state,\n        });\n\n        try {\n            // Info: we use the same address to fill billing and shipping addresses to have valid quota on BE for order updating process\n            // on this stage we don't have access to valid customer's address accept shipping data\n            await this.paymentIntegrationService.updateBillingAddress(address);\n            await this.paymentIntegrationService.updateShippingAddress(address);\n\n            const shippingOption = this.paypalCommerceIntegrationService.getShippingOptionOrThrow();\n\n            await this.paymentIntegrationService.selectShippingOption(shippingOption.id);\n            await this.paypalCommerceIntegrationService.updateOrder();\n        } catch (error) {\n            if (typeof error === 'string') {\n                throw new Error(error);\n            }\n\n            throw error;\n        }\n    }\n\n    private async onShippingOptionsChange(\n        data: ShippingOptionChangeCallbackPayload,\n    ): Promise<void> {\n        const shippingOption = this.paypalCommerceIntegrationService.getShippingOptionOrThrow(\n            data.selectedShippingOption.id,\n        );\n\n        try {\n            await this.paymentIntegrationService.selectShippingOption(shippingOption.id);\n            await this.paypalCommerceIntegrationService.updateOrder();\n        } catch (error) {\n            if (typeof error === 'string') {\n                throw new Error(error);\n            }\n\n            throw error;\n        }\n    }\n\n    /**\n     *\n     * PayPal AppSwitch enabling handling\n     *\n     */\n    private isPaypalCommerceAppSwitchEnabled(methodId: string): boolean {\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod =\n            state.getPaymentMethodOrThrow<PayPalCommerceInitializationData>(methodId);\n\n        return paymentMethod.initializationData?.isAppSwitchEnabled || false;\n    }\n}\n","import {\n    CheckoutButtonStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport createPayPalCommerceIntegrationService from '../create-paypal-commerce-integration-service';\n\nimport PayPalCommerceButtonStrategy from './paypal-commerce-button-strategy';\n\nconst createPayPalCommerceButtonStrategy: CheckoutButtonStrategyFactory<\n    PayPalCommerceButtonStrategy\n> = (paymentIntegrationService) =>\n    new PayPalCommerceButtonStrategy(\n        paymentIntegrationService,\n        createPayPalCommerceIntegrationService(paymentIntegrationService),\n    );\n\nexport default toResolvableModule(createPayPalCommerceButtonStrategy, [{ id: 'paypalcommerce' }]);\n","import {\n    CheckoutButtonInitializeOptions,\n    CheckoutButtonStrategy,\n    InvalidArgumentError,\n    MissingDataError,\n    MissingDataErrorType,\n    PaymentIntegrationService,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\nimport {\n    getPaypalMessagesStylesFromBNPLConfig,\n    MessagingOptions,\n    PayPalBNPLConfigurationItem,\n    PayPalCommerceInitializationData,\n    PayPalCommerceSdk,\n    PayPalMessagesSdk,\n} from '@bigcommerce/checkout-sdk/paypal-commerce-utils';\n\nimport PayPalCommerceIntegrationService from '../paypal-commerce-integration-service';\nimport {\n    ApproveCallbackActions,\n    ApproveCallbackPayload,\n    PayPalBuyNowInitializeOptions,\n    PayPalCommerceButtonsOptions,\n    ShippingAddressChangeCallbackPayload,\n    ShippingOptionChangeCallbackPayload,\n} from '../paypal-commerce-types';\n\nimport PayPalCommerceCreditButtonInitializeOptions, {\n    WithPayPalCommerceCreditButtonInitializeOptions,\n} from './paypal-commerce-credit-button-initialize-options';\n\nexport default class PayPalCommerceCreditButtonStrategy implements CheckoutButtonStrategy {\n    constructor(\n        private paymentIntegrationService: PaymentIntegrationService,\n        private paypalCommerceIntegrationService: PayPalCommerceIntegrationService,\n        private paypalCommerceSdk: PayPalCommerceSdk,\n    ) {}\n\n    async initialize(\n        options: CheckoutButtonInitializeOptions & WithPayPalCommerceCreditButtonInitializeOptions,\n    ): Promise<void> {\n        const { paypalcommercecredit, containerId, methodId } = options;\n        const {\n            buyNowInitializeOptions,\n            currencyCode: providedCurrencyCode,\n            messagingContainerId,\n        } = paypalcommercecredit || {};\n\n        const isBuyNowFlow = !!buyNowInitializeOptions;\n\n        if (!methodId) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.methodId\" argument is not provided.',\n            );\n        }\n\n        if (!containerId) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.containerId\" argument is not provided.`,\n            );\n        }\n\n        if (!paypalcommercecredit) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.paypalcommercecredit\" argument is not provided.`,\n            );\n        }\n\n        if (isBuyNowFlow && !providedCurrencyCode) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.paypalcommercecredit.currencyCode\" argument is not provided.`,\n            );\n        }\n\n        if (\n            isBuyNowFlow &&\n            typeof buyNowInitializeOptions?.getBuyNowCartRequestBody !== 'function'\n        ) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.paypalcommercecredit.buyNowInitializeOptions.getBuyNowCartRequestBody\" argument is not provided or it is not a function.`,\n            );\n        }\n\n        if (!isBuyNowFlow) {\n            // Info: default checkout should not be loaded for BuyNow flow,\n            // since there is no checkout session available for that.\n            await this.paymentIntegrationService.loadDefaultCheckout();\n        }\n\n        const state = this.paymentIntegrationService.getState();\n\n        // Info: we are using provided currency code for buy now cart,\n        // because checkout session is not available before buy now cart creation,\n        // hence application will throw an error on getCartOrThrow method call\n        const currencyCode = isBuyNowFlow\n            ? providedCurrencyCode\n            : state.getCartOrThrow().currency.code;\n\n        await this.paypalCommerceIntegrationService.loadPayPalSdk(methodId, currencyCode, false);\n\n        this.renderButton(containerId, methodId, paypalcommercecredit);\n\n        // TODO: remove banner rendering implementation in this file when PAYPAL-5557.Hide_ppc_banner_implementation will be rolled out to 100%\n        const features = state.getStoreConfigOrThrow().checkoutSettings.features;\n        const isBannerImplementationDisabled =\n            features['PAYPAL-5557.Hide_ppc_banner_implementation'] ?? false;\n\n        if (isBannerImplementationDisabled) {\n            return;\n        }\n\n        const messagingContainer =\n            messagingContainerId && document.getElementById(messagingContainerId);\n\n        if (currencyCode && messagingContainer) {\n            const paymentMethod =\n                state.getPaymentMethodOrThrow<PayPalCommerceInitializationData>(methodId);\n\n            const { paypalBNPLConfiguration = [] } = paymentMethod.initializationData || {};\n            const bannerConfiguration =\n                paypalBNPLConfiguration && paypalBNPLConfiguration.find(({ id }) => id === 'cart');\n\n            if (!bannerConfiguration?.status) {\n                return;\n            }\n\n            // TODO: remove this code when data attributes will be removed from the banner container in content service\n            messagingContainer.removeAttribute('data-pp-style-logo-type');\n            messagingContainer.removeAttribute('data-pp-style-logo-position');\n            messagingContainer.removeAttribute('data-pp-style-text-color');\n            messagingContainer.removeAttribute('data-pp-style-text-size');\n\n            const paypalSdk = await this.paypalCommerceSdk.getPayPalMessages(\n                paymentMethod,\n                currencyCode,\n            );\n\n            this.renderMessages(paypalSdk, messagingContainerId, bannerConfiguration);\n        }\n    }\n\n    deinitialize(): Promise<void> {\n        return Promise.resolve();\n    }\n\n    private renderButton(\n        containerId: string,\n        methodId: string,\n        paypalcommercecredit: PayPalCommerceCreditButtonInitializeOptions,\n    ): void {\n        const { buyNowInitializeOptions, style, onComplete, onEligibilityFailure } =\n            paypalcommercecredit;\n\n        const paypalSdk = this.paypalCommerceIntegrationService.getPayPalSdkOrThrow();\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod =\n            state.getPaymentMethodOrThrow<PayPalCommerceInitializationData>(methodId);\n        const { isHostedCheckoutEnabled, isAppSwitchEnabled } =\n            paymentMethod.initializationData || {};\n\n        const defaultCallbacks = {\n            createOrder: () =>\n                this.paypalCommerceIntegrationService.createOrder('paypalcommercecredit'),\n            onApprove: ({ orderID }: ApproveCallbackPayload) =>\n                this.paypalCommerceIntegrationService.tokenizePayment(methodId, orderID),\n        };\n\n        const buyNowFlowCallbacks = {\n            onClick: () => this.handleClick(buyNowInitializeOptions),\n            onCancel: () => this.paymentIntegrationService.loadDefaultCheckout(),\n        };\n\n        const hostedCheckoutCallbacks = {\n            ...(!isAppSwitchEnabled && {\n                onShippingAddressChange: (data: ShippingAddressChangeCallbackPayload) =>\n                    this.onShippingAddressChange(data),\n                onShippingOptionsChange: (data: ShippingOptionChangeCallbackPayload) =>\n                    this.onShippingOptionsChange(data),\n            }),\n            onApprove: (data: ApproveCallbackPayload, actions: ApproveCallbackActions) =>\n                this.onHostedCheckoutApprove(data, actions, methodId, onComplete),\n        };\n\n        const fundingSources = [paypalSdk.FUNDING.PAYLATER, paypalSdk.FUNDING.CREDIT];\n        let hasRenderedSmartButton = false;\n\n        fundingSources.forEach((fundingSource) => {\n            if (!hasRenderedSmartButton) {\n                const buttonRenderOptions: PayPalCommerceButtonsOptions = {\n                    fundingSource,\n                    style: this.paypalCommerceIntegrationService.getValidButtonStyle(style),\n                    ...defaultCallbacks,\n                    ...(buyNowInitializeOptions && buyNowFlowCallbacks),\n                    ...(isHostedCheckoutEnabled && hostedCheckoutCallbacks),\n                };\n\n                const paypalButton = paypalSdk.Buttons(buttonRenderOptions);\n\n                if (paypalButton.isEligible()) {\n                    paypalButton.render(`#${containerId}`);\n                    hasRenderedSmartButton = true;\n                } else if (onEligibilityFailure && typeof onEligibilityFailure === 'function') {\n                    onEligibilityFailure();\n                }\n            }\n        });\n\n        if (!hasRenderedSmartButton) {\n            this.paypalCommerceIntegrationService.removeElement(containerId);\n        }\n    }\n\n    private async handleClick(\n        buyNowInitializeOptions?: PayPalBuyNowInitializeOptions,\n    ): Promise<void> {\n        if (buyNowInitializeOptions) {\n            const buyNowCart = await this.paypalCommerceIntegrationService.createBuyNowCartOrThrow(\n                buyNowInitializeOptions,\n            );\n\n            await this.paymentIntegrationService.loadCheckout(buyNowCart.id);\n        }\n    }\n\n    private async onHostedCheckoutApprove(\n        data: ApproveCallbackPayload,\n        actions: ApproveCallbackActions,\n        methodId: string,\n        onComplete?: () => void,\n    ): Promise<boolean> {\n        if (!data.orderID) {\n            throw new MissingDataError(MissingDataErrorType.MissingOrderId);\n        }\n\n        const state = this.paymentIntegrationService.getState();\n        const cart = state.getCartOrThrow();\n        const orderDetails = await actions.order.get();\n\n        try {\n            const billingAddress =\n                this.paypalCommerceIntegrationService.getBillingAddressFromOrderDetails(\n                    orderDetails,\n                );\n\n            await this.paymentIntegrationService.updateBillingAddress(billingAddress);\n\n            if (cart.lineItems.physicalItems.length > 0) {\n                const shippingAddress =\n                    this.paypalCommerceIntegrationService.getShippingAddressFromOrderDetails(\n                        orderDetails,\n                    );\n\n                await this.paymentIntegrationService.updateShippingAddress(shippingAddress);\n                await this.paypalCommerceIntegrationService.updateOrder();\n            }\n\n            await this.paymentIntegrationService.submitOrder({}, { params: { methodId } });\n            await this.paypalCommerceIntegrationService.submitPayment(methodId, data.orderID);\n\n            if (onComplete && typeof onComplete === 'function') {\n                onComplete();\n            }\n\n            return true; // FIXME: Do we really need to return true here?\n        } catch (error) {\n            if (typeof error === 'string') {\n                throw new Error(error);\n            }\n\n            throw error;\n        }\n    }\n\n    private async onShippingAddressChange(\n        data: ShippingAddressChangeCallbackPayload,\n    ): Promise<void> {\n        const address = this.paypalCommerceIntegrationService.getAddress({\n            city: data.shippingAddress.city,\n            countryCode: data.shippingAddress.countryCode,\n            postalCode: data.shippingAddress.postalCode,\n            stateOrProvinceCode: data.shippingAddress.state,\n        });\n\n        try {\n            // Info: we use the same address to fill billing and shipping addresses to have valid quota on BE for order updating process\n            // on this stage we don't have access to valid customer's address accept shipping data\n            await this.paymentIntegrationService.updateBillingAddress(address);\n            await this.paymentIntegrationService.updateShippingAddress(address);\n\n            const shippingOption = this.paypalCommerceIntegrationService.getShippingOptionOrThrow();\n\n            await this.paymentIntegrationService.selectShippingOption(shippingOption.id);\n            await this.paypalCommerceIntegrationService.updateOrder();\n        } catch (error) {\n            if (typeof error === 'string') {\n                throw new Error(error);\n            }\n\n            throw error;\n        }\n    }\n\n    private async onShippingOptionsChange(\n        data: ShippingOptionChangeCallbackPayload,\n    ): Promise<void> {\n        const shippingOption = this.paypalCommerceIntegrationService.getShippingOptionOrThrow(\n            data.selectedShippingOption.id,\n        );\n\n        try {\n            await this.paymentIntegrationService.selectShippingOption(shippingOption.id);\n            await this.paypalCommerceIntegrationService.updateOrder();\n        } catch (error) {\n            if (typeof error === 'string') {\n                throw new Error(error);\n            }\n\n            throw error;\n        }\n    }\n\n    private renderMessages(\n        paypalMessagesSdk: PayPalMessagesSdk,\n        messagingContainerId: string,\n        bannerConfiguration: PayPalBNPLConfigurationItem,\n    ): void {\n        const checkout = this.paymentIntegrationService.getState().getCheckoutOrThrow();\n\n        const paypalMessagesOptions: MessagingOptions = {\n            amount: checkout.outstandingBalance,\n            placement: 'cart',\n            style: getPaypalMessagesStylesFromBNPLConfig(bannerConfiguration),\n        };\n\n        const paypalMessages = paypalMessagesSdk.Messages(paypalMessagesOptions);\n\n        paypalMessages.render(`#${messagingContainerId}`);\n    }\n}\n","import {\n    CheckoutButtonStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\nimport { createPayPalCommerceSdk } from '@bigcommerce/checkout-sdk/paypal-commerce-utils';\n\nimport createPayPalCommerceIntegrationService from '../create-paypal-commerce-integration-service';\n\nimport PayPalCommerceCreditButtonStrategy from './paypal-commerce-credit-button-strategy';\n\nconst createPayPalCommerceCreditButtonStrategy: CheckoutButtonStrategyFactory<\n    PayPalCommerceCreditButtonStrategy\n> = (paymentIntegrationService) =>\n    new PayPalCommerceCreditButtonStrategy(\n        paymentIntegrationService,\n        createPayPalCommerceIntegrationService(paymentIntegrationService),\n        createPayPalCommerceSdk(),\n    );\n\nexport default toResolvableModule(createPayPalCommerceCreditButtonStrategy, [\n    { id: 'paypalcommercecredit' },\n]);\n","import {\n    CheckoutButtonInitializeOptions,\n    CheckoutButtonStrategy,\n    InvalidArgumentError,\n    PaymentIntegrationService,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport PayPalCommerceIntegrationService from '../paypal-commerce-integration-service';\nimport {\n    ApproveCallbackPayload,\n    PayPalButtonStyleOptions,\n    PayPalBuyNowInitializeOptions,\n    PayPalCommerceButtonsOptions,\n    StyleButtonColor,\n} from '../paypal-commerce-types';\n\nimport PayPalCommerceVenmoButtonInitializeOptions, {\n    WithPayPalCommerceVenmoButtonInitializeOptions,\n} from './paypal-commerce-venmo-button-initialize-options';\n\nexport default class PayPalCommerceVenmoButtonStrategy implements CheckoutButtonStrategy {\n    constructor(\n        private paymentIntegrationService: PaymentIntegrationService,\n        private paypalCommerceIntegrationService: PayPalCommerceIntegrationService,\n    ) {}\n\n    async initialize(\n        options: CheckoutButtonInitializeOptions & WithPayPalCommerceVenmoButtonInitializeOptions,\n    ): Promise<void> {\n        const { paypalcommercevenmo, containerId, methodId } = options;\n        const { buyNowInitializeOptions, currencyCode: providedCurrencyCode } =\n            paypalcommercevenmo || {};\n\n        const isBuyNowFlow = !!buyNowInitializeOptions;\n\n        if (!methodId) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.methodId\" argument is not provided.',\n            );\n        }\n\n        if (!containerId) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.containerId\" argument is not provided.`,\n            );\n        }\n\n        if (!paypalcommercevenmo) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.paypalcommercevenmo\" argument is not provided.`,\n            );\n        }\n\n        if (isBuyNowFlow && !providedCurrencyCode) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.paypalcommercevenmo.currencyCode\" argument is not provided.`,\n            );\n        }\n\n        if (\n            isBuyNowFlow &&\n            typeof buyNowInitializeOptions?.getBuyNowCartRequestBody !== 'function'\n        ) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.paypalcommercevenmo.buyNowInitializeOptions.getBuyNowCartRequestBody\" argument is not provided or it is not a function.`,\n            );\n        }\n\n        if (!isBuyNowFlow) {\n            // Info: default checkout should not be loaded for BuyNow flow,\n            // since there is no checkout session available for that.\n            await this.paymentIntegrationService.loadDefaultCheckout();\n        }\n\n        // Info: we are using provided currency code for buy now cart,\n        // because checkout session is not available before buy now cart creation,\n        // hence application will throw an error on getCartOrThrow method call\n        const currencyCode = isBuyNowFlow\n            ? providedCurrencyCode\n            : this.paymentIntegrationService.getState().getCartOrThrow().currency.code;\n\n        await this.paypalCommerceIntegrationService.loadPayPalSdk(methodId, currencyCode, false);\n\n        this.renderButton(containerId, methodId, paypalcommercevenmo);\n    }\n\n    deinitialize(): Promise<void> {\n        return Promise.resolve();\n    }\n\n    private renderButton(\n        containerId: string,\n        methodId: string,\n        paypalcommercevenmo: PayPalCommerceVenmoButtonInitializeOptions,\n    ): void {\n        const { buyNowInitializeOptions, style, onEligibilityFailure } = paypalcommercevenmo;\n\n        const paypalSdk = this.paypalCommerceIntegrationService.getPayPalSdkOrThrow();\n        const fundingSource = paypalSdk.FUNDING.VENMO;\n\n        const defaultCallbacks = {\n            createOrder: () =>\n                this.paypalCommerceIntegrationService.createOrder('paypalcommercevenmo'),\n            onApprove: ({ orderID }: ApproveCallbackPayload) =>\n                this.paypalCommerceIntegrationService.tokenizePayment(methodId, orderID),\n        };\n\n        const buyNowFlowCallbacks = {\n            onClick: () => this.handleClick(buyNowInitializeOptions),\n            onCancel: () => this.paymentIntegrationService.loadDefaultCheckout(),\n        };\n\n        const buttonRenderOptions: PayPalCommerceButtonsOptions = {\n            fundingSource,\n            style: this.getValidVenmoButtonStyles(style),\n            ...defaultCallbacks,\n            ...(buyNowInitializeOptions && buyNowFlowCallbacks),\n        };\n\n        const paypalButtonRender = paypalSdk.Buttons(buttonRenderOptions);\n\n        if (paypalButtonRender.isEligible()) {\n            paypalButtonRender.render(`#${containerId}`);\n        } else if (onEligibilityFailure && typeof onEligibilityFailure === 'function') {\n            onEligibilityFailure();\n        } else {\n            this.paypalCommerceIntegrationService.removeElement(containerId);\n        }\n    }\n\n    private getValidVenmoButtonStyles(style: PayPalButtonStyleOptions | undefined) {\n        const validButtonStyle = this.paypalCommerceIntegrationService.getValidButtonStyle(style);\n\n        if (validButtonStyle.color === StyleButtonColor.gold) {\n            return {\n                ...validButtonStyle,\n                color: undefined,\n            };\n        }\n\n        return validButtonStyle;\n    }\n\n    private async handleClick(\n        buyNowInitializeOptions?: PayPalBuyNowInitializeOptions,\n    ): Promise<void> {\n        if (buyNowInitializeOptions) {\n            const buyNowCart = await this.paypalCommerceIntegrationService.createBuyNowCartOrThrow(\n                buyNowInitializeOptions,\n            );\n\n            await this.paymentIntegrationService.loadCheckout(buyNowCart.id);\n        }\n    }\n}\n","import {\n    CheckoutButtonStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport createPayPalCommerceIntegrationService from '../create-paypal-commerce-integration-service';\n\nimport PayPalCommerceVenmoButtonStrategy from './paypal-commerce-venmo-button-strategy';\n\nconst createPayPalCommerceVenmoButtonStrategy: CheckoutButtonStrategyFactory<\n    PayPalCommerceVenmoButtonStrategy\n> = (paymentIntegrationService) =>\n    new PayPalCommerceVenmoButtonStrategy(\n        paymentIntegrationService,\n        createPayPalCommerceIntegrationService(paymentIntegrationService),\n    );\n\nexport default toResolvableModule(createPayPalCommerceVenmoButtonStrategy, [\n    { id: 'paypalcommercevenmo' },\n]);\n","import {\n    CheckoutButtonInitializeOptions,\n    CheckoutButtonStrategy,\n    InvalidArgumentError,\n    PaymentIntegrationService,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport PayPalCommerceIntegrationService from '../paypal-commerce-integration-service';\nimport {\n    ApproveCallbackPayload,\n    PayPalBuyNowInitializeOptions,\n    PayPalCommerceButtonsOptions,\n} from '../paypal-commerce-types';\n\nimport PayPalCommerceAlternativeMethodsButtonOptions, {\n    WithPayPalCommerceAlternativeMethodsButtonInitializeOptions,\n} from './paypal-commerce-alternative-methods-button-initialize-options';\n\nexport default class PayPalCommerceAlternativeMethodsButtonStrategy\n    implements CheckoutButtonStrategy\n{\n    constructor(\n        private paymentIntegrationService: PaymentIntegrationService,\n        private paypalCommerceIntegrationService: PayPalCommerceIntegrationService,\n    ) {}\n\n    async initialize(\n        options: CheckoutButtonInitializeOptions &\n            WithPayPalCommerceAlternativeMethodsButtonInitializeOptions,\n    ): Promise<void> {\n        const { paypalcommercealternativemethods, containerId, methodId } = options;\n        const {\n            apm,\n            buyNowInitializeOptions,\n            currencyCode: providedCurrencyCode,\n        } = paypalcommercealternativemethods || {};\n\n        const isBuyNowFlow = !!buyNowInitializeOptions;\n\n        if (!methodId) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.methodId\" argument is not provided.',\n            );\n        }\n\n        if (!containerId) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.containerId\" argument is not provided.`,\n            );\n        }\n\n        if (!paypalcommercealternativemethods) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.paypalcommercealternativemethods\" argument is not provided.`,\n            );\n        }\n\n        if (!apm) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.paypalcommercealternativemethods.apm\" argument is not provided.`,\n            );\n        }\n\n        if (isBuyNowFlow && !providedCurrencyCode) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.paypalcommercealternativemethods.currencyCode\" argument is not provided.`,\n            );\n        }\n\n        if (\n            isBuyNowFlow &&\n            typeof buyNowInitializeOptions?.getBuyNowCartRequestBody !== 'function'\n        ) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.paypalcommercealternativemethods.buyNowInitializeOptions.getBuyNowCartRequestBody\" argument is not provided or it is not a function.`,\n            );\n        }\n\n        if (!isBuyNowFlow) {\n            // Info: default checkout should not be loaded for BuyNow flow,\n            // since there is no checkout session available for that.\n            await this.paymentIntegrationService.loadDefaultCheckout();\n        }\n\n        // Info: we are using provided currency code for buy now cart,\n        // because checkout session is not available before buy now cart creation,\n        // hence application will throw an error on getCartOrThrow method call\n        const currencyCode = isBuyNowFlow\n            ? providedCurrencyCode\n            : this.paymentIntegrationService.getState().getCartOrThrow().currency.code;\n\n        await this.paypalCommerceIntegrationService.loadPayPalSdk(methodId, currencyCode, false);\n\n        this.renderButton(containerId, methodId, paypalcommercealternativemethods);\n    }\n\n    deinitialize(): Promise<void> {\n        return Promise.resolve();\n    }\n\n    private renderButton(\n        containerId: string,\n        methodId: string,\n        paypalcommercealternativemethods: PayPalCommerceAlternativeMethodsButtonOptions,\n    ): void {\n        const { apm, buyNowInitializeOptions, style, onEligibilityFailure } =\n            paypalcommercealternativemethods;\n\n        const paypalSdk = this.paypalCommerceIntegrationService.getPayPalSdkOrThrow();\n        const isAvailableFundingSource = Object.values(paypalSdk.FUNDING).includes(apm);\n\n        if (!isAvailableFundingSource) {\n            throw new InvalidArgumentError(\n                `Unable to initialize PayPal button because \"options.paypalcommercealternativemethods.apm\" argument is not valid funding source.`,\n            );\n        }\n\n        const defaultCallbacks = {\n            createOrder: () =>\n                this.paypalCommerceIntegrationService.createOrder(\n                    'paypalcommercealternativemethod',\n                ),\n            onApprove: ({ orderID }: ApproveCallbackPayload) =>\n                this.paypalCommerceIntegrationService.tokenizePayment(methodId, orderID),\n        };\n\n        const buyNowFlowCallbacks = {\n            onClick: () => this.handleClick(buyNowInitializeOptions),\n            onCancel: () => this.paymentIntegrationService.loadDefaultCheckout(),\n        };\n\n        const buttonRenderOptions: PayPalCommerceButtonsOptions = {\n            fundingSource: apm,\n            style: this.paypalCommerceIntegrationService.getValidButtonStyle(style),\n            ...defaultCallbacks,\n            ...(buyNowInitializeOptions && buyNowFlowCallbacks),\n        };\n\n        const paypalButtonRender = paypalSdk.Buttons(buttonRenderOptions);\n\n        if (paypalButtonRender.isEligible()) {\n            paypalButtonRender.render(`#${containerId}`);\n        } else if (onEligibilityFailure && typeof onEligibilityFailure === 'function') {\n            onEligibilityFailure();\n        } else {\n            this.paypalCommerceIntegrationService.removeElement(containerId);\n        }\n    }\n\n    private async handleClick(\n        buyNowInitializeOptions?: PayPalBuyNowInitializeOptions,\n    ): Promise<void> {\n        if (buyNowInitializeOptions) {\n            const buyNowCart = await this.paypalCommerceIntegrationService.createBuyNowCartOrThrow(\n                buyNowInitializeOptions,\n            );\n\n            await this.paymentIntegrationService.loadCheckout(buyNowCart.id);\n        }\n    }\n}\n","import {\n    CheckoutButtonStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport createPayPalCommerceIntegrationService from '../create-paypal-commerce-integration-service';\n\nimport PayPalCommerceAlternativeMethodsButtonStrategy from './paypal-commerce-alternative-methods-button-strategy';\n\nconst createPayPalCommerceAlternativeMethodsButtonStrategy: CheckoutButtonStrategyFactory<\n    PayPalCommerceAlternativeMethodsButtonStrategy\n> = (paymentIntegrationService) =>\n    new PayPalCommerceAlternativeMethodsButtonStrategy(\n        paymentIntegrationService,\n        createPayPalCommerceIntegrationService(paymentIntegrationService),\n    );\n\nexport default toResolvableModule(createPayPalCommerceAlternativeMethodsButtonStrategy, [\n    { id: 'paypalcommercealternativemethods' },\n]);\n"],"names":["MissingDataErrorType","__webpack_require__","toResolvableModule","module","resolveIds","Object","assign","d","exports","definition","key","o","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","StandardError","Error","constructor","message","super","name","type","setPrototypeOf","this","__proto__","captureStackTrace","stack","PaymentMethodClientUnavailableError","MissingBillingAddress","MissingCart","MissingCheckout","MissingConsignments","MissingCustomer","MissingCheckoutConfig","MissingOrder","MissingOrderConfig","MissingOrderId","MissingPayment","MissingPaymentId","MissingPaymentInstrument","MissingPaymentMethod","MissingPaymentRedirectUrl","MissingPaymentStatus","MissingPaymentToken","MissingShippingAddress","MissingDataError","subtype","PayPalCommerceSdk","scriptLoader","window","getPayPalFastlaneSdk","paymentMethod","currencyCode","sessionId","paypalFastlaneSdk","config","getPayPalFastlaneSdkConfiguration","loadPayPalSdk","getPayPalGooglePaySdk","initializesOnCheckoutPage","forceLoad","paypalGooglePay","paypalSdkScriptConfig","getPayPalGooglePaySdkScriptConfigOrThrow","getPayPalApmsSdk","paypalApms","getPayPalApmSdkConfiguration","getPayPalMessages","paypalMessages","paypalSdkMessagesConfig","getPayPalSdkMessagesConfiguration","options","attributes","scriptOptions","transformConfig","scriptAttributes","scriptSrc","URLSearchParams","toString","loadScript","async","clientToken","initializationData","clientId","intent","merchantId","attributionId","commit","components","currency","replace","buyerCountry","isHostedCheckoutEnabled","isDeveloperModeApplicable","availableAlternativePaymentMethods","enabledAlternativePaymentMethods","enableAPMsFunding","disableAPMsFunding","filter","apm","includes","length","transformedConfig","keys","forEach","value","Array","isArray","join","DEFAULT_STYLES","size","color","backgroundColor","ROTATION_ANIMATION","LoadingIndicator","styles","containerStyles","defineAnimation","container","buildContainer","indicator","buildIndicator","appendChild","show","parentId","parent","document","getElementById","style","visibility","opacity","hide","handleTransitionEnd","removeEventListener","addEventListener","createElement","display","bottom","left","height","width","position","right","top","transition","setStyleAttribute","borderRadius","border","borderColor","margin","transform","transformStyle","animation","element","attrs","k","setProperty","id","head","sheet","CSSStyleSheet","insertRule","BuyNowCartCreationError","DEFAULT_RESPONSE","body","headers","status","RequestError","response","errors","CartSource","LiabilityShiftEnum","PayPalCommerceIntent","StyleButtonLabel","StyleButtonColor","StyleButtonShape","NonInstantAlternativePaymentMethods","PayPalOrderStatus","BuyNow","Possible","No","Unknown","Yes","AUTHORIZE","CAPTURE","paypal","checkout","buynow","pay","installment","gold","blue","silver","black","white","pill","rect","OXXO","Approved","Created","PayerActionRequired","PollingStop","PollingError","PayPalCommerceIntegrationService","formPoster","paymentIntegrationService","paypalCommerceRequestSender","paypalCommerceScriptLoader","methodId","providedCurrencyCode","state","getState","getCartOrThrow","code","getPaymentMethodOrThrow","paypalSdk","getPayPalSDK","getPayPalSdkOrThrow","createBuyNowCartOrThrow","buyNowInitializeOptions","cartRequestBody","getBuyNowCartRequestBody","createBuyNowCart","error","createOrder","providerId","requestBody","cartId","orderId","createOrderCardFields","setupToken","updateOrder","cart","consignment","getConsignmentsOrThrow","availableShippingOptions","selectedShippingOption","_error","getOrderStatus","tokenizePayment","postForm","payment_type","action","provider","order_id","source","cart_id","submitPayment","gatewayId","paymentData","formattedPayload","vault_payment_instrument","set_as_default_stored_instrument","device_info","method_id","paypal_account","getShippingOptionOrThrow","selectedShippingOptionId","recommendedShippingOption","find","option","isRecommended","shippingOptionToSelect","getAddress","address","firstName","lastName","email","phone","company","address1","address2","city","countryCode","postalCode","stateOrProvince","stateOrProvinceCode","customFields","getBillingAddressFromOrderDetails","payer","given_name","surname","email_address","address_line_1","address_line_2","admin_area_2","country_code","postal_code","admin_area_1","phone_number","national_number","getShippingAddressFromOrderDetails","orderDetails","purchase_units","full_name","shipping","split","getValidButtonStyle","label","shape","validStyles","getValidHeight","omitBy","isNil","removeElement","elementId","INTERNAL_USE_ONLY","ContentType","Json","JsonV1","SDK_VERSION_HEADERS","PayPalCommerceRequestSender","requestSender","url","post","put","PayPalCommerceScriptLoader","getPayPalSdkScriptConfigOrThrow","loadPayPalSDK","isVenmoEnabled","isPayPalCreditAvailable","isGooglePayEnabled","shouldEnableCard","enableCardFunding","enableCreditFunding","shouldEnableAPMs","enableVenmoFunding","googlePayComponent","cardFieldsComponent","disableFunding","enableFunding","getHost","createFormPoster","createRequestSender","host","getScriptLoader","LOADING_INDICATOR_STYLES","InvalidArgumentError","PaymentArgumentInvalidError","invalidFields","PaymentMethodInvalidError","OrderFinalizationNotRequiredError","isHostedInstrumentLike","instrument","shouldSaveInstrument","shouldSetAsDefaultInstrument","isVaultedInstrument","Boolean","instrumentId","messagesStyles","layout","logo","ratio","text","isBaseInstrument","PayPalCommercePaymentStrategy","paypalCommerceIntegrationService","paypalCommerceSdk","loadingIndicator","initialize","paypalcommerce","loadPaymentMethod","bannerContainerId","paypalBNPLConfiguration","console","bannerConfiguration","Messages","renderMessages","loadingIndicatorContainer","onInit","renderButton","shouldRenderPayPalButtonOnInitialization","execute","payload","payment","order","onError","isPayPalVaultedInstrumentPaymentData","paymentPayload","prepareVaultedInstrumentPaymentPayload","preparePaymentPayload","submitOrder","additional_action_required","redirectUrl","data","redirect_url","Promise","location","isProviderError","_resolve","reject","paypalButton","close","handleError","finalize","deinitialize","resolve","paypalOrderId","shouldConfirmInstrument","isTrustedVaultingFlow","bigpay_token","token","paymentButtonStyles","checkoutPaymentButtonStyles","onRenderButton","onValidate","submitForm","buttonOptions","isPaypalCommerceAppSwitchEnabled","appSwitchWhenAvailable","fundingSource","FUNDING","PAYPAL","onClick","_","actions","handleClick","onApprove","handleApprove","onCancel","toggleLoadingIndicator","Buttons","isEligible","hasReturned","resume","render","orderID","fieldsValues","getFieldsValues","instruments","getInstruments","findInstrument","bigpayToken","trustedShippingAddress","isLoading","paypalMessagesOptions","amount","getCheckoutOrThrow","outstandingBalance","placement","e","provider_error","isAppSwitchEnabled","createPayPalCommerceSdk","createScriptLoader","NotImplementedError","PayPalCommerceCreditPaymentStrategy","paypalcommercecredit","paypalOptions","fundingSources","PAYLATER","CREDIT","hasRenderedSmartButton","PayPalCommerceVenmoPaymentStrategy","paypalcommercevenmo","VENMO","PayPalSdkScriptLoader","createPayPalSdkScriptLoader","TimeoutError","isExperimentEnabled","features","experimentName","fallbackValue","PayPalCommerceAlternativeMethodsPaymentStrategy","paypalSdkScriptLoader","pollingInterval","maxPollingIntervalTime","pollingTimer","stopPolling","noop","isPollingEnabled","paypalcommercealternativemethods","shouldRenderFields","getStoreConfigOrThrow","checkoutSettings","renderFields","initializePollingMechanism","isNonInstantPaymentMethod","resetPollingMechanism","resolvePromise","rejectPromise","timeout","setTimeout","clearTimeout","orderStatus","isOrderApproved","isPollingError","deinitializePollingMechanism","reinitializeStrategy","paypalAmpsSdk","getPaypalAmpsSdkOrThrow","buttonStyle","onInitButton","onCreateOrder","handleFailure","useStoreCredit","params","getBillingAddressOrThrow","apmFieldsContainer","apmFieldsStyles","fieldContainerElement","querySelector","innerHTML","fieldsOptions","fields","PaymentFields","toUpperCase","gateway","UntrustedShippingCardVerificationType","PayPalIntent","TDSecureAuthenticationState","PayPalFastlaneAuthenticationState","CVV","PAN","CookieStorage","cookieKey","encodeURIComponent","cookie","firstIndex","indexOf","lastIndex","decodeURIComponent","substring","set","secure","cookieText","expires","path","domain","toUTCString","now","Date","minutes","setTime","getTime","remove","Succeeded","Cancelled","Errored","SUCCEEDED","FAILED","CANCELED","UNRECOGNIZED","HostedFieldType","PaypalFastlaneUtils","initializePayPalFastlane","isTestModeEnabled","localStorage","setItem","paypalFastlane","defaultStyles","root","backgroundColorPrimary","Fastlane","getPayPalFastlaneOrThrow","lookupCustomerOrThrow","identity","lookupCustomerByEmail","triggerAuthenticationFlowOrThrow","customerContextId","triggerAuthenticationFlow","updateStorageSessionId","setDate","getDate","cookiesOption","removeStorageSessionId","getStorageSessionId","mapPayPalFastlaneProfileToBcCustomerData","authenticationResult","authenticationState","profileData","paypalBillingAddress","card","paymentSource","billingAddress","paypalShippingAddress","shippingAddress","paypalProfileName","paypalInstrument","mapPayPalToBcAddress","phoneNumber","mapPayPalToBcInstrument","addresses","filterAddresses","brand","expiry","lastDigits","expiryYear","expiryMonth","defaultInstrument","iin","last4","method","untrustedShippingCardVerificationMode","mapBcToPayPalAddress","addressLine1","addressLine2","adminArea1","adminArea2","profileName","fullName","phoneData","nationalNumber","country","reduce","customerAddresses","currentAddress","some","customerAddress","isEqualAddresses","firstAddress","secondAddress","isEqual","normalizeAddress","omit","createPaypalFastlaneUtils","CardCode","CardCodeVerification","CardExpiry","CardName","CardNumber","CardNumberVerification","CardExpiryVerification","isCreditCardFormFields","isCreditCardVaultedFormFields","PaymentMethodFailedError","NotInitializedErrorType","CheckoutButtonNotInitialized","CustomerNotInitialized","PaymentNotInitialized","ShippingNotInitialized","SpamProtectionNotInitialized","NotInitializedError","PaymentInvalidFormError","details","PayPalCommerceCreditCardsPaymentStrategy","paypalFastlaneUtils","paypalcommercecreditcards","paypalCommerceInitializationOptions","form","onCreditCardFieldsRenderingError","onLoadComplete","hostedFormOptions","isCreditCardForm","isCreditCardVaultedForm","hasUndefinedValues","undefined","initializeFields","shouldInitializePayPalFastlane","initializePayPalFastlaneOrThrow","executionPaymentData","validateHostedFormOrThrow","submitHostedForm","getInstrumentParams","returnedOrderId","submitPaymentPayload","returnedVaultedToken","cvvField","t","expiryField","numberField","nameField","nonce","verification_nonce","card_with_order","formOptions","executeCallback","getExecuteCallback","cardFieldsConfig","getInputStyles","vaultSetupToken","liabilityShift","inputEvents","onChange","event","onChangeHandler","onFocus","onFocusHandler","onBlur","onBlurHandler","onInputSubmitRequest","cardFields","CardFields","stylizeInputContainers","renderVaultedFields","createVaultSetupTokenCallback","createOrderCallback","createVaultSetupToken","getCardFieldsOrThrow","cardCode","containerId","CVVField","placeholder","cardExpiry","ExpiryField","cardName","NameField","cardNumber","NumberField","cardCodeVerification","cardExpiryVerification","cardNumberVerification","getFieldTypeByEmittedField","emittedBy","fieldType","mapFieldType","submitConfig","submit","cardFieldsState","then","validationData","getValidityData","isValid","mapValidationErrors","updatedFields","cardNameField","fieldsKeys","every","fieldsErrors","getInvalidErrorByFieldType","validationErrors","commonStyles","default","fontSize","fontFamily","fontWeight","outline","padding","input","values","boxShadow","background","marginBottom","marginLeft","onEnter","paymentProviderCustomer","getPaymentProviderCustomer","paypalCommercePaymentProviderCustomer","customer","isAcceleratedCheckoutEnabled","isPayPalCommerceAnalyticsV2Enabled","connectClientToken","payPalFastlaneSdk","PaypalCommerceRatepayPaymentStrategy","paypalcommerceratepay","legalTextContainer","loadingContainerId","createFraudNetScript","loadFraudnetConfig","renderLegalText","metadataId","guid","ratepayBirthDate","ratepayPhoneNumber","ratepayPhoneCountryCode","rate_pay","birth_date","normalizeDate","fraudNetScript","querySelectorAll","fraudNetConfig","legalTextContainerElement","date","formattedDate","formatDate","formattedMonth","getMonth","getFullYear","legalTextContainerElementId","legalTextContainerId","buttonContainerId","buttonContainer","buttonContainerParent","parentNode","setAttribute","prepend","ratePayButton","Legal","PAY_UPON_INVOICE","testMode","scriptElement","generateGUID","f","s","sandbox","JSON","stringify","i","Math","floor","characters","random","script","src","useMetadata","isInvalidStyleOption","styleOption","getFastlaneStyles","styleSettings","uiStyles","fastlaneStyles","toggle","textBody","textCaption","caption","branding","fastlaneRootSettingsBackgroundColor","errorColor","fastlaneRootSettingsErrorColor","fastlaneRootSettingsFontFamily","fontSizeBase","fastlaneRootSettingsFontSize","fastlaneRootSettingsPadding","primaryColor","fastlaneRootSettingsPrimaryColor","fastlaneInputSettingsBorderRadius","fastlaneInputSettingsBorderColor","focusBorderColor","fastlaneInputSettingsFocusBorderBase","fastlaneInputSettingsBackgroundColor","borderWidth","fastlaneInputSettingsBorderWidth","u","textColorBase","fastlaneInputSettingsTextColorBase","colorPrimary","fastlaneToggleSettingsColorPrimary","colorSecondary","fastlaneToggleSettingsColorSecondary","fastlaneTextBodySettingsColor","fastlaneTextBodySettingsFontSize","fastlaneTextCaptionSettingsColor","fastlaneTextCaptionSettingsFontSize","fastlaneBrandingSettings","isPayPalFastlaneCustomer","PaypalCommerceFastlanePaymentStrategy","paypalcommercefastlane","isFastlaneStylingEnabled","threeDSVerificationMethod","shouldRunAuthenticationFlow","runPayPalAuthenticationFlowOrThrow","initializePayPalPaymentComponent","renderPayPalPaymentComponent","handlePayPalStoredInstrumentChange","orderRequest","isVaultedFlow","invalidRequestError","translationKey","getCustomerOrThrow","paypalFastlaneCustomer","paypalFastlaneSessionId","isGuest","getCustomer","getBillingAddress","customerEmail","updatePaymentProviderCustomer","trim","cardComponentOptions","cardholderName","prefill","enabled","paypalComponentMethods","FastlaneCardComponent","getPayPalComponentMethodsOrThrow","is3DSEnabled","isPaypalCommerceFastlaneThreeDSAvailable","is3dsEnabled","fastlaneToken","get3DSNonce","paypal_fastlane_token","getPaymentToken","paypalNonce","getOrderOrThrow","checkoutUrl","links","checkoutLink","threeDomainSecureComponent","ThreeDomainSecureClient","threeDomainSecureParameters","orderAmount","toFixed","threeDSRequested","transactionContext","experience_context","locale","return_url","cancel_url","paypalAxoSdk","selectionChanged","selectedCard","profile","showCardSelector","selectedInstrument","PayPalCommerceCustomerStrategy","getPaymentMethod","signIn","credentials","signInCustomer","signOut","signOutCustomer","executePaymentMethodCheckout","continueWithCheckoutCallback","onComplete","checkoutTopButtonStyles","defaultCallbacks","hostedCheckoutCallbacks","onShippingAddressChange","onShippingOptionsChange","onHostedCheckoutApprove","buttonRenderOptions","updateBillingAddress","lineItems","physicalItems","updateShippingAddress","shippingOption","selectShippingOption","PayPalCommerceCreditCustomerStrategy","paypalCommerceCredit","PayPalCommerceVenmoCustomerStrategy","paypalButtonRender","PayPalCommerceFastlaneCustomerStrategy","checkoutPaymentMethodExecuted","isAuthenticationFlowCanceled","updateCustomerDataState","updatedState","isFastlaneShippingOptionAutoSelectEnabled","consignments","getConsignments","firstShippingOption","shippingOptionId","PayPalCommerceButtonStrategy","isBuyNowFlow","loadDefaultCheckout","onEligibilityFailure","buyNowFlowCallbacks","buyNowCart","loadCheckout","PayPalCommerceCreditButtonStrategy","messagingContainerId","messagingContainer","removeAttribute","paypalMessagesSdk","PayPalCommerceVenmoButtonStrategy","getValidVenmoButtonStyles","validButtonStyle","PayPalCommerceAlternativeMethodsButtonStrategy"],"sourceRoot":""}